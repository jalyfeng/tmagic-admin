const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/comp-entry-tKk-gY7j.js","assets/comp-entry-C9liEODB.css"])))=>i.map(i=>d[i]);
var ii=Object.defineProperty;var gr=e=>{throw TypeError(e)};var oi=(e,t,r)=>t in e?ii(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var p=(e,t,r)=>oi(e,typeof t!="symbol"?t+"":t,r),mr=(e,t,r)=>t.has(e)||gr("Cannot "+r);var F=(e,t,r)=>(mr(e,t,"read from private field"),r?r.call(e):t.get(e)),z=(e,t,r)=>t.has(e)?gr("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),q=(e,t,r,n)=>(mr(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);function Cp(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();const ai="modulepreload",ci=function(e){return"/static/vue3/runtime/playground/"+e},yr={},Mt=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),i=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.all(r.map(a=>{if(a=ci(a),a in yr)return;yr[a]=!0;const c=a.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector('link[href="'.concat(a,'"]').concat(u)))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":ai,c||(f.as="script",f.crossOrigin=""),f.href=a,i&&f.setAttribute("nonce",i),document.head.appendChild(f),c)return new Promise((l,h)=>{f.addEventListener("load",l),f.addEventListener("error",()=>h(new Error("Unable to preload CSS for ".concat(a))))})}))}return s.then(()=>t()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})};var Dn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ui(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Kt={exports:{}},Ae=typeof Reflect=="object"?Reflect:null,br=Ae&&typeof Ae.apply=="function"?Ae.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},ut;Ae&&typeof Ae.ownKeys=="function"?ut=Ae.ownKeys:Object.getOwnPropertySymbols?ut=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:ut=function(t){return Object.getOwnPropertyNames(t)};function fi(e){console&&console.warn&&console.warn(e)}var Mn=Number.isNaN||function(t){return t!==t};function A(){A.init.call(this)}Kt.exports=A;Kt.exports.once=pi;A.EventEmitter=A;A.prototype._events=void 0;A.prototype._eventsCount=0;A.prototype._maxListeners=void 0;var vr=10;function wt(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(A,"defaultMaxListeners",{enumerable:!0,get:function(){return vr},set:function(e){if(typeof e!="number"||e<0||Mn(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");vr=e}});A.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};A.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Mn(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function xn(e){return e._maxListeners===void 0?A.defaultMaxListeners:e._maxListeners}A.prototype.getMaxListeners=function(){return xn(this)};A.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var s=t==="error",o=this._events;if(o!==void 0)s=s&&o.error===void 0;else if(!s)return!1;if(s){var i;if(r.length>0&&(i=r[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var c=o[t];if(c===void 0)return!1;if(typeof c=="function")br(c,this,r);else for(var u=c.length,f=Fn(c,u),n=0;n<u;++n)br(f[n],this,r);return!0};function Ln(e,t,r,n){var s,o,i;if(wt(r),o=e._events,o===void 0?(o=e._events=Object.create(null),e._eventsCount=0):(o.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),i=o[t]),i===void 0)i=o[t]=r,++e._eventsCount;else if(typeof i=="function"?i=o[t]=n?[r,i]:[i,r]:n?i.unshift(r):i.push(r),s=xn(e),s>0&&i.length>s&&!i.warned){i.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=i.length,fi(a)}return e}A.prototype.addListener=function(t,r){return Ln(this,t,r,!1)};A.prototype.on=A.prototype.addListener;A.prototype.prependListener=function(t,r){return Ln(this,t,r,!0)};function li(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Pn(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},s=li.bind(n);return s.listener=r,n.wrapFn=s,s}A.prototype.once=function(t,r){return wt(r),this.on(t,Pn(this,t,r)),this};A.prototype.prependOnceListener=function(t,r){return wt(r),this.prependListener(t,Pn(this,t,r)),this};A.prototype.removeListener=function(t,r){var n,s,o,i,a;if(wt(r),s=this._events,s===void 0)return this;if(n=s[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete s[t],s.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===r||n[i].listener===r){a=n[i].listener,o=i;break}if(o<0)return this;o===0?n.shift():hi(n,o),n.length===1&&(s[t]=n[0]),s.removeListener!==void 0&&this.emit("removeListener",t,a||r)}return this};A.prototype.off=A.prototype.removeListener;A.prototype.removeAllListeners=function(t){var r,n,s;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var o=Object.keys(n),i;for(s=0;s<o.length;++s)i=o[s],i!=="removeListener"&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(s=r.length-1;s>=0;s--)this.removeListener(t,r[s]);return this};function Rn(e,t,r){var n=e._events;if(n===void 0)return[];var s=n[t];return s===void 0?[]:typeof s=="function"?r?[s.listener||s]:[s]:r?di(s):Fn(s,s.length)}A.prototype.listeners=function(t){return Rn(this,t,!0)};A.prototype.rawListeners=function(t){return Rn(this,t,!1)};A.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Nn.call(e,t)};A.prototype.listenerCount=Nn;function Nn(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}A.prototype.eventNames=function(){return this._eventsCount>0?ut(this._events):[]};function Fn(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function hi(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function di(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function pi(e,t){return new Promise(function(r,n){function s(i){e.removeListener(t,o),n(i)}function o(){typeof e.removeListener=="function"&&e.removeListener("error",s),r([].slice.call(arguments))}Un(e,t,o,{once:!0}),t!=="error"&&gi(e,s,{once:!0})})}function gi(e,t,r){typeof e.on=="function"&&Un(e,"error",t,r)}function Un(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function s(o){n.once&&e.removeEventListener(t,s),r(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var Tt=Kt.exports;const Wn=ui(Tt);var Hn=typeof global=="object"&&global&&global.Object===Object&&global,mi=typeof self=="object"&&self&&self.Object===Object&&self,J=Hn||mi||Function("return this")(),ce=J.Symbol,kn=Object.prototype,yi=kn.hasOwnProperty,bi=kn.toString,ke=ce?ce.toStringTag:void 0;function vi(e){var t=yi.call(e,ke),r=e[ke];try{e[ke]=void 0;var n=!0}catch(o){}var s=bi.call(e);return n&&(t?e[ke]=r:delete e[ke]),s}var $i=Object.prototype,_i=$i.toString;function wi(e){return _i.call(e)}var Ti="[object Null]",Oi="[object Undefined]",$r=ce?ce.toStringTag:void 0;function Le(e){return e==null?e===void 0?Oi:Ti:$r&&$r in Object(e)?vi(e):wi(e)}function Pe(e){return e!=null&&typeof e=="object"}var Si="[object Symbol]";function Vt(e){return typeof e=="symbol"||Pe(e)&&Le(e)==Si}function ji(e,t){for(var r=-1,n=e==null?0:e.length,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s}var te=Array.isArray,Ei=1/0,_r=ce?ce.prototype:void 0,wr=_r?_r.toString:void 0;function Bn(e){if(typeof e=="string")return e;if(te(e))return ji(e,Bn)+"";if(Vt(e))return wr?wr.call(e):"";var t=e+"";return t=="0"&&1/e==-Ei?"-0":t}function ge(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ai="[object AsyncFunction]",Ii="[object Function]",Ci="[object GeneratorFunction]",Di="[object Proxy]";function zn(e){if(!ge(e))return!1;var t=Le(e);return t==Ii||t==Ci||t==Ai||t==Di}var xt=J["__core-js_shared__"],Tr=function(){var e=/[^.]+$/.exec(xt&&xt.keys&&xt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Mi(e){return!!Tr&&Tr in e}var xi=Function.prototype,Li=xi.toString;function ve(e){if(e!=null){try{return Li.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var Pi=/[\\^$.*+?()[\]{}|]/g,Ri=/^\[object .+?Constructor\]$/,Ni=Function.prototype,Fi=Object.prototype,Ui=Ni.toString,Wi=Fi.hasOwnProperty,Hi=RegExp("^"+Ui.call(Wi).replace(Pi,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ki(e){if(!ge(e)||Mi(e))return!1;var t=zn(e)?Hi:Ri;return t.test(ve(e))}function Bi(e,t){return e==null?void 0:e[t]}function $e(e,t){var r=Bi(e,t);return ki(r)?r:void 0}var Ut=$e(J,"WeakMap"),Or=Object.create,zi=function(){function e(){}return function(t){if(!ge(t))return{};if(Or)return Or(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function Gi(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var Sr=function(){try{var e=$e(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();function qi(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var Qi=9007199254740991,Yi=/^(?:0|[1-9]\d*)$/;function Jt(e,t){var r=typeof e;return t=t==null?Qi:t,!!t&&(r=="number"||r!="symbol"&&Yi.test(e))&&e>-1&&e%1==0&&e<t}function Gn(e,t,r){t=="__proto__"&&Sr?Sr(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function qn(e,t){return e===t||e!==e&&t!==t}var Ki=Object.prototype,Vi=Ki.hasOwnProperty;function Xt(e,t,r){var n=e[t];(!(Vi.call(e,t)&&qn(n,r))||r===void 0&&!(t in e))&&Gn(e,t,r)}function Ot(e,t,r,n){var s=!r;r||(r={});for(var o=-1,i=t.length;++o<i;){var a=t[o],c=void 0;c===void 0&&(c=e[a]),s?Gn(r,a,c):Xt(r,a,c)}return r}var Ji=9007199254740991;function Zt(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ji}function er(e){return e!=null&&Zt(e.length)&&!zn(e)}var Xi=Object.prototype;function St(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Xi;return e===r}function Zi(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var eo="[object Arguments]";function jr(e){return Pe(e)&&Le(e)==eo}var Qn=Object.prototype,to=Qn.hasOwnProperty,ro=Qn.propertyIsEnumerable,tr=jr(function(){return arguments}())?jr:function(e){return Pe(e)&&to.call(e,"callee")&&!ro.call(e,"callee")};function no(){return!1}var Yn=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Er=Yn&&typeof module=="object"&&module&&!module.nodeType&&module,so=Er&&Er.exports===Yn,Ar=so?J.Buffer:void 0,io=Ar?Ar.isBuffer:void 0,rr=io||no,oo="[object Arguments]",ao="[object Array]",co="[object Boolean]",uo="[object Date]",fo="[object Error]",lo="[object Function]",ho="[object Map]",po="[object Number]",go="[object Object]",mo="[object RegExp]",yo="[object Set]",bo="[object String]",vo="[object WeakMap]",$o="[object ArrayBuffer]",_o="[object DataView]",wo="[object Float32Array]",To="[object Float64Array]",Oo="[object Int8Array]",So="[object Int16Array]",jo="[object Int32Array]",Eo="[object Uint8Array]",Ao="[object Uint8ClampedArray]",Io="[object Uint16Array]",Co="[object Uint32Array]",M={};M[wo]=M[To]=M[Oo]=M[So]=M[jo]=M[Eo]=M[Ao]=M[Io]=M[Co]=!0;M[oo]=M[ao]=M[$o]=M[co]=M[_o]=M[uo]=M[fo]=M[lo]=M[ho]=M[po]=M[go]=M[mo]=M[yo]=M[bo]=M[vo]=!1;function Do(e){return Pe(e)&&Zt(e.length)&&!!M[Le(e)]}function nr(e){return function(t){return e(t)}}var Kn=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ze=Kn&&typeof module=="object"&&module&&!module.nodeType&&module,Mo=ze&&ze.exports===Kn,Lt=Mo&&Hn.process,De=function(){try{var e=ze&&ze.require&&ze.require("util").types;return e||Lt&&Lt.binding&&Lt.binding("util")}catch(t){}}(),Ir=De&&De.isTypedArray,Vn=Ir?nr(Ir):Do,xo=Object.prototype,Lo=xo.hasOwnProperty;function Jn(e,t){var r=te(e),n=!r&&tr(e),s=!r&&!n&&rr(e),o=!r&&!n&&!s&&Vn(e),i=r||n||s||o,a=i?Zi(e.length,String):[],c=a.length;for(var u in e)(t||Lo.call(e,u))&&!(i&&(u=="length"||s&&(u=="offset"||u=="parent")||o&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Jt(u,c)))&&a.push(u);return a}function Xn(e,t){return function(r){return e(t(r))}}var Po=Xn(Object.keys,Object),Ro=Object.prototype,No=Ro.hasOwnProperty;function Zn(e){if(!St(e))return Po(e);var t=[];for(var r in Object(e))No.call(e,r)&&r!="constructor"&&t.push(r);return t}function sr(e){return er(e)?Jn(e):Zn(e)}function Fo(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var Uo=Object.prototype,Wo=Uo.hasOwnProperty;function Ho(e){if(!ge(e))return Fo(e);var t=St(e),r=[];for(var n in e)n=="constructor"&&(t||!Wo.call(e,n))||r.push(n);return r}function ir(e){return er(e)?Jn(e,!0):Ho(e)}var ko=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Bo=/^\w*$/;function zo(e,t){if(te(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Vt(e)?!0:Bo.test(e)||!ko.test(e)||t!=null&&e in Object(t)}var Qe=$e(Object,"create");function Go(){this.__data__=Qe?Qe(null):{},this.size=0}function qo(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Qo="__lodash_hash_undefined__",Yo=Object.prototype,Ko=Yo.hasOwnProperty;function Vo(e){var t=this.__data__;if(Qe){var r=t[e];return r===Qo?void 0:r}return Ko.call(t,e)?t[e]:void 0}var Jo=Object.prototype,Xo=Jo.hasOwnProperty;function Zo(e){var t=this.__data__;return Qe?t[e]!==void 0:Xo.call(t,e)}var ea="__lodash_hash_undefined__";function ta(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Qe&&t===void 0?ea:t,this}function me(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}me.prototype.clear=Go;me.prototype.delete=qo;me.prototype.get=Vo;me.prototype.has=Zo;me.prototype.set=ta;function ra(){this.__data__=[],this.size=0}function jt(e,t){for(var r=e.length;r--;)if(qn(e[r][0],t))return r;return-1}var na=Array.prototype,sa=na.splice;function ia(e){var t=this.__data__,r=jt(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():sa.call(t,r,1),--this.size,!0}function oa(e){var t=this.__data__,r=jt(t,e);return r<0?void 0:t[r][1]}function aa(e){return jt(this.__data__,e)>-1}function ca(e,t){var r=this.__data__,n=jt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function re(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}re.prototype.clear=ra;re.prototype.delete=ia;re.prototype.get=oa;re.prototype.has=aa;re.prototype.set=ca;var Ye=$e(J,"Map");function ua(){this.size=0,this.__data__={hash:new me,map:new(Ye||re),string:new me}}function fa(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Et(e,t){var r=e.__data__;return fa(t)?r[typeof t=="string"?"string":"hash"]:r.map}function la(e){var t=Et(this,e).delete(e);return this.size-=t?1:0,t}function ha(e){return Et(this,e).get(e)}function da(e){return Et(this,e).has(e)}function pa(e,t){var r=Et(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function ue(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ue.prototype.clear=ua;ue.prototype.delete=la;ue.prototype.get=ha;ue.prototype.has=da;ue.prototype.set=pa;var ga="Expected a function";function or(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(ga);var r=function(){var n=arguments,s=t?t.apply(this,n):n[0],o=r.cache;if(o.has(s))return o.get(s);var i=e.apply(this,n);return r.cache=o.set(s,i)||o,i};return r.cache=new(or.Cache||ue),r}or.Cache=ue;var ma=500;function ya(e){var t=or(e,function(n){return r.size===ma&&r.clear(),n}),r=t.cache;return t}var ba=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,va=/\\(\\)?/g,$a=ya(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(ba,function(r,n,s,o){t.push(s?o.replace(va,"$1"):n||r)}),t});function _a(e){return e==null?"":Bn(e)}function es(e,t){return te(e)?e:zo(e,t)?[e]:$a(_a(e))}var wa=1/0;function ts(e){if(typeof e=="string"||Vt(e))return e;var t=e+"";return t=="0"&&1/e==-wa?"-0":t}function rs(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}var ns=Xn(Object.getPrototypeOf,Object);function Ta(){this.__data__=new re,this.size=0}function Oa(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function Sa(e){return this.__data__.get(e)}function ja(e){return this.__data__.has(e)}var Ea=200;function Aa(e,t){var r=this.__data__;if(r instanceof re){var n=r.__data__;if(!Ye||n.length<Ea-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ue(n)}return r.set(e,t),this.size=r.size,this}function Re(e){var t=this.__data__=new re(e);this.size=t.size}Re.prototype.clear=Ta;Re.prototype.delete=Oa;Re.prototype.get=Sa;Re.prototype.has=ja;Re.prototype.set=Aa;function Ia(e,t){return e&&Ot(t,sr(t),e)}function Ca(e,t){return e&&Ot(t,ir(t),e)}var ss=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Cr=ss&&typeof module=="object"&&module&&!module.nodeType&&module,Da=Cr&&Cr.exports===ss,Dr=Da?J.Buffer:void 0,Mr=Dr?Dr.allocUnsafe:void 0;function Ma(e,t){if(t)return e.slice();var r=e.length,n=Mr?Mr(r):new e.constructor(r);return e.copy(n),n}function xa(e,t){for(var r=-1,n=e==null?0:e.length,s=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[s++]=i)}return o}function is(){return[]}var La=Object.prototype,Pa=La.propertyIsEnumerable,xr=Object.getOwnPropertySymbols,ar=xr?function(e){return e==null?[]:(e=Object(e),xa(xr(e),function(t){return Pa.call(e,t)}))}:is;function Ra(e,t){return Ot(e,ar(e),t)}var Na=Object.getOwnPropertySymbols,os=Na?function(e){for(var t=[];e;)rs(t,ar(e)),e=ns(e);return t}:is;function Fa(e,t){return Ot(e,os(e),t)}function as(e,t,r){var n=t(e);return te(e)?n:rs(n,r(e))}function Ua(e){return as(e,sr,ar)}function Wa(e){return as(e,ir,os)}var Wt=$e(J,"DataView"),Ht=$e(J,"Promise"),kt=$e(J,"Set"),Lr="[object Map]",Ha="[object Object]",Pr="[object Promise]",Rr="[object Set]",Nr="[object WeakMap]",Fr="[object DataView]",ka=ve(Wt),Ba=ve(Ye),za=ve(Ht),Ga=ve(kt),qa=ve(Ut),K=Le;(Wt&&K(new Wt(new ArrayBuffer(1)))!=Fr||Ye&&K(new Ye)!=Lr||Ht&&K(Ht.resolve())!=Pr||kt&&K(new kt)!=Rr||Ut&&K(new Ut)!=Nr)&&(K=function(e){var t=Le(e),r=t==Ha?e.constructor:void 0,n=r?ve(r):"";if(n)switch(n){case ka:return Fr;case Ba:return Lr;case za:return Pr;case Ga:return Rr;case qa:return Nr}return t});var Qa=Object.prototype,Ya=Qa.hasOwnProperty;function Ka(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&Ya.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var Ur=J.Uint8Array;function cr(e){var t=new e.constructor(e.byteLength);return new Ur(t).set(new Ur(e)),t}function Va(e,t){var r=t?cr(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var Ja=/\w*$/;function Xa(e){var t=new e.constructor(e.source,Ja.exec(e));return t.lastIndex=e.lastIndex,t}var Wr=ce?ce.prototype:void 0,Hr=Wr?Wr.valueOf:void 0;function Za(e){return Hr?Object(Hr.call(e)):{}}function ec(e,t){var r=t?cr(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var tc="[object Boolean]",rc="[object Date]",nc="[object Map]",sc="[object Number]",ic="[object RegExp]",oc="[object Set]",ac="[object String]",cc="[object Symbol]",uc="[object ArrayBuffer]",fc="[object DataView]",lc="[object Float32Array]",hc="[object Float64Array]",dc="[object Int8Array]",pc="[object Int16Array]",gc="[object Int32Array]",mc="[object Uint8Array]",yc="[object Uint8ClampedArray]",bc="[object Uint16Array]",vc="[object Uint32Array]";function $c(e,t,r){var n=e.constructor;switch(t){case uc:return cr(e);case tc:case rc:return new n(+e);case fc:return Va(e,r);case lc:case hc:case dc:case pc:case gc:case mc:case yc:case bc:case vc:return ec(e,r);case nc:return new n;case sc:case ac:return new n(e);case ic:return Xa(e);case oc:return new n;case cc:return Za(e)}}function _c(e){return typeof e.constructor=="function"&&!St(e)?zi(ns(e)):{}}var wc="[object Map]";function Tc(e){return Pe(e)&&K(e)==wc}var kr=De&&De.isMap,Oc=kr?nr(kr):Tc,Sc="[object Set]";function jc(e){return Pe(e)&&K(e)==Sc}var Br=De&&De.isSet,Ec=Br?nr(Br):jc,Ac=1,Ic=2,Cc=4,cs="[object Arguments]",Dc="[object Array]",Mc="[object Boolean]",xc="[object Date]",Lc="[object Error]",us="[object Function]",Pc="[object GeneratorFunction]",Rc="[object Map]",Nc="[object Number]",fs="[object Object]",Fc="[object RegExp]",Uc="[object Set]",Wc="[object String]",Hc="[object Symbol]",kc="[object WeakMap]",Bc="[object ArrayBuffer]",zc="[object DataView]",Gc="[object Float32Array]",qc="[object Float64Array]",Qc="[object Int8Array]",Yc="[object Int16Array]",Kc="[object Int32Array]",Vc="[object Uint8Array]",Jc="[object Uint8ClampedArray]",Xc="[object Uint16Array]",Zc="[object Uint32Array]",C={};C[cs]=C[Dc]=C[Bc]=C[zc]=C[Mc]=C[xc]=C[Gc]=C[qc]=C[Qc]=C[Yc]=C[Kc]=C[Rc]=C[Nc]=C[fs]=C[Fc]=C[Uc]=C[Wc]=C[Hc]=C[Vc]=C[Jc]=C[Xc]=C[Zc]=!0;C[Lc]=C[us]=C[kc]=!1;function ft(e,t,r,n,s,o){var i,a=t&Ac,c=t&Ic,u=t&Cc;if(i!==void 0)return i;if(!ge(e))return e;var f=te(e);if(f){if(i=Ka(e),!a)return Gi(e,i)}else{var l=K(e),h=l==us||l==Pc;if(rr(e))return Ma(e,a);if(l==fs||l==cs||h&&!s){if(i=c||h?{}:_c(e),!a)return c?Fa(e,Ca(i,e)):Ra(e,Ia(i,e))}else{if(!C[l])return s?e:{};i=$c(e,l,a)}}o||(o=new Re);var d=o.get(e);if(d)return d;o.set(e,i),Ec(e)?e.forEach(function(_){i.add(ft(_,t,r,_,e,o))}):Oc(e)&&e.forEach(function(_,j){i.set(j,ft(_,t,r,j,e,o))});var m=u?c?Wa:Ua:c?ir:sr,y=f?void 0:m(e);return qi(y||e,function(_,j){y&&(j=_,_=e[j]),Xt(i,j,ft(_,t,r,j,e,o))}),i}var eu=1,tu=4;function ru(e){return ft(e,eu|tu)}function nu(e,t,r){t=es(t,e);for(var n=-1,s=t.length,o=!1;++n<s;){var i=ts(t[n]);if(!(o=e!=null&&r(e,i)))break;e=e[i]}return o||++n!=s?o:(s=e==null?0:e.length,!!s&&Zt(s)&&Jt(i,s)&&(te(e)||tr(e)))}var su=Object.prototype,iu=su.hasOwnProperty;function ou(e,t){return e!=null&&iu.call(e,t)}function au(e,t){return e!=null&&nu(e,t,ou)}var cu="[object Map]",uu="[object Set]",fu=Object.prototype,lu=fu.hasOwnProperty;function hu(e){if(e==null)return!0;if(er(e)&&(te(e)||typeof e=="string"||typeof e.splice=="function"||rr(e)||Vn(e)||tr(e)))return!e.length;var t=K(e);if(t==cu||t==uu)return!e.size;if(St(e))return!Zn(e).length;for(var r in e)if(lu.call(e,r))return!1;return!0}function du(e,t,r,n){if(!ge(e))return e;t=es(t,e);for(var s=-1,o=t.length,i=o-1,a=e;a!=null&&++s<o;){var c=ts(t[s]),u=r;if(c==="__proto__"||c==="constructor"||c==="prototype")return e;if(s!=i){var f=a[c];u=void 0,u===void 0&&(u=ge(f)?f:Jt(t[s+1])?[]:{})}Xt(a,c,u),a=a[c]}return e}function pu(e,t,r){return e==null?e:du(e,t,r)}var gu={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Dn,function(){var r=1e3,n=6e4,s=36e5,o="millisecond",i="second",a="minute",c="hour",u="day",f="week",l="month",h="quarter",d="year",m="date",y="Invalid Date",_=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,j=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,S={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(w){var v=["th","st","nd","rd"],g=w%100;return"["+w+(v[(g-20)%10]||v[g]||v[0])+"]"}},L=function(w,v,g){var $=String(w);return!$||$.length>=v?w:""+Array(v+1-$.length).join(g)+w},G={s:L,z:function(w){var v=-w.utcOffset(),g=Math.abs(v),$=Math.floor(g/60),b=g%60;return(v<=0?"+":"-")+L($,2,"0")+":"+L(b,2,"0")},m:function w(v,g){if(v.date()<g.date())return-w(g,v);var $=12*(g.year()-v.year())+(g.month()-v.month()),b=v.clone().add($,l),T=g-b<0,O=v.clone().add($+(T?-1:1),l);return+(-($+(g-b)/(T?b-O:O-b))||0)},a:function(w){return w<0?Math.ceil(w)||0:Math.floor(w)},p:function(w){return{M:l,y:d,w:f,d:u,D:m,h:c,m:a,s:i,ms:o,Q:h}[w]||String(w||"").toLowerCase().replace(/s$/,"")},u:function(w){return w===void 0}},W="en",k={};k[W]=S;var Oe="$isDayjsObject",Ue=function(w){return w instanceof nt||!(!w||!w[Oe])},ie=function w(v,g,$){var b;if(!v)return W;if(typeof v=="string"){var T=v.toLowerCase();k[T]&&(b=T),g&&(k[T]=g,b=T);var O=v.split("-");if(!b&&O.length>1)return w(O[0])}else{var I=v.name;k[I]=v,b=I}return!$&&b&&(W=b),b||!$&&W},R=function(w,v){if(Ue(w))return w.clone();var g=typeof v=="object"?v:{};return g.date=w,g.args=arguments,new nt(g)},E=G;E.l=ie,E.i=Ue,E.w=function(w,v){return R(w,{locale:v.$L,utc:v.$u,x:v.$x,$offset:v.$offset})};var nt=function(){function w(g){this.$L=ie(g.locale,null,!0),this.parse(g),this.$x=this.$x||g.x||{},this[Oe]=!0}var v=w.prototype;return v.parse=function(g){this.$d=function($){var b=$.date,T=$.utc;if(b===null)return new Date(NaN);if(E.u(b))return new Date;if(b instanceof Date)return new Date(b);if(typeof b=="string"&&!/Z$/i.test(b)){var O=b.match(_);if(O){var I=O[2]-1||0,P=(O[7]||"0").substring(0,3);return T?new Date(Date.UTC(O[1],I,O[3]||1,O[4]||0,O[5]||0,O[6]||0,P)):new Date(O[1],I,O[3]||1,O[4]||0,O[5]||0,O[6]||0,P)}}return new Date(b)}(g),this.init()},v.init=function(){var g=this.$d;this.$y=g.getFullYear(),this.$M=g.getMonth(),this.$D=g.getDate(),this.$W=g.getDay(),this.$H=g.getHours(),this.$m=g.getMinutes(),this.$s=g.getSeconds(),this.$ms=g.getMilliseconds()},v.$utils=function(){return E},v.isValid=function(){return this.$d.toString()!==y},v.isSame=function(g,$){var b=R(g);return this.startOf($)<=b&&b<=this.endOf($)},v.isAfter=function(g,$){return R(g)<this.startOf($)},v.isBefore=function(g,$){return this.endOf($)<R(g)},v.$g=function(g,$,b){return E.u(g)?this[$]:this.set(b,g)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(g,$){var b=this,T=!!E.u($)||$,O=E.p(g),I=function(he,H){var oe=E.w(b.$u?Date.UTC(b.$y,H,he):new Date(b.$y,H,he),b);return T?oe:oe.endOf(u)},P=function(he,H){return E.w(b.toDate()[he].apply(b.toDate("s"),(T?[0,0,0,0]:[23,59,59,999]).slice(H)),b)},N=this.$W,U=this.$M,B=this.$D,Se="set"+(this.$u?"UTC":"");switch(O){case d:return T?I(1,0):I(31,11);case l:return T?I(1,U):I(0,U+1);case f:var le=this.$locale().weekStart||0,We=(N<le?N+7:N)-le;return I(T?B-We:B+(6-We),U);case u:case m:return P(Se+"Hours",0);case c:return P(Se+"Minutes",1);case a:return P(Se+"Seconds",2);case i:return P(Se+"Milliseconds",3);default:return this.clone()}},v.endOf=function(g){return this.startOf(g,!1)},v.$set=function(g,$){var b,T=E.p(g),O="set"+(this.$u?"UTC":""),I=(b={},b[u]=O+"Date",b[m]=O+"Date",b[l]=O+"Month",b[d]=O+"FullYear",b[c]=O+"Hours",b[a]=O+"Minutes",b[i]=O+"Seconds",b[o]=O+"Milliseconds",b)[T],P=T===u?this.$D+($-this.$W):$;if(T===l||T===d){var N=this.clone().set(m,1);N.$d[I](P),N.init(),this.$d=N.set(m,Math.min(this.$D,N.daysInMonth())).$d}else I&&this.$d[I](P);return this.init(),this},v.set=function(g,$){return this.clone().$set(g,$)},v.get=function(g){return this[E.p(g)]()},v.add=function(g,$){var b,T=this;g=Number(g);var O=E.p($),I=function(U){var B=R(T);return E.w(B.date(B.date()+Math.round(U*g)),T)};if(O===l)return this.set(l,this.$M+g);if(O===d)return this.set(d,this.$y+g);if(O===u)return I(1);if(O===f)return I(7);var P=(b={},b[a]=n,b[c]=s,b[i]=r,b)[O]||1,N=this.$d.getTime()+g*P;return E.w(N,this)},v.subtract=function(g,$){return this.add(-1*g,$)},v.format=function(g){var $=this,b=this.$locale();if(!this.isValid())return b.invalidDate||y;var T=g||"YYYY-MM-DDTHH:mm:ssZ",O=E.z(this),I=this.$H,P=this.$m,N=this.$M,U=b.weekdays,B=b.months,Se=b.meridiem,le=function(H,oe,He,st){return H&&(H[oe]||H($,T))||He[oe].slice(0,st)},We=function(H){return E.s(I%12||12,H,"0")},he=Se||function(H,oe,He){var st=H<12?"AM":"PM";return He?st.toLowerCase():st};return T.replace(j,function(H,oe){return oe||function(He){switch(He){case"YY":return String($.$y).slice(-2);case"YYYY":return E.s($.$y,4,"0");case"M":return N+1;case"MM":return E.s(N+1,2,"0");case"MMM":return le(b.monthsShort,N,B,3);case"MMMM":return le(B,N);case"D":return $.$D;case"DD":return E.s($.$D,2,"0");case"d":return String($.$W);case"dd":return le(b.weekdaysMin,$.$W,U,2);case"ddd":return le(b.weekdaysShort,$.$W,U,3);case"dddd":return U[$.$W];case"H":return String(I);case"HH":return E.s(I,2,"0");case"h":return We(1);case"hh":return We(2);case"a":return he(I,P,!0);case"A":return he(I,P,!1);case"m":return String(P);case"mm":return E.s(P,2,"0");case"s":return String($.$s);case"ss":return E.s($.$s,2,"0");case"SSS":return E.s($.$ms,3,"0");case"Z":return O}return null}(H)||O.replace(":","")})},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(g,$,b){var T,O=this,I=E.p($),P=R(g),N=(P.utcOffset()-this.utcOffset())*n,U=this-P,B=function(){return E.m(O,P)};switch(I){case d:T=B()/12;break;case l:T=B();break;case h:T=B()/3;break;case f:T=(U-N)/6048e5;break;case u:T=(U-N)/864e5;break;case c:T=U/s;break;case a:T=U/n;break;case i:T=U/r;break;default:T=U}return b?T:E.a(T)},v.daysInMonth=function(){return this.endOf(l).$D},v.$locale=function(){return k[this.$L]},v.locale=function(g,$){if(!g)return this.$L;var b=this.clone(),T=ie(g,$,!0);return T&&(b.$L=T),b},v.clone=function(){return E.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},w}(),pr=nt.prototype;return R.prototype=pr,[["$ms",o],["$s",i],["$m",a],["$H",c],["$W",u],["$M",l],["$y",d],["$D",m]].forEach(function(w){pr[w[1]]=function(v){return this.$g(v,w[0],w[1])}}),R.extend=function(w,v){return w.$i||(w(v,nt,R),w.$i=!0),R},R.locale=ie,R.isDayjs=Ue,R.unix=function(w){return R(1e3*w)},R.en=k[W],R.Ls=k,R.p={},R})})(gu);var mu={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Dn,function(){var r="minute",n=/[+-]\d\d(?::?\d\d)?/g,s=/([+-]|\d\d)/g;return function(o,i,a){var c=i.prototype;a.utc=function(y){var _={date:y,utc:!0,args:arguments};return new i(_)},c.utc=function(y){var _=a(this.toDate(),{locale:this.$L,utc:!0});return y?_.add(this.utcOffset(),r):_},c.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var u=c.parse;c.parse=function(y){y.utc&&(this.$u=!0),this.$utils().u(y.$offset)||(this.$offset=y.$offset),u.call(this,y)};var f=c.init;c.init=function(){if(this.$u){var y=this.$d;this.$y=y.getUTCFullYear(),this.$M=y.getUTCMonth(),this.$D=y.getUTCDate(),this.$W=y.getUTCDay(),this.$H=y.getUTCHours(),this.$m=y.getUTCMinutes(),this.$s=y.getUTCSeconds(),this.$ms=y.getUTCMilliseconds()}else f.call(this)};var l=c.utcOffset;c.utcOffset=function(y,_){var j=this.$utils().u;if(j(y))return this.$u?0:j(this.$offset)?l.call(this):this.$offset;if(typeof y=="string"&&(y=function(W){W===void 0&&(W="");var k=W.match(n);if(!k)return null;var Oe=(""+k[0]).match(s)||["-",0,0],Ue=Oe[0],ie=60*+Oe[1]+ +Oe[2];return ie===0?0:Ue==="+"?ie:-ie}(y),y===null))return this;var S=Math.abs(y)<=16?60*y:y,L=this;if(_)return L.$offset=S,L.$u=y===0,L;if(y!==0){var G=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(L=this.local().add(S+G,r)).$offset=S,L.$x.$localOffset=G}else L=this.utc();return L};var h=c.format;c.format=function(y){var _=y||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return h.call(this,_)},c.valueOf=function(){var y=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*y},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var d=c.toDate;c.toDate=function(y){return y==="s"&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var m=c.diff;c.diff=function(y,_,j){if(y&&this.$u===y.$u)return m.call(this,y,_,j);var S=this.local(),L=a(y).local();return m.call(S,L,_,j)}}})})(mu);var ur=(e=>(e.CONTAINER="container",e.PAGE="page",e.ROOT="app",e.PAGE_FRAGMENT="page-fragment",e))(ur||{}),lt=(e=>(e.COMP="comp",e.CODE="code",e.DATA_SOURCE="data-source",e))(lt||{}),ls=(e=>(e.CODE="code",e))(ls||{}),ht=(e=>(e.CODE="code",e.DATA_SOURCE_METHOD="data-source-method",e))(ht||{});const Ge=(e,t=[])=>{const r=[],n=function(s,o){if(!Array.isArray(o))return null;for(let i=0,a=o.length;i<a;i++){const c=o[i];if(r.push(c),"".concat(c.id)==="".concat(s))return c;if(c.items){const u=n(s,c.items);if(u)return u}r.pop()}return null};return n(e,t),r},gt=e=>Object.prototype.toString.call(e)==="[object Object]",hs=e=>{var t;return e?((t=e.type)==null?void 0:t.toLowerCase())===ur.PAGE:!1},yu=e=>{var t;return e?((t=e.type)==null?void 0:t.toLowerCase())===ur.PAGE_FRAGMENT:!1},ye=(e="",t={})=>(Array.isArray(e)?e:"".concat(e).replaceAll(/\[(\d+)\]/g,".$1").split(".")).reduce((n,s)=>{if(gt(n)||Array.isArray(n))return n[s]},t),Bt=(e,t,r={})=>pu(r,e,t),Pt=(e,t=[])=>{const r=[],n=function(s,o){if(Array.isArray(o))for(let i=0,a=o.length;i<a;i++){const c=o[i],u=s.findIndex(f=>"".concat(f)==="".concat(c.id));u>-1&&(s.slice(u,1),r.push(c)),c.items&&n(s,c.items)}};return n(e,t),r},bu=(e={},t)=>Array.from(Object.values(e).reduce((r,n)=>{var s;return(((s=n[t])==null?void 0:s.keys)||[]).forEach(o=>r.add(o)),r},new Set)),zr=(e={})=>Array.from(Object.values(e).reduce((t,r)=>(Object.keys(r).forEach(n=>{t.add(n)}),t),new Set)),ds=(e,t,r)=>{var a;const n=Ge(e.id,t),s=n.pop();let o=n.pop();if(r&&(o=Ge(r,t).pop()),!s)throw new Error("未找到目标节点");if(!o)throw new Error("未找到父节点");const i=(a=o.items)==null?void 0:a.findIndex(c=>c.id===s.id);o.items.splice(i,1,e)},ps="__tmagic__",gs=(e,t,r={},n)=>{let s=[];if(!n)s=bu(r,t.id);else{const o=r[n];s=(o==null?void 0:o[t.id].keys)||[]}return s.forEach(o=>{const i="".concat(o).replaceAll(/\[(\d+)\]/g,".$1").split("."),a=i.map((l,h)=>h<i.length-1?l:"".concat(ps).concat(l)),c=ye(o,t);let u=ye(a,t);typeof u>"u"&&(Bt(a.join("."),c,t),u=c);let f;try{f=e(u)}catch(l){console.error(l),f=""}Bt(o,f,t)}),t},ms=(e,t,r,n=[])=>{var s,o;switch(typeof t=="string"&&typeof r>"u"&&(r=""),e){case"is":return t===r;case"not":return t!==r;case"=":return t===r;case"!=":return t!==r;case">":return t>r;case">=":return t>=r;case"<":return t<r;case"<=":return t<=r;case"between":return n.length>1&&t>=n[0]&&t<=n[1];case"not_between":return n.length<2||t<n[0]||t>n[1];case"include":return(s=t==null?void 0:t.includes)==null?void 0:s.call(t,r);case"not_include":return typeof t>"u"||!((o=t.includes)!=null&&o.call(t,r))}return!1},ys=e=>{const t={},r={string:void 0,object:{},array:[],boolean:void 0,number:void 0,null:null,any:void 0};return e.forEach(n=>{if(typeof n.defaultValue<"u"){if(n.type==="array"&&!Array.isArray(n.defaultValue)){t[n.name]=r.array;return}if(n.type==="object"&&!gt(n.defaultValue)){if(typeof n.defaultValue=="string"){try{t[n.name]=JSON.parse(n.defaultValue)}catch(s){t[n.name]=r.object}return}t[n.name]=r.object;return}t[n.name]=ru(n.defaultValue);return}if(n.type==="object"){t[n.name]=n.fields?ys(n.fields):r.object;return}if(n.type){t[n.name]=r[n.type];return}t[n.name]=void 0}),t},mt="ds-field::",Gr="ds-field-changed";var ae=(e=>(e.DEFAULT="default",e.CODE_BLOCK="code-block",e.DATA_SOURCE="data-source",e.DATA_SOURCE_METHOD="data-source-method",e.DATA_SOURCE_COND="data-source-cond",e))(ae||{});class qr{constructor(t){p(this,"isTarget");p(this,"id");p(this,"name");p(this,"type",ae.DEFAULT);p(this,"deps",{});p(this,"isCollectByDefault");var r;this.isTarget=t.isTarget,this.id=t.id,this.name=t.name,this.isCollectByDefault=(r=t.isCollectByDefault)!=null?r:!0,t.type&&(this.type=t.type),t.initialDeps&&(this.deps=t.initialDeps)}updateDep({id:t,name:r,key:n,data:s}){const o=this.deps[t]||{name:r,keys:[]};o.name=r,o.data=s,this.deps[t]=o,o.keys.indexOf(n)===-1&&o.keys.push(n)}removeDep(t,r){if(typeof t>"u"){Object.keys(this.deps).forEach(s=>{delete this.deps[s]});return}const n=this.deps[t];if(n)if(r){const s=n.keys.indexOf(r);n.keys.splice(s,1),n.keys.length===0&&delete this.deps[t]}else delete this.deps[t]}hasDep(t,r){const n=this.deps[t];return!!(n!=null&&n.keys.find(s=>s===r))}destroy(){this.deps={}}}const vu=(e,t)=>typeof e=="string"&&e.includes("".concat(t))&&/\$\{([\s\S]+?)\}/.test(e),$u=(e,t)=>{if(!Array.isArray(e)||typeof e[0]!="string")return!1;const[r]=e,n=r.indexOf(mt);return n===-1?!1:r.substring(n+mt.length)===t},Qr=(e,t,r)=>{Object.values(e).forEach(n=>{Object.values(n).forEach(s=>{r&&s.type!==r||t(s)})})};class _u{constructor(t){p(this,"targetsList",{});p(this,"childrenProp","items");p(this,"idProp","id");p(this,"nameProp","name");t!=null&&t.initialTargets&&(this.targetsList=t.initialTargets),t!=null&&t.childrenProp&&(this.childrenProp=t.childrenProp)}getTargetsList(){return this.targetsList}getTargets(t=ae.DEFAULT){return this.targetsList[t]||{}}addTarget(t){const r=this.getTargets(t.type)||{};this.targetsList[t.type]=r,r[t.id]=t}getTarget(t,r=ae.DEFAULT){return this.getTargets(r)[t]}hasTarget(t,r=ae.DEFAULT){return!!this.getTarget(t,r)}hasSpecifiedTypeTarget(t=ae.DEFAULT){return Object.keys(this.getTargets(t)).length>0}removeTarget(t,r=ae.DEFAULT){const n=this.getTargets(r);n[t]&&(n[t].destroy(),delete n[t])}removeTargets(t=ae.DEFAULT){const r=this.targetsList[t];if(r){for(const n of Object.values(r))n.destroy();delete this.targetsList[t]}}clearTargets(){Object.keys(this.targetsList).forEach(t=>{delete this.targetsList[t]})}collect(t,r={},n=!1,s){this.collectByCallback(t,s,({node:o,target:i})=>{this.removeTargetDep(i,o),this.collectItem(o,i,r,n)})}collectByCallback(t,r,n){Qr(this.targetsList,s=>{!r&&!s.isCollectByDefault||t.forEach(o=>{n({node:o,target:s})})},r)}clear(t,r){let{targetsList:n}=this;r&&(n={[r]:this.getTargets(r)});const s=[];Qr(n,o=>{t?t.forEach(i=>{o.removeDep(i[this.idProp]),Array.isArray(i[this.childrenProp])&&i[this.childrenProp].length&&!s.includes(i[this.idProp])&&(s.push(i[this.idProp]),this.clear(i[this.childrenProp]))}):o.removeDep()})}clearByType(t,r){this.clear(r,t)}collectItem(t,r,n={},s=!1){const o=(i,a="")=>{const c=(u,f)=>{const l=u===this.childrenProp,h=a?"".concat(a,".").concat(u):u;r.isTarget(h,f)?r.updateDep({id:t[this.idProp],name:"".concat(t[this.nameProp]||t[this.idProp]),data:n,key:h}):!l&&Array.isArray(f)?f.forEach((d,m)=>{gt(d)&&o(d,"".concat(h,"[").concat(m,"]"))}):gt(f)&&o(f,h),l&&s&&Array.isArray(f)&&f.forEach(d=>{this.collectItem(d,r,n,s)})};Object.entries(i).forEach(([u,f])=>{typeof f>"u"||f===""||c(u,f)})};o(t)}removeTargetDep(t,r,n){t.removeDep(r[this.idProp],n),typeof n>"u"&&Array.isArray(r[this.childrenProp])&&r[this.childrenProp].length&&r[this.childrenProp].forEach(s=>{this.removeTargetDep(t,s,n)})}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function wu(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function a(f){try{u(n.next(f))}catch(l){i(l)}}function c(f){try{u(n.throw(f))}catch(l){i(l)}}function u(f){f.done?o(f.value):s(f.value).then(a,c)}u((n=n.apply(e,[])).next())})}const de=[];function Tu(e,t,r="*"){if(e===r)return!0;de.length=0;let n=0,s=0,o=0,i=0;for(let h=0,d=e.length;h<d;h+=1){const m=e[h];m===r&&(n+=1,h>i&&de.push(e.substring(i,h)),de.push(m),i=h+1)}if(i<e.length&&de.push(e.substring(i)),n?(s=e.length-n,o=1/0):o=s=e.length,de.length===0)return e===t;const a=t.length;if(a<s||a>o)return!1;let c=0,u=de.length-1,f=t.length-1,l=!1;for(;;){const h=de[u];if(u-=1,h===r)l=!0;else{const d=f+1-h.length,m=t.lastIndexOf(h,d);if(m===-1||m>d)return!1;if(l)f=m-1,l=!1;else{if(m!==d)return!1;f-=h.length}}if(c>u)break}return!0}class it{constructor(t,r,n,s=void 0){this.obj=t,this.delimiter=r,this.wildcard=n,this.is_match=s}shortMatch(t,r){if(t===r||t===this.wildcard)return!0;if(this.is_match)return this.is_match(t,r);const n=t.indexOf(this.wildcard);if(n>-1){const s=t.substr(n+1);if(n===0||r.substring(0,n)===t.substring(0,n)){const o=s.length;return o>0?r.substr(-o)===s:!0}}return!1}match(t,r){return this.is_match?this.is_match(t,r):t===r||t===this.wildcard||r===this.wildcard||this.shortMatch(t,r)||Tu(t,r,this.wildcard)}handleArray(t,r,n,s,o={}){let i=t.indexOf(this.delimiter,n),a=!1;i===-1&&(a=!0,i=t.length);const c=t.substring(n,i);let u=0;for(const f of r){const l=u.toString(),h=s===""?l:s+this.delimiter+u;(c===this.wildcard||c===l||this.shortMatch(c,l))&&(a?o[h]=f:this.goFurther(t,f,i+1,h,o)),u++}return o}handleObject(t,r,n,s,o={}){let i=t.indexOf(this.delimiter,n),a=!1;i===-1&&(a=!0,i=t.length);const c=t.substring(n,i);for(let u in r){u=u.toString();const f=s===""?u:s+this.delimiter+u;(c===this.wildcard||c===u||this.shortMatch(c,u))&&(a?o[f]=r[u]:this.goFurther(t,r[u],i+1,f,o))}return o}goFurther(t,r,n,s,o={}){return Array.isArray(r)?this.handleArray(t,r,n,s,o):this.handleObject(t,r,n,s,o)}get(t){return this.goFurther(t,this.obj,0,"")}}class Ee{static get(t,r,n=!1){if(!r)return;let s=r;for(const o of t)if(o in s)s=s[o];else if(n)s[o]=Object.create({}),s=s[o];else return;return s}static set(t,r,n){if(!n)return;if(t.length===0){for(const a in n)delete n[a];for(const a in r)n[a]=r[a];return}const s=t.slice(),o=s.pop(),i=Ee.get(s,n,!0);return typeof i=="object"&&(i[o]=r),r}}let ee,yt=0,ot=null;function Rt(){return(ot===null||ot.buffer!==ee.memory.buffer)&&(ot=new Uint8Array(ee.memory.buffer)),ot}let dt=new TextEncoder("utf-8");const Ou=typeof dt.encodeInto=="function"?function(e,t){return dt.encodeInto(e,t)}:function(e,t){const r=dt.encode(e);return t.set(r),{read:e.length,written:r.length}};function Yr(e,t,r){if(r===void 0){const a=dt.encode(e),c=t(a.length);return Rt().subarray(c,c+a.length).set(a),yt=a.length,c}let n=e.length,s=t(n);const o=Rt();let i=0;for(;i<n;i++){const a=e.charCodeAt(i);if(a>127)break;o[s+i]=a}if(i!==n){i!==0&&(e=e.slice(i)),s=r(s,n,n=i+e.length*3);const a=Rt().subarray(s+i,s+n),c=Ou(e,a);i+=c.written}return yt=i,s}function Su(e,t){var r=Yr(e,ee.__wbindgen_malloc,ee.__wbindgen_realloc),n=yt,s=Yr(t,ee.__wbindgen_malloc,ee.__wbindgen_realloc),o=yt,i=ee.is_match(r,n,s,o);return i!==0}async function ju(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(n){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n);else throw n}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}else{const r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}async function bs(e){const t={};(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:r,module:n}=await ju(await e,t);return ee=r.exports,bs.__wbindgen_wasm_module=n,ee}const je={only:[],source:"",debug:!1,data:void 0,queue:!1,force:!1};function Eu(e,t){console.debug(e,t)}function Au(){return{delimiter:".",debug:!1,extraDebug:!1,useMute:!0,notRecursive:";",param:":",wildcard:"*",experimentalMatch:!1,queue:!1,defaultBulkValue:!0,useCache:!1,useSplitCache:!1,useIndicesCache:!1,maxSimultaneousJobs:1e3,maxQueueRuns:1e3,log:Eu,Promise}}function Kr(e){return e&&e.constructor?e.constructor.name==="Object":typeof e=="object"&&e!==null}class Iu{constructor(t={},r={}){this.jobsRunning=0,this.updateQueue=[],this.subscribeQueue=[],this.listenersIgnoreCache=new WeakMap,this.is_match=null,this.destroyed=!1,this.queueRuns=0,this.groupId=0,this.namedGroups=[],this.numberGroups=[],this.traceId=0,this.traceMap=new Map,this.tracing=[],this.savedTrace=[],this.collection=null,this.collections=0,this.cache=new Map,this.splitCache=new Map,this.indices=new Map,this.indicesCount=new Map,this.lastExecs=new WeakMap,this.listeners=new Map,this.waitingListeners=new Map,this.options=Object.assign(Object.assign({},Au()),r),this.data=t,this.id=0,this.options.useCache?(this.pathGet=this.cacheGet,this.pathSet=this.cacheSet):(this.pathGet=Ee.get,this.pathSet=Ee.set),r.Promise?this.resolved=r.Promise.resolve():this.resolved=Promise.resolve(),this.muted=new Set,this.mutedListeners=new Set,this.scan=new it(this.data,this.options.delimiter,this.options.wildcard),this.destroyed=!1}getDefaultListenerOptions(){return{bulk:!1,bulkValue:this.options.defaultBulkValue,debug:!1,source:"",data:void 0,queue:!1,group:!1}}cacheGet(t,r=this.data,n=!1){const s=t.join(this.options.delimiter),o=this.cache.get(s);if(o){const a=o.deref();if(a)return a}const i=Ee.get(t,r,n);return(Kr(i)||Array.isArray(i))&&this.cache.set(s,new WeakRef(i)),i}cacheSet(t,r,n=this.data){const s=t.join(this.options.delimiter);return Kr(r)||Array.isArray(r)?this.cache.set(s,new WeakRef(r)):this.cache.delete(s),Ee.set(t,r,n)}silentSet(t,r){return this.pathSet(this.split(t),r,this.data)}loadWasmMatcher(t){return wu(this,void 0,void 0,function*(){yield bs(t),this.is_match=Su,this.scan=new it(this.data,this.options.delimiter,this.options.wildcard,this.is_match)})}same(t,r){return(["number","string","undefined","boolean"].includes(typeof t)||t===null)&&r===t}getListeners(){return this.listeners}destroy(){this.destroyed=!0,this.data=void 0,this.listeners=new Map,this.waitingListeners=new Map,this.updateQueue=[],this.jobsRunning=0}match(t,r,n=!0){return this.is_match?this.is_match(t,r):t===r||t===this.options.wildcard||r===this.options.wildcard?!0:!n&&this.getIndicesCount(this.options.delimiter,t)<this.getIndicesCount(this.options.delimiter,r)?!1:this.scan.match(t,r)}getIndicesOf(t,r){if(this.options.useIndicesCache&&this.indices.has(r))return this.indices.get(r);const n=t.length;if(n==0)return[];let s=0,o,i=[];for(;(o=r.indexOf(t,s))>-1;)i.push(o),s=o+n;return this.options.useIndicesCache&&this.indices.set(r,i),i}getIndicesCount(t,r){if(this.options.useIndicesCache&&this.indicesCount.has(r))return this.indicesCount.get(r);const n=t.length;if(n==0)return 0;let s=0,o,i=0;for(;(o=r.indexOf(t,s))>-1;)i++,s=o+n;return this.options.useIndicesCache&&this.indicesCount.set(r,i),i}cutPath(t,r){if(r==="")return"";if(t=this.cleanNotRecursivePath(t),r=this.cleanNotRecursivePath(r),t===r)return t;const n=this.getIndicesCount(this.options.delimiter,r),s=this.getIndicesOf(this.options.delimiter,t);return t.substring(0,s[n])}trimPath(t){return t=this.cleanNotRecursivePath(t),t.charAt(0)===this.options.delimiter?t.substr(1):t}split(t){if(t==="")return[];if(!this.options.useSplitCache)return t.split(this.options.delimiter);const r=this.splitCache.get(t);if(r)return r.slice();const n=t.split(this.options.delimiter);return this.splitCache.set(t,n.slice()),n}isWildcard(t){return t.includes(this.options.wildcard)||this.hasParams(t)}isNotRecursive(t){return t.endsWith(this.options.notRecursive)}cleanNotRecursivePath(t){return this.isNotRecursive(t)?t.substring(0,t.length-1):t}hasParams(t){return t.includes(this.options.param)}getParamsInfo(t){let r={replaced:"",original:t,params:{}},n=0,s=[];for(const o of this.split(t)){r.params[n]={original:o,replaced:"",name:""};const i=new RegExp("\\".concat(this.options.param,"([^\\").concat(this.options.delimiter,"\\").concat(this.options.param,"]+)"),"g");let a=i.exec(o);if(a)r.params[n].name=a[1];else{delete r.params[n],s.push(o),n++;continue}i.lastIndex=0,r.params[n].replaced=o.replace(i,this.options.wildcard),s.push(r.params[n].replaced),n++}return r.replaced=s.join(this.options.delimiter),r}getParams(t,r){if(!t)return;const n=this.split(r),s={};for(const o in t.params){const i=t.params[o];s[i.name]=n[o]}return s}waitForAll(t,r){const n={};for(let s of t)n[s]={dirty:!1},this.hasParams(s)&&(n[s].paramsInfo=this.getParamsInfo(s)),n[s].isWildcard=this.isWildcard(s),n[s].isRecursive=!this.isNotRecursive(s);return this.waitingListeners.set(t,{fn:r,paths:n}),r(n),function(){this.waitingListeners.delete(t)}}executeWaitingListeners(t){if(!this.destroyed)for(const r of this.waitingListeners.values()){const{fn:n,paths:s}=r;let o=0,i=0;for(let a in s){const c=s[a];let u=!1;c.isRecursive&&(t=this.cutPath(t,a)),c.isWildcard&&this.match(a,t)&&(u=!0),t===a&&(u=!0),u&&(c.dirty=!0),c.dirty&&o++,i++}o===i&&n(s)}}subscribeAll(t,r,n=this.getDefaultListenerOptions()){if(this.destroyed)return()=>{};let s=[],o=0,i=null;typeof n.group=="boolean"&&n.group?(this.groupId++,i=this.groupId,n.bulk=!0):typeof n.group=="string"&&(n.bulk=!0,i=n.group);for(const a of t)s.push(this.subscribe(a,r,n,{all:t,index:o,groupId:i})),o++;return function(){for(const c of s)c()}}getCleanListenersCollection(t={}){return Object.assign({listeners:new Map,isRecursive:!1,isWildcard:!1,hasParams:!1,match:void 0,paramsInfo:void 0,path:void 0,originalPath:void 0,count:0},t)}getCleanListener(t,r=this.getDefaultListenerOptions()){return{fn:t,options:Object.assign(Object.assign({},this.getDefaultListenerOptions()),r),groupId:null}}getListenerCollectionMatch(t,r,n){t=this.cleanNotRecursivePath(t);const s=this;return function(i,a=!1){let c=t;return r?i=s.cutPath(i,t):c=s.cutPath(s.cleanNotRecursivePath(t),i),a&&console.log("[getListenerCollectionMatch]",{listenerPath:t,scopedListenerPath:c,path:i,isRecursive:r,isWildcard:n}),n&&s.match(c,i,r)?!0:c===i}}getListenersCollection(t,r){if(this.listeners.has(t)){let a=this.listeners.get(t);return a.listeners.set(++this.id,r),r.id=this.id,a}const n=this.hasParams(t);let s;n&&(s=this.getParamsInfo(t));let o={isRecursive:!this.isNotRecursive(t),isWildcard:this.isWildcard(t),hasParams:n,paramsInfo:s,originalPath:t,path:n?s.replaced:t};o.isRecursive||(o.path=this.cleanNotRecursivePath(o.path));let i=this.getCleanListenersCollection(Object.assign(Object.assign({},o),{match:this.getListenerCollectionMatch(o.path,o.isRecursive,o.isWildcard)}));return this.id++,i.listeners.set(this.id,r),r.id=this.id,this.listeners.set(o.originalPath,i),i}subscribe(t,r,n=this.getDefaultListenerOptions(),s={all:[t],index:0,groupId:null}){if(this.destroyed)return()=>{};this.jobsRunning++;const o="subscribe";let i=this.getCleanListener(r,n);n.group&&(n.bulk=!0,typeof n.group=="string"?i.groupId=n.group:s.groupId&&(i.groupId=s.groupId)),this.listenersIgnoreCache.set(i,{truthy:[],falsy:[]});const a=this.getListenersCollection(t,i);n.debug&&console.log("[subscribe]",{listenerPath:t,options:n}),a.count++;let c=!0;if(i.groupId&&(typeof i.groupId=="string"?this.namedGroups.includes(i.groupId)?c=!1:this.namedGroups.push(i.groupId):typeof i.groupId=="number"&&(this.numberGroups.includes(i.groupId)?c=!1:this.numberGroups.push(i.groupId))),c){const u=this.cleanNotRecursivePath(a.path),f=this.split(u);if(!a.isWildcard)!this.isMuted(u)&&!this.isMuted(r)&&r(this.pathGet(f,this.data),{type:o,listener:i,listenersCollection:a,path:{listener:t,update:void 0,resolved:this.cleanNotRecursivePath(t)},params:this.getParams(a.paramsInfo,u),options:n});else{const l=this.scan.get(u);if(n.bulk){const h=[];for(const d in l)this.isMuted(d)||h.push({path:d,params:this.getParams(a.paramsInfo,d),value:l[d]});this.isMuted(r)||r(h,{type:o,listener:i,listenersCollection:a,path:{listener:t,update:void 0,resolved:void 0},options:n,params:void 0})}else for(const h in l)!this.isMuted(h)&&!this.isMuted(r)&&r(l[h],{type:o,listener:i,listenersCollection:a,path:{listener:t,update:void 0,resolved:this.cleanNotRecursivePath(h)},params:this.getParams(a.paramsInfo,h),options:n})}}return this.debugSubscribe(i,a,t),this.jobsRunning--,this.unsubscribe(t,this.id)}unsubscribe(t,r){const n=this.listeners,s=n.get(t);return function(){s.listeners.delete(r),s.count--,s.count===0&&n.delete(t)}}runQueuedListeners(){if(!this.destroyed&&this.subscribeQueue.length!==0)if(this.jobsRunning===0){this.queueRuns=0;const t=[...this.subscribeQueue];for(let r=0,n=t.length;r<n;r++)t[r]();this.subscribeQueue.length=0}else{if(this.queueRuns++,this.queueRuns>=this.options.maxQueueRuns)throw this.queueRuns=0,new Error("Maximal number of queue runs exhausted.");Promise.resolve().then(()=>this.runQueuedListeners()).catch(t=>{throw t})}}getQueueNotifyListeners(t,r=[]){for(const n in t){if(this.isMuted(n))continue;let{single:s,bulk:o}=t[n];for(const i of s){let a=!1,c=i.listener.id+":"+i.eventInfo.path.resolved;i.eventInfo.path.resolved||(c=i.listener.id+":"+i.eventInfo.path.listener);for(const f of r)if(c===f.resolvedIdPath){a=!0;break}if(a)continue;const u=this.debugTime(i);if(!this.isMuted(i.listener.fn))if(i.listener.options.queue&&this.jobsRunning)this.subscribeQueue.push(()=>{i.listener.fn(i.value?i.value():void 0,i.eventInfo)});else{let f=i.listener.id+":"+i.eventInfo.path.resolved;i.eventInfo.path.resolved||(f=i.listener.id+":"+i.eventInfo.path.listener),r.push({id:i.listener.id,resolvedPath:i.eventInfo.path.resolved,resolvedIdPath:f,originalFn:i.listener.fn,fn:()=>{i.listener.fn(i.value?i.value():void 0,i.eventInfo)},options:i.listener.options,groupId:i.listener.groupId})}this.debugListener(u,i)}for(const i of o){let a=!1;for(const f of r)if(f.id===i.listener.id){a=!0;break}if(a)continue;const c=this.debugTime(i),u=[];for(const f of i.value)u.push(Object.assign(Object.assign({},f),{value:f.value?f.value():void 0}));if(!this.isMuted(i.listener.fn))if(i.listener.options.queue&&this.jobsRunning)this.subscribeQueue.push(()=>this.jobsRunning?!1:(i.listener.fn(u,i.eventInfo),!0));else{let f=i.listener.id+":"+i.eventInfo.path.resolved;i.eventInfo.path.resolved||(f=i.listener.id+":"+i.eventInfo.path.listener),r.push({id:i.listener.id,resolvedPath:i.eventInfo.path.resolved,resolvedIdPath:f,originalFn:i.listener.fn,fn:()=>{i.listener.fn(u,i.eventInfo)},options:i.listener.options,groupId:i.listener.groupId})}this.debugListener(c,i)}}return Promise.resolve().then(()=>this.runQueuedListeners()),r}shouldIgnore(t,r){if(!t.options.ignore)return!1;for(const n of t.options.ignore){if(r.startsWith(n)||this.is_match&&this.is_match(n,r))return!0;{const s=this.cutPath(r,n);if(this.match(n,s))return!0}}return!1}getSubscribedListeners(t,r,n,s="update",o=null){n=Object.assign(Object.assign({},je),n);const i={};for(let[a,c]of this.listeners)if(c.match(t)){i[a]={single:[],bulk:[],bulkData:[]};const u=c.paramsInfo?this.getParams(c.paramsInfo,t):void 0,f=this.cutPath(t,a),h=c.isRecursive||c.isWildcard?()=>this.get(f):()=>r,d=[{value:h,path:t,params:u}];for(const m of c.listeners.values()){if(this.shouldIgnore(m,t)){m.options.debug&&console.log("[getSubscribedListeners] Listener was not fired because it was ignored.",{listener:m,listenersCollection:c});continue}m.options.bulk?i[a].bulk.push({listener:m,listenersCollection:c,eventInfo:{type:s,listener:m,path:{listener:a,update:o||t,resolved:void 0},params:u,options:n},value:d}):i[a].single.push({listener:m,listenersCollection:c,eventInfo:{type:s,listener:m,path:{listener:a,update:o||t,resolved:this.cleanNotRecursivePath(t)},params:u,options:n},value:h})}}else if(this.options.extraDebug){let u=!1;for(const f of c.listeners.values())f.options.debug&&(u=!0,console.log("[getSubscribedListeners] Listener was not fired because there was no match.",{listener:f,listenersCollection:c,updatePath:t}));u&&c.match(t,!0)}return i}notifySubscribedListeners(t,r,n,s="update",o=null){return this.getQueueNotifyListeners(this.getSubscribedListeners(t,r,n,s,o))}useBulkValue(t){for(const[r,n]of t.listeners)if(n.options.bulk&&n.options.bulkValue||!n.options.bulk)return!0;return!1}getNestedListeners(t,r,n,s="update",o=null){const i={},a={};for(let[c,u]of this.listeners){if(!u.isRecursive)continue;const f=this.cutPath(c,t);if(this.match(f,t)){i[c]={single:[],bulk:[]};const l=this.trimPath(c.substr(f.length)),h=this.useBulkValue(u);let d;h&&(d=a[l]?a[l]:new it(r,this.options.delimiter,this.options.wildcard).get(l),a[l]=d);const m=u.paramsInfo?this.getParams(u.paramsInfo,t):void 0,y=[],_={};for(const[j,S]of u.listeners)if(h)for(const L in d){const G=()=>d[L],W=[t,L].join(this.options.delimiter),k={type:s,listener:S,listenersCollection:u,path:{listener:c,update:o||t,resolved:this.cleanNotRecursivePath(W)},params:m,options:n};this.shouldIgnore(S,t)||(S.options.bulk?(y.push({value:G,path:W,params:m}),_[j]=S):i[c].single.push({listener:S,listenersCollection:u,eventInfo:k,value:G}))}else{const L={type:s,listener:S,listenersCollection:u,path:{listener:c,update:o||t,resolved:void 0},params:m,options:n};if(this.shouldIgnore(S,t))continue;S.options.bulk?(y.push({value:void 0,path:void 0,params:m}),_[j]=S):i[c].single.push({listener:S,listenersCollection:u,eventInfo:L,value:void 0})}for(const j in _){const S=_[j],L={type:s,listener:S,listenersCollection:u,path:{listener:c,update:t,resolved:void 0},options:n,params:m};i[c].bulk.push({listener:S,listenersCollection:u,eventInfo:L,value:y})}}else if(this.options.extraDebug)for(const l of u.listeners.values())l.options.debug&&console.log("[getNestedListeners] Listener was not fired because there was no match.",{listener:l,listenersCollection:u,currentCutPath:f,updatePath:t})}return i}notifyNestedListeners(t,r,n,s="update",o,i=null){return this.getQueueNotifyListeners(this.getNestedListeners(t,r,n,s,i),o)}getNotifyOnlyListeners(t,r,n,s="update",o=null){const i={};if(typeof n.only!="object"||!Array.isArray(n.only)||typeof n.only[0]>"u"||!this.canBeNested(r))return i;for(const a of n.only){const c=new it(r,this.options.delimiter,this.options.wildcard).get(a);i[a]={bulk:[],single:[]};for(const u in c){const f=t+this.options.delimiter+u;for(const[l,h]of this.listeners){const d=h.paramsInfo?this.getParams(h.paramsInfo,f):void 0;if(this.match(l,f)){const m=()=>c[u],y=[{value:m,path:f,params:d}];for(const _ of h.listeners.values()){const j={type:s,listener:_,listenersCollection:h,path:{listener:l,update:o||t,resolved:this.cleanNotRecursivePath(f)},params:d,options:n};this.shouldIgnore(_,t)||(_.options.bulk?i[a].bulk.some(S=>S.listener===_)||i[a].bulk.push({listener:_,listenersCollection:h,eventInfo:j,value:y}):i[a].single.push({listener:_,listenersCollection:h,eventInfo:j,value:m}))}}}}}return i}runQueue(t){const r=[];for(const n of t)n.options.group?r.includes(n.groupId)||(n.fn(),r.push(n.groupId)):n.fn()}sortAndRunQueue(t,r){t.sort(function(n,s){return n.id-s.id}),this.options.debug&&console.log("[deep-state-observer] queue for ".concat(r),t),this.runQueue(t)}notifyOnly(t,r,n,s="update",o=""){const i=this.getQueueNotifyListeners(this.getNotifyOnlyListeners(t,r,n,s,o));this.sortAndRunQueue(i,t)}canBeNested(t){return typeof t=="object"&&t!==null}getUpdateValues(t,r){let n=r;return typeof r=="function"&&(n=r(t)),{newValue:n,oldValue:t}}wildcardNotify(t,r){let n=[];for(const s of t)this.getQueueNotifyListeners(s,n);for(const s of r)this.executeWaitingListeners(s);return this.jobsRunning--,n}wildcardUpdate(t,r,n=je,s=!1){++this.jobsRunning,n=Object.assign(Object.assign({},je),n);const o=this.scan.get(t),i={};for(const f in o){const l=this.split(f),{oldValue:h,newValue:d}=this.getUpdateValues(o[f],r);(!this.same(d,h)||n.force)&&(this.pathSet(l,d,this.data),i[f]=d)}const a=[],c=[];for(const f in i){const l=i[f];n.only.length?a.push(this.getNotifyOnlyListeners(f,l,n,"update",t)):(a.push(this.getSubscribedListeners(f,l,n,"update",t)),this.canBeNested(l)&&a.push(this.getNestedListeners(f,l,n,"update",t))),n.debug&&this.options.log("Wildcard update",{path:f,newValue:l}),c.push(f)}if(s){const f=this;return function(){const l=f.wildcardNotify(a,c);f.sortAndRunQueue(l,t)}}const u=this.wildcardNotify(a,c);this.sortAndRunQueue(u,t)}runUpdateQueue(){if(!this.destroyed)for(;this.updateQueue.length&&this.updateQueue.length<this.options.maxSimultaneousJobs;){const t=this.updateQueue.shift();t.options.queue=!1,this.update(t.updatePath,t.fnOrValue,t.options,t.multi)}}updateNotify(t,r,n){const s=this.notifySubscribedListeners(t,r,n);this.canBeNested(r)&&this.notifyNestedListeners(t,r,n,"update",s),this.sortAndRunQueue(s,t),this.executeWaitingListeners(t)}updateNotifyAll(t){let r=[];for(const n of t){const s=n.newValue;if(this.tracing.length){const o=this.tracing[this.tracing.length-1],i=this.traceMap.get(o);i.changed.push({traceId:o,updatePath:n.updatePath,fnOrValue:s,options:n.options}),this.traceMap.set(o,i)}r=r.concat(this.notifySubscribedListeners(n.updatePath,s,n.options)),this.canBeNested(n.newValue)&&this.notifyNestedListeners(n.updatePath,s,n.options,"update",r)}this.runQueue(r)}updateNotifyOnly(t,r,n){this.notifyOnly(t,r,n),this.executeWaitingListeners(t)}update(t,r,n=Object.assign({},je),s=!1){if(this.destroyed)return;if(this.collection)return this.collection.update(t,r,n);if(this.tracing.length){const f=this.tracing[this.tracing.length-1],l=this.traceMap.get(f);l.changed.push({traceId:f,updatePath:t,fnOrValue:r,options:n}),this.traceMap.set(f,l)}const o=this.jobsRunning;if((this.options.queue||n.queue)&&o){if(o>this.options.maxSimultaneousJobs)throw new Error("Maximal simultaneous jobs limit reached.");this.updateQueue.push({updatePath:t,fnOrValue:r,options:n,multi:s});const f=Promise.resolve().then(()=>{this.runUpdateQueue()});return s?function(){return f}:f}if(this.isWildcard(t))return this.wildcardUpdate(t,r,n,s);++this.jobsRunning;const i=this.split(t),a=this.pathGet(i,this.data);let{oldValue:c,newValue:u}=this.getUpdateValues(a,r);if(n.debug&&this.options.log("Updating ".concat(t," ").concat(n.source?"from ".concat(n.source):""),{oldValue:c,newValue:u}),this.same(u,c)&&!n.force)return--this.jobsRunning,s?function(){return u}:u;if(this.pathSet(i,u,this.data),n=Object.assign(Object.assign({},je),n),n.only===null)return--this.jobsRunning,s?function(){}:u;if(n.only.length){if(--this.jobsRunning,s){const f=this;return function(){return f.updateNotifyOnly(t,u,n)}}return this.updateNotifyOnly(t,u,n),u}if(s){--this.jobsRunning;const f=this;return function(){return f.updateNotify(t,u,n)}}return this.updateNotify(t,u,n),--this.jobsRunning,u}multi(t=!1){if(this.destroyed)return{update(){return this},done(){},getStack(){return[]}};if(this.collection)return this.collection;const r=this,n=[],s=[];return{update(i,a,c=je){if(t){const u=r.split(i);let f=a;const l=r.pathGet(u,r.data);typeof f=="function"&&(f=f(l)),r.pathSet(u,f,r.data),n.push({updatePath:i,newValue:f,options:c})}else s.push(r.update(i,a,c,!0));return this},done(){if(r.collections===0){if(t)r.updateNotifyAll(n);else for(const i of s)i();n.length=0}},getStack(){return n}}}collect(){return this.collections++,this.collection||(this.collection=this.multi(!0)),this.collection}executeCollected(){if(this.collections--,this.collections===0&&this.collection){const t=this.collection;this.collection=null,t.done()}}getCollectedCount(){return this.collections}getCollectedStack(){return this.collection?this.collection.getStack():[]}get(t=void 0){if(!this.destroyed)return t===void 0||t===""?this.data:this.isWildcard(t)?this.scan.get(t):this.pathGet(this.split(t),this.data)}last(t){let r=this.lastExecs.get(t);r||(r={calls:0},this.lastExecs.set(t,r));const n=++r.calls;this.resolved.then(()=>{n===r.calls&&(this.lastExecs.set(t,{calls:0}),t())})}isMuted(t){if(!this.options.useMute)return!1;if(typeof t=="function")return this.isMutedListener(t);for(const r of this.muted){const n=!this.isNotRecursive(r),s=this.trimPath(r);if(this.match(t,s)||this.match(s,t))return!0;if(n){const o=this.cutPath(s,t);if(this.match(o,r)||this.match(r,o))return!0}}return!1}isMutedListener(t){return this.mutedListeners.has(t)}mute(t){if(typeof t=="function")return this.mutedListeners.add(t);this.muted.add(t)}unmute(t){if(typeof t=="function")return this.mutedListeners.delete(t);this.muted.delete(t)}debugSubscribe(t,r,n){t.options.debug&&this.options.log("listener subscribed",{listenerPath:n,listener:t,listenersCollection:r})}debugListener(t,r){(r.eventInfo.options.debug||r.listener.options.debug)&&this.options.log("Listener fired",{time:Date.now()-t,info:r})}debugTime(t){return t.listener.options.debug||t.eventInfo.options.debug?Date.now():0}startTrace(t,r=null){this.traceId++;const n=this.traceId+":"+t;return this.traceMap.set(n,{id:n,sort:this.traceId,stack:this.tracing.map(s=>s),additionalData:r,changed:[]}),this.tracing.push(n),n}stopTrace(t){const r=this.traceMap.get(t);return this.tracing.pop(),this.traceMap.delete(t),r}saveTrace(t){const r=this.traceMap.get(t);return this.tracing.pop(),this.traceMap.delete(t),this.savedTrace.push(r),r}getSavedTraces(){const t=this.savedTrace.map(r=>r);return t.sort((r,n)=>r.sort-n.sort),this.savedTrace=[],t}}var vs=typeof global=="object"&&global&&global.Object===Object&&global,Cu=typeof self=="object"&&self&&self.Object===Object&&self,X=vs||Cu||Function("return this")(),V=X.Symbol,$s=Object.prototype,Du=$s.hasOwnProperty,Mu=$s.toString,Be=V?V.toStringTag:void 0;function xu(e){var t=Du.call(e,Be),r=e[Be];try{e[Be]=void 0;var n=!0}catch(o){}var s=Mu.call(e);return n&&(t?e[Be]=r:delete e[Be]),s}var Lu=Object.prototype,Pu=Lu.toString;function Ru(e){return Pu.call(e)}var Nu="[object Null]",Fu="[object Undefined]",Vr=V?V.toStringTag:void 0;function fe(e){return e==null?e===void 0?Fu:Nu:Vr&&Vr in Object(e)?xu(e):Ru(e)}function ne(e){return e!=null&&typeof e=="object"}var Uu="[object Symbol]";function Wu(e){return typeof e=="symbol"||ne(e)&&fe(e)==Uu}function _s(e,t){for(var r=-1,n=e==null?0:e.length,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s}var rt=Array.isArray,Hu=1/0,Jr=V?V.prototype:void 0,Xr=Jr?Jr.toString:void 0;function ws(e){if(typeof e=="string")return e;if(rt(e))return _s(e,ws)+"";if(Wu(e))return Xr?Xr.call(e):"";var t=e+"";return t=="0"&&1/e==-Hu?"-0":t}function Ne(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function Ts(e){return e}var ku="[object AsyncFunction]",Bu="[object Function]",zu="[object GeneratorFunction]",Gu="[object Proxy]";function Os(e){if(!Ne(e))return!1;var t=fe(e);return t==Bu||t==zu||t==ku||t==Gu}var Nt=X["__core-js_shared__"],Zr=function(){var e=/[^.]+$/.exec(Nt&&Nt.keys&&Nt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function qu(e){return!!Zr&&Zr in e}var Qu=Function.prototype,Yu=Qu.toString;function _e(e){if(e!=null){try{return Yu.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var Ku=/[\\^$.*+?()[\]{}|]/g,Vu=/^\[object .+?Constructor\]$/,Ju=Function.prototype,Xu=Object.prototype,Zu=Ju.toString,ef=Xu.hasOwnProperty,tf=RegExp("^"+Zu.call(ef).replace(Ku,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function rf(e){if(!Ne(e)||qu(e))return!1;var t=Os(e)?tf:Vu;return t.test(_e(e))}function nf(e,t){return e==null?void 0:e[t]}function we(e,t){var r=nf(e,t);return rf(r)?r:void 0}var zt=we(X,"WeakMap"),en=Object.create,sf=function(){function e(){}return function(t){if(!Ne(t))return{};if(en)return en(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function Ss(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function of(){}var af=800,cf=16,uf=Date.now;function ff(e){var t=0,r=0;return function(){var n=uf(),s=cf-(n-r);if(r=n,s>0){if(++t>=af)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function lf(e){return function(){return e}}var bt=function(){try{var e=we(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),hf=bt?function(e,t){return bt(e,"toString",{configurable:!0,enumerable:!1,value:lf(t),writable:!0})}:Ts,df=ff(hf);function pf(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}function gf(e,t,r,n){for(var s=e.length,o=r+-1;++o<s;)if(t(e[o],o,e))return o;return-1}function mf(e){return e!==e}function yf(e,t,r){for(var n=r-1,s=e.length;++n<s;)if(e[n]===t)return n;return-1}function bf(e,t,r){return t===t?yf(e,t,r):gf(e,mf,r)}function vf(e,t){var r=e==null?0:e.length;return!!r&&bf(e,t,0)>-1}var $f=9007199254740991,_f=/^(?:0|[1-9]\d*)$/;function js(e,t){var r=typeof e;return t=t==null?$f:t,!!t&&(r=="number"||r!="symbol"&&_f.test(e))&&e>-1&&e%1==0&&e<t}function Es(e,t,r){t=="__proto__"&&bt?bt(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function At(e,t){return e===t||e!==e&&t!==t}var wf=Object.prototype,Tf=wf.hasOwnProperty;function As(e,t,r){var n=e[t];(!(Tf.call(e,t)&&At(n,r))||r===void 0&&!(t in e))&&Es(e,t,r)}function Of(e,t,r,n){var s=!r;r||(r={});for(var o=-1,i=t.length;++o<i;){var a=t[o],c=n?n(r[a],e[a],a,r,e):void 0;c===void 0&&(c=e[a]),s?Es(r,a,c):As(r,a,c)}return r}var tn=Math.max;function Sf(e,t,r){return t=tn(t===void 0?e.length-1:t,0),function(){for(var n=arguments,s=-1,o=tn(n.length-t,0),i=Array(o);++s<o;)i[s]=n[t+s];s=-1;for(var a=Array(t+1);++s<t;)a[s]=n[s];return a[t]=r(i),Ss(e,this,a)}}function fr(e,t){return df(Sf(e,t,Ts),e+"")}var jf=9007199254740991;function Is(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=jf}function It(e){return e!=null&&Is(e.length)&&!Os(e)}function Ef(e,t,r){if(!Ne(r))return!1;var n=typeof t;return(n=="number"?It(r)&&js(t,r.length):n=="string"&&t in r)?At(r[t],e):!1}function Af(e){return fr(function(t,r){var n=-1,s=r.length,o=s>1?r[s-1]:void 0,i=s>2?r[2]:void 0;for(o=e.length>3&&typeof o=="function"?(s--,o):void 0,i&&Ef(r[0],r[1],i)&&(o=s<3?void 0:o,s=1),t=Object(t);++n<s;){var a=r[n];a&&e(t,a,n,o)}return t})}var If=Object.prototype;function lr(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||If;return e===r}function Cf(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var Df="[object Arguments]";function rn(e){return ne(e)&&fe(e)==Df}var Cs=Object.prototype,Mf=Cs.hasOwnProperty,xf=Cs.propertyIsEnumerable,Ds=rn(function(){return arguments}())?rn:function(e){return ne(e)&&Mf.call(e,"callee")&&!xf.call(e,"callee")};function Lf(){return!1}var Ms=typeof exports=="object"&&exports&&!exports.nodeType&&exports,nn=Ms&&typeof module=="object"&&module&&!module.nodeType&&module,Pf=nn&&nn.exports===Ms,sn=Pf?X.Buffer:void 0,Rf=sn?sn.isBuffer:void 0,xs=Rf||Lf,Nf="[object Arguments]",Ff="[object Array]",Uf="[object Boolean]",Wf="[object Date]",Hf="[object Error]",kf="[object Function]",Bf="[object Map]",zf="[object Number]",Gf="[object Object]",qf="[object RegExp]",Qf="[object Set]",Yf="[object String]",Kf="[object WeakMap]",Vf="[object ArrayBuffer]",Jf="[object DataView]",Xf="[object Float32Array]",Zf="[object Float64Array]",el="[object Int8Array]",tl="[object Int16Array]",rl="[object Int32Array]",nl="[object Uint8Array]",sl="[object Uint8ClampedArray]",il="[object Uint16Array]",ol="[object Uint32Array]",x={};x[Xf]=x[Zf]=x[el]=x[tl]=x[rl]=x[nl]=x[sl]=x[il]=x[ol]=!0;x[Nf]=x[Ff]=x[Vf]=x[Uf]=x[Jf]=x[Wf]=x[Hf]=x[kf]=x[Bf]=x[zf]=x[Gf]=x[qf]=x[Qf]=x[Yf]=x[Kf]=!1;function al(e){return ne(e)&&Is(e.length)&&!!x[fe(e)]}function hr(e){return function(t){return e(t)}}var Ls=typeof exports=="object"&&exports&&!exports.nodeType&&exports,qe=Ls&&typeof module=="object"&&module&&!module.nodeType&&module,cl=qe&&qe.exports===Ls,Ft=cl&&vs.process,Me=function(){try{var e=qe&&qe.require&&qe.require("util").types;return e||Ft&&Ft.binding&&Ft.binding("util")}catch(t){}}(),on=Me&&Me.isTypedArray,ul=on?hr(on):al,fl=Object.prototype,ll=fl.hasOwnProperty;function Ps(e,t){var r=rt(e),n=!r&&Ds(e),s=!r&&!n&&xs(e),o=!r&&!n&&!s&&ul(e),i=r||n||s||o,a=i?Cf(e.length,String):[],c=a.length;for(var u in e)(t||ll.call(e,u))&&!(i&&(u=="length"||s&&(u=="offset"||u=="parent")||o&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||js(u,c)))&&a.push(u);return a}function Rs(e,t){return function(r){return e(t(r))}}var hl=Rs(Object.keys,Object),dl=Object.prototype,pl=dl.hasOwnProperty;function gl(e){if(!lr(e))return hl(e);var t=[];for(var r in Object(e))pl.call(e,r)&&r!="constructor"&&t.push(r);return t}function Ns(e){return It(e)?Ps(e):gl(e)}function ml(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var yl=Object.prototype,bl=yl.hasOwnProperty;function vl(e){if(!Ne(e))return ml(e);var t=lr(e),r=[];for(var n in e)n=="constructor"&&(t||!bl.call(e,n))||r.push(n);return r}function $l(e){return It(e)?Ps(e,!0):vl(e)}var an=Af(function(e,t,r,n){Of(t,$l(t),e,n)}),Ke=we(Object,"create");function _l(){this.__data__=Ke?Ke(null):{},this.size=0}function wl(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Tl="__lodash_hash_undefined__",Ol=Object.prototype,Sl=Ol.hasOwnProperty;function jl(e){var t=this.__data__;if(Ke){var r=t[e];return r===Tl?void 0:r}return Sl.call(t,e)?t[e]:void 0}var El=Object.prototype,Al=El.hasOwnProperty;function Il(e){var t=this.__data__;return Ke?t[e]!==void 0:Al.call(t,e)}var Cl="__lodash_hash_undefined__";function Dl(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Ke&&t===void 0?Cl:t,this}function be(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}be.prototype.clear=_l;be.prototype.delete=wl;be.prototype.get=jl;be.prototype.has=Il;be.prototype.set=Dl;function Ml(){this.__data__=[],this.size=0}function Ct(e,t){for(var r=e.length;r--;)if(At(e[r][0],t))return r;return-1}var xl=Array.prototype,Ll=xl.splice;function Pl(e){var t=this.__data__,r=Ct(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Ll.call(t,r,1),--this.size,!0}function Rl(e){var t=this.__data__,r=Ct(t,e);return r<0?void 0:t[r][1]}function Nl(e){return Ct(this.__data__,e)>-1}function Fl(e,t){var r=this.__data__,n=Ct(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function se(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}se.prototype.clear=Ml;se.prototype.delete=Pl;se.prototype.get=Rl;se.prototype.has=Nl;se.prototype.set=Fl;var Ve=we(X,"Map");function Ul(){this.size=0,this.__data__={hash:new be,map:new(Ve||se),string:new be}}function Wl(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Dt(e,t){var r=e.__data__;return Wl(t)?r[typeof t=="string"?"string":"hash"]:r.map}function Hl(e){var t=Dt(this,e).delete(e);return this.size-=t?1:0,t}function kl(e){return Dt(this,e).get(e)}function Bl(e){return Dt(this,e).has(e)}function zl(e,t){var r=Dt(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function Te(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Te.prototype.clear=Ul;Te.prototype.delete=Hl;Te.prototype.get=kl;Te.prototype.has=Bl;Te.prototype.set=zl;function Fs(e){return e==null?"":ws(e)}function Us(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}var cn=V?V.isConcatSpreadable:void 0;function Gl(e){return rt(e)||Ds(e)||!!(cn&&e&&e[cn])}function ql(e,t,r,n,s){var o=-1,i=e.length;for(r||(r=Gl),s||(s=[]);++o<i;){var a=e[o];r(a)&&Us(s,a)}return s}var Ws=Rs(Object.getPrototypeOf,Object),Ql="[object Object]",Yl=Function.prototype,Kl=Object.prototype,Hs=Yl.toString,Vl=Kl.hasOwnProperty,Jl=Hs.call(Object);function Xl(e){if(!ne(e)||fe(e)!=Ql)return!1;var t=Ws(e);if(t===null)return!0;var r=Vl.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Hs.call(r)==Jl}var Zl="[object DOMException]",eh="[object Error]";function ks(e){if(!ne(e))return!1;var t=fe(e);return t==eh||t==Zl||typeof e.message=="string"&&typeof e.name=="string"&&!Xl(e)}var th=fr(function(e,t){try{return Ss(e,void 0,t)}catch(r){return ks(r)?r:new Error(r)}});function rh(e){return function(t){return e==null?void 0:e[t]}}function nh(){this.__data__=new se,this.size=0}function sh(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function ih(e){return this.__data__.get(e)}function oh(e){return this.__data__.has(e)}var ah=200;function ch(e,t){var r=this.__data__;if(r instanceof se){var n=r.__data__;if(!Ve||n.length<ah-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Te(n)}return r.set(e,t),this.size=r.size,this}function Fe(e){var t=this.__data__=new se(e);this.size=t.size}Fe.prototype.clear=nh;Fe.prototype.delete=sh;Fe.prototype.get=ih;Fe.prototype.has=oh;Fe.prototype.set=ch;var Bs=typeof exports=="object"&&exports&&!exports.nodeType&&exports,un=Bs&&typeof module=="object"&&module&&!module.nodeType&&module,uh=un&&un.exports===Bs,fn=uh?X.Buffer:void 0;fn&&fn.allocUnsafe;function fh(e,t){return e.slice()}function lh(e,t){for(var r=-1,n=e==null?0:e.length,s=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[s++]=i)}return o}function hh(){return[]}var dh=Object.prototype,ph=dh.propertyIsEnumerable,ln=Object.getOwnPropertySymbols,gh=ln?function(e){return e==null?[]:(e=Object(e),lh(ln(e),function(t){return ph.call(e,t)}))}:hh;function mh(e,t,r){var n=t(e);return rt(e)?n:Us(n,r(e))}function yh(e){return mh(e,Ns,gh)}var Gt=we(X,"DataView"),qt=we(X,"Promise"),Ie=we(X,"Set"),hn="[object Map]",bh="[object Object]",dn="[object Promise]",pn="[object Set]",gn="[object WeakMap]",mn="[object DataView]",vh=_e(Gt),$h=_e(Ve),_h=_e(qt),wh=_e(Ie),Th=_e(zt),Z=fe;(Gt&&Z(new Gt(new ArrayBuffer(1)))!=mn||Ve&&Z(new Ve)!=hn||qt&&Z(qt.resolve())!=dn||Ie&&Z(new Ie)!=pn||zt&&Z(new zt)!=gn)&&(Z=function(e){var t=fe(e),r=t==bh?e.constructor:void 0,n=r?_e(r):"";if(n)switch(n){case vh:return mn;case $h:return hn;case _h:return dn;case wh:return pn;case Th:return gn}return t});var Oh=Object.prototype,Sh=Oh.hasOwnProperty;function jh(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&Sh.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var yn=X.Uint8Array;function dr(e){var t=new e.constructor(e.byteLength);return new yn(t).set(new yn(e)),t}function Eh(e,t){var r=dr(e.buffer);return new e.constructor(r,e.byteOffset,e.byteLength)}var Ah=/\w*$/;function Ih(e){var t=new e.constructor(e.source,Ah.exec(e));return t.lastIndex=e.lastIndex,t}var bn=V?V.prototype:void 0,vn=bn?bn.valueOf:void 0;function Ch(e){return vn?Object(vn.call(e)):{}}function Dh(e,t){var r=dr(e.buffer);return new e.constructor(r,e.byteOffset,e.length)}var Mh="[object Boolean]",xh="[object Date]",Lh="[object Map]",Ph="[object Number]",Rh="[object RegExp]",Nh="[object Set]",Fh="[object String]",Uh="[object Symbol]",Wh="[object ArrayBuffer]",Hh="[object DataView]",kh="[object Float32Array]",Bh="[object Float64Array]",zh="[object Int8Array]",Gh="[object Int16Array]",qh="[object Int32Array]",Qh="[object Uint8Array]",Yh="[object Uint8ClampedArray]",Kh="[object Uint16Array]",Vh="[object Uint32Array]";function Jh(e,t,r){var n=e.constructor;switch(t){case Wh:return dr(e);case Mh:case xh:return new n(+e);case Hh:return Eh(e);case kh:case Bh:case zh:case Gh:case qh:case Qh:case Yh:case Kh:case Vh:return Dh(e);case Lh:return new n;case Ph:case Fh:return new n(e);case Rh:return Ih(e);case Nh:return new n;case Uh:return Ch(e)}}function Xh(e){return typeof e.constructor=="function"&&!lr(e)?sf(Ws(e)):{}}var Zh="[object Map]";function ed(e){return ne(e)&&Z(e)==Zh}var $n=Me&&Me.isMap,td=$n?hr($n):ed,rd="[object Set]";function nd(e){return ne(e)&&Z(e)==rd}var _n=Me&&Me.isSet,sd=_n?hr(_n):nd,zs="[object Arguments]",id="[object Array]",od="[object Boolean]",ad="[object Date]",cd="[object Error]",Gs="[object Function]",ud="[object GeneratorFunction]",fd="[object Map]",ld="[object Number]",qs="[object Object]",hd="[object RegExp]",dd="[object Set]",pd="[object String]",gd="[object Symbol]",md="[object WeakMap]",yd="[object ArrayBuffer]",bd="[object DataView]",vd="[object Float32Array]",$d="[object Float64Array]",_d="[object Int8Array]",wd="[object Int16Array]",Td="[object Int32Array]",Od="[object Uint8Array]",Sd="[object Uint8ClampedArray]",jd="[object Uint16Array]",Ed="[object Uint32Array]",D={};D[zs]=D[id]=D[yd]=D[bd]=D[od]=D[ad]=D[vd]=D[$d]=D[_d]=D[wd]=D[Td]=D[fd]=D[ld]=D[qs]=D[hd]=D[dd]=D[pd]=D[gd]=D[Od]=D[Sd]=D[jd]=D[Ed]=!0;D[cd]=D[Gs]=D[md]=!1;function pt(e,t,r,n,s,o){var i;if(i!==void 0)return i;if(!Ne(e))return e;var a=rt(e);if(a)i=jh(e);else{var c=Z(e),u=c==Gs||c==ud;if(xs(e))return fh(e);if(c==qs||c==zs||u&&!s)i=u?{}:Xh(e);else{if(!D[c])return s?e:{};i=Jh(e,c)}}o||(o=new Fe);var f=o.get(e);if(f)return f;o.set(e,i),sd(e)?e.forEach(function(d){i.add(pt(d,t,r,d,e,o))}):td(e)&&e.forEach(function(d,m){i.set(m,pt(d,t,r,m,e,o))});var l=yh,h=a?void 0:l(e);return pf(h||e,function(d,m){h&&(m=d,d=e[m]),As(i,m,pt(d,t,r,m,e,o))}),i}var Ad=1,Id=4;function Qs(e){return pt(e,Ad|Id)}var Cd="__lodash_hash_undefined__";function Dd(e){return this.__data__.set(e,Cd),this}function Md(e){return this.__data__.has(e)}function vt(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Te;++t<r;)this.add(e[t])}vt.prototype.add=vt.prototype.push=Dd;vt.prototype.has=Md;function xd(e,t){return e.has(t)}function Ys(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}function Ld(e){return ne(e)&&It(e)}var Pd={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Rd=rh(Pd),Ks=/[&<>"']/g,Nd=RegExp(Ks.source);function Fd(e){return e=Fs(e),e&&Nd.test(e)?e.replace(Ks,Rd):e}function Ud(e,t){return _s(t,function(r){return e[r]})}var Vs=Object.prototype,Wd=Vs.hasOwnProperty;function wn(e,t,r,n){return e===void 0||At(e,Vs[r])&&!Wd.call(n,r)?t:e}var Hd={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function kd(e){return"\\"+Hd[e]}var Js=/<%=([\s\S]+?)%>/g,Bd=/<%-([\s\S]+?)%>/g,zd=/<%([\s\S]+?)%>/g,Tn={escape:Bd,evaluate:zd,interpolate:Js,variable:"",imports:{_:{escape:Fd}}},Gd="Invalid `variable` option passed into `_.template`",qd=/\b__p \+= '';/g,Qd=/\b(__p \+=) '' \+/g,Yd=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Kd=/[()=,{}\[\]\/\s]/,Vd=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,at=/($^)/,Jd=/['\n\r\u2028\u2029\\]/g,Xd=Object.prototype,On=Xd.hasOwnProperty;function Sn(e,t,r){var n=Tn.imports._.templateSettings||Tn;e=Fs(e),t=an({},t,n,wn);var s=an({},t.imports,n.imports,wn),o=Ns(s),i=Ud(s,o),a,c,u=0,f=t.interpolate||at,l="__p += '",h=RegExp((t.escape||at).source+"|"+f.source+"|"+(f===Js?Vd:at).source+"|"+(t.evaluate||at).source+"|$","g"),d=On.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(h,function(_,j,S,L,G,W){return S||(S=L),l+=e.slice(u,W).replace(Jd,kd),j&&(a=!0,l+="' +\n__e("+j+") +\n'"),G&&(c=!0,l+="';\n"+G+";\n__p += '"),S&&(l+="' +\n((__t = ("+S+")) == null ? '' : __t) +\n'"),u=W+_.length,_}),l+="';\n";var m=On.call(t,"variable")&&t.variable;if(!m)l="with (obj) {\n"+l+"\n}\n";else if(Kd.test(m))throw new Error(Gd);l=(c?l.replace(qd,""):l).replace(Qd,"$1").replace(Yd,"$1;"),l="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(c?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+l+"return __p\n}";var y=th(function(){return Function(o,d+"return "+l).apply(void 0,i)});if(y.source=l,ks(y))throw y;return y}var Zd=1/0,ep=Ie&&1/Ys(new Ie([,-0]))[1]==Zd?function(e){return new Ie(e)}:of,tp=200;function rp(e,t,r){var n=-1,s=vf,o=e.length,i=!0,a=[],c=a;if(o>=tp){var u=ep(e);if(u)return Ys(u);i=!1,s=xd,c=new vt}else c=a;e:for(;++n<o;){var f=e[n],l=f;if(f=f!==0?f:0,i&&l===l){for(var h=c.length;h--;)if(c[h]===l)continue e;a.push(f)}else s(c,l,r)||(c!==a&&c.push(l),a.push(f))}return a}var np=fr(function(e){return rp(ql(e,1,Ld))});class Xs{}class Zs extends Xs{constructor(r){super();p(this,"data",{});p(this,"event",new Tt.EventEmitter);this.data=r}update(r,n){n?Bt(n,r,this.data):this.data=r;const s={updateData:r,path:n!=null?n:""};n&&this.event.emit(n,s),this.event.emit("",s)}on(r,n){this.event.on(r,n)}off(r,n){this.event.off(r,n)}getData(r){return r?ye(r,this.data):this.data}destroy(){}}var $t,Je,Xe,Y,pe,Ze;class ei extends Wn{constructor(r){var o,i,a,c,u;super();p(this,"isInit",!1);p(this,"app");p(this,"mockData");z(this,$t,"base");z(this,Je);z(this,Xe);z(this,Y);z(this,pe,[]);z(this,Ze,[]);q(this,Je,r.schema.id),q(this,Xe,r.schema),this.app=r.app,this.setFields(r.schema.fields),this.setMethods(r.schema.methods||[]);let n=r.initialData;const s=r.ObservedDataClass||Zs;if(this.app.platform==="editor")this.mockData=((i=(o=r.schema.mocks)==null?void 0:o.find(f=>f.useInEditor))==null?void 0:i.data)||this.getDefaultData(),n=this.mockData;else if(typeof r.useMock=="boolean"&&r.useMock)this.mockData=((c=(a=r.schema.mocks)==null?void 0:a.find(f=>f.enable))==null?void 0:c.data)||this.getDefaultData(),n=this.mockData;else if(!r.initialData)n=this.getDefaultData();else{q(this,Y,new s((u=r.initialData)!=null?u:{})),this.isInit=!0;return}q(this,Y,new s(n!=null?n:{}))}get id(){return F(this,Je)}get type(){return F(this,$t)}get schema(){return F(this,Xe)}get fields(){return F(this,pe)}get methods(){return F(this,Ze)}setFields(r){q(this,pe,r)}setMethods(r){q(this,Ze,r)}get data(){return F(this,Y).getData("")}setData(r,n){F(this,Y).update(r,n);const s={updateData:r,path:n};this.emit("change",s)}setValue(r,n){return this.setData(n,r)}onDataChange(r,n){F(this,Y).on(r,n)}offDataChange(r,n){F(this,Y).off(r,n)}getDefaultData(){return ys(F(this,pe))}async init(){this.isInit=!0}destroy(){q(this,pe,[]),this.removeAllListeners(),F(this,Y).destroy()}}$t=new WeakMap,Je=new WeakMap,Xe=new WeakMap,Y=new WeakMap,pe=new WeakMap,Ze=new WeakMap;const jn=e=>Object.entries(e).reduce((t,[r,n])=>{let s=n;return typeof n=="object"&&(s=JSON.stringify(n)),typeof n<"u"?"".concat(t).concat(t?"&":"").concat(globalThis.encodeURIComponent(r),"=").concat(globalThis.encodeURIComponent("".concat(s))):t},""),sp=async e=>{var f;const{url:t,method:r="GET",headers:n={},params:s={},data:o={},...i}=e,a=jn(s);let c=JSON.stringify(o);return(f=n["Content-Type"])!=null&&f.includes("application/x-www-form-urlencoded")&&(c=jn(o)),(await globalThis.fetch(a?"".concat(t,"?").concat(a):t,{method:r,headers:n,body:r==="GET"?void 0:c,...i})).json()};var Ce,et,tt,_t;class ip extends ei{constructor(r){const{options:n}=r.schema;super(r);p(this,"isLoading",!1);p(this,"error");p(this,"httpOptions");z(this,Ce);z(this,et,[]);z(this,tt,[]);z(this,_t,"http");this.httpOptions=n,typeof r.request=="function"?q(this,Ce,r.request):typeof globalThis.fetch=="function"&&q(this,Ce,sp),this.methods.forEach(s=>{typeof s.content=="function"&&(s.timing==="beforeRequest"&&F(this,et).push(s.content),s.timing==="afterRequest"&&F(this,tt).push(s.content))})}get type(){return F(this,_t)}async init(){this.schema.autoFetch&&await this.request(this.httpOptions),super.init()}async request(r={}){var s,o;this.isLoading=!0;let n={...this.httpOptions,...r};try{for(const a of F(this,et))await a({options:n,params:{},dataSource:this,app:this.app});typeof this.schema.beforeRequest=="function"&&(n=this.schema.beforeRequest(n,{app:this.app,dataSource:this}));let i=this.mockData?this.mockData:await((s=F(this,Ce))==null?void 0:s.call(this,n));for(const a of F(this,tt))await a({res:i,options:n,params:{},dataSource:this,app:this.app});if(typeof this.schema.afterResponse=="function"&&(i=this.schema.afterResponse(i,{app:this.app,dataSource:this,options:n})),(o=this.schema.responseOptions)!=null&&o.dataPath){const a=ye(this.schema.responseOptions.dataPath,i);this.setData(a)}else this.setData(i);this.error=void 0}catch(i){this.error={msg:i.message},this.emit("error",i)}this.isLoading=!1}get(r){return this.request({...r,method:"GET"})}post(r){return this.request({...r,method:"POST"})}}Ce=new WeakMap,et=new WeakMap,tt=new WeakMap,_t=new WeakMap;const op=(e,t)=>{let r=!0;for(const{op:n,value:s,range:o,field:i}of e){const[a,...c]=i,u=t[a];if(!u||!c.length)break;const f=ye(c.join("."),u);if(!ms(n,f,s,o)){r=!1;break}}return r},ti=(e,t)=>{if(!e.displayConds||!Array.isArray(e.displayConds)||!e.displayConds.length)return!0;for(const{cond:r}of e.displayConds)if(r&&op(r,t))return!0;return!1},ap=(e=[],t)=>{if(!e||!Array.isArray(e)||!e.length)return!0;for(const{cond:r}of e){if(!r)continue;let n=!0;for(const{op:s,value:o,range:i,field:a}of r){const c=ye(a.join("."),t);if(!ms(s,c,o,i)){n=!1;break}}if(n)return n}return!1},En=(e,t)=>{var r;if(hs(e)||yu(e)){const n=(r=t.items)==null?void 0:r.findIndex(s=>s.id===e.id);t.items.splice(n,1,e)}else ds(e,t.items)},cp=(e,t,r=[],n={})=>{const s={...n,[t]:{}};return r.reduce((o,i,a)=>(o[i]=a===r.length-1?e:{},o[i]),s[t]),s},up=(e,t)=>{const[r,...n]=e,s=r.indexOf(mt);if(s>-1){const o=r.substring(s+mt.length),i=t[o];return i?ye(n.join("."),i):e}return e},ri=(e,t)=>typeof e=="string"?Sn(e)(t):e!=null&&e.isBindDataSource&&e.dataSourceId?t[e.dataSourceId]:e!=null&&e.isBindDataSourceField&&e.dataSourceId&&typeof e.template=="string"?Sn(e.template)(t[e.dataSourceId]):Array.isArray(e)&&typeof e[0]=="string"?up(e,t):e,fp=(e,t,r,n=[],s,o=!1)=>{const i=new _u;i.addTarget(new qr({id:r,type:"data-source",isTarget:(u,f)=>"".concat(u).startsWith(ps)?!1:vu(f,r)||$u(f,r)})),i.addTarget(new qr({id:r,type:"cond",isTarget:(u,f)=>!(!Array.isArray(f)||f[0]!==r||!"".concat(u).startsWith("displayConds"))})),i.collect(t,{},!0);const{deps:a}=i.getTarget(r,"data-source"),{deps:c}=i.getTarget(r,"cond");return!Object.keys(a).length&&!Object.keys(c).length?t:t.map(u=>Qt({itemData:e,data:s,dsId:r,keys:n,inEditor:o,condDeps:c,item:u,deps:a}))},Qt=({itemData:e,data:t,dsId:r,keys:n,inEditor:s,condDeps:o,item:i,deps:a})=>{var h,d;const{items:c,...u}=i,f=Qs(u);c&&!i.iteratorData&&(f.items=Array.isArray(c)?c.map(m=>Qt({itemData:e,data:t,dsId:r,keys:n,inEditor:s,condDeps:o,item:m,deps:a})):c),Array.isArray(c)&&c.length?i.iteratorData?f.items=c:f.items=c.map(m=>Qt({itemData:e,data:t,dsId:r,keys:n,inEditor:s,condDeps:o,item:m,deps:a})):f.items=c;const l=cp(e,r,n,t);return(h=o[f.id])!=null&&h.keys.length&&!s&&(f.condResult=ti(f,l)),(d=a[f.id])!=null&&d.keys.length?gs(m=>ri(m,l),f,{[r]:a},r):f},Q=class Q extends Wn{constructor({app:r,useMock:n,initialData:s}){var i,a;super();p(this,"app");p(this,"dataSourceMap",new Map);p(this,"data",{});p(this,"useMock",!1);this.app=r,this.useMock=n,s&&(this.data=s),(a=(i=r.dsl)==null?void 0:i.dataSources)==null||a.forEach(c=>{this.addDataSource(c)});const o=Array.from(this.dataSourceMap);typeof Promise.allSettled=="function"?Promise.allSettled(o.map(([,c])=>this.init(c))).then(c=>{const u={},f={};c.forEach((l,h)=>{const d=o[h][0];l.status==="fulfilled"?u[d]=this.data[d]:l.status==="rejected"&&(f[d]=l.reason)}),this.emit("init",u,f)}):Promise.all(o.map(([,c])=>this.init(c))).then(()=>{this.emit("init",this.data)}).catch(()=>{this.emit("init",this.data)})}static register(r,n){Q.dataSourceClassMap.set(r,n)}static registe(r,n){Q.register(r,n)}static getDataSourceClass(r){return Q.dataSourceClassMap.get(r)}static registerObservedData(r){Q.ObservedDataClass=r}async init(r){var o;if(r.isInit||this.app.jsEngine&&((o=r.schema.disabledInitInJsEngine)!=null&&o.includes(this.app.jsEngine)))return;const n=[],s=[];r.methods.forEach(i=>{typeof i.content=="function"&&(i.timing==="beforeInit"&&n.push(i.content),i.timing==="afterInit"&&s.push(i.content))});for(const i of n)await i({params:{},dataSource:r,app:this.app});await r.init();for(const i of s)await i({params:{},dataSource:r,app:this.app})}get(r){return this.dataSourceMap.get(r)}async addDataSource(r){if(!r)return;const n=Q.dataSourceClassMap.get(r.type)||ei,s=new n({app:this.app,schema:r,request:this.app.request,useMock:this.useMock,initialData:this.data[r.id],ObservedDataClass:Q.ObservedDataClass});this.dataSourceMap.set(r.id,s),this.data[s.id]=s.data,s.on("change",o=>{this.setData(s,o)})}setData(r,n){this.data[r.id]=r.data,this.emit("change",r.id,n)}removeDataSource(r){var n;(n=this.get(r))==null||n.destroy(),delete this.data[r],this.dataSourceMap.delete(r)}updateSchema(r){r.forEach(n=>{if(!this.get(n.id))return;this.removeDataSource(n.id),this.addDataSource(n);const o=this.get(n.id);o&&this.init(o)})}compiledNode({items:r,...n},s,o=!1){var a;const i=Qs(n);return r&&(i.items=Array.isArray(r)&&o?r.map(c=>this.compiledNode(c,s,o)):r),n.condResult===!1||n.visible===!1?i:gs(c=>ri(c,this.data),i,((a=this.app.dsl)==null?void 0:a.dataSourceDeps)||{},s)}compliedConds(r){return ti(r,this.data)}compliedIteratorItemConds(r,n=[]){return ap(n,r)}compliedIteratorItems(r,n,s=[]){const[o,...i]=s;return this.get(o)?fp(r,n,o,i,this.data,this.app.platform==="editor"):n}destroy(){this.removeAllListeners(),this.data={},this.dataSourceMap.forEach(r=>{r.destroy()}),this.dataSourceMap.clear()}onDataChange(r,n,s){var o;return(o=this.get(r))==null?void 0:o.onDataChange(n,s)}offDataChange(r,n,s){var o;return(o=this.get(r))==null?void 0:o.offDataChange(n,s)}};p(Q,"dataSourceClassMap",new Map),p(Q,"ObservedDataClass",Zs);let xe=Q;xe.register("http",ip);const lp=(e,t,r)=>{const{dsl:n,platform:s}=e;if(!(n!=null&&n.dataSources))return;const o=new xe({app:e,useMock:t,initialData:r});return n.dataSources&&n.dataSourceCondDeps&&s!=="editor"&&Pt(zr(n.dataSourceCondDeps),n.items).forEach(i=>{i.condResult=o.compliedConds(i),En(i,n)}),n.dataSources&&n.dataSourceDeps&&Pt(zr(n.dataSourceDeps),n.items).forEach(i=>{En(o.compiledNode(i),n)}),e.jsEngine!=="nodejs"&&o.on("change",(i,a)=>{var h,d,m;const c=((h=n.dataSourceDeps)==null?void 0:h[i])||{},u=((d=n.dataSourceCondDeps)==null?void 0:d[i])||{},f=np([...Object.keys(u),...Object.keys(c)]),l=(m=e.page)!=null&&m.data&&e.platform!=="editor"?[e.page.data]:n.items;o.emit("update-data",Pt(f,l).map(y=>{var j;e.platform!=="editor"&&(y.condResult=o.compliedConds(y));const _=o.compiledNode(y);if(typeof((j=e.page)==null?void 0:j.setData)=="function")if(hs(_))e.page.setData(_);else{const S=e.page.getNode(y.id);S==null||S.setData(_)}return _}),i,a)}),o},hp=e=>{let t=0;return(...r)=>{if(t===0){t+=1;return}return e(...r)}};class dp extends Xs{constructor(r){super();p(this,"state");p(this,"subscribers",new Map);p(this,"update",(r,n)=>{var s;(s=this.state)==null||s.update(n!=null?n:"",r)});p(this,"on",(r,n)=>{var i;const s=this.state.subscribe(r,hp(n)),o=(i=this.subscribers.get(r))!=null?i:new Map;o.set(n,s),this.subscribers.set(r,o)});p(this,"off",(r,n)=>{var o;const s=this.subscribers.get(r);s&&((o=s.get(n))==null||o(),s.delete(n))});p(this,"getData",r=>{var n;return this.state?(n=this.state)==null?void 0:n.get(r):{}});p(this,"destroy",()=>{this.subscribers.forEach(r=>{r.forEach(n=>n())})});this.state=new Iu(r)}}class An{constructor(t=globalThis.navigator.userAgent,r={}){p(this,"isIos",!1);p(this,"isIphone",!1);p(this,"isIpad",!1);p(this,"isAndroid",!1);p(this,"isAndroidPad",!1);p(this,"isMac",!1);p(this,"isWin",!1);p(this,"isMqq",!1);p(this,"isWechat",!1);p(this,"isWeb",!1);p(this,"isOpenHarmony",!1);this.isIphone=t.indexOf("iPhone")>=0,this.isIpad=/(iPad).*OS\s([\d_]+)/.test(t),this.isIos=this.isIphone||this.isIpad,this.isAndroid=t.indexOf("Android")>=0,this.isAndroidPad=this.isAndroid&&t.indexOf("Mobile")<0,this.isMac=t.indexOf("Macintosh")>=0,this.isWin=t.indexOf("Windows")>=0,this.isMqq=/QQ\/([\d.]+)/.test(t),this.isWechat=t.indexOf("MicroMessenger")>=0&&t.indexOf("wxwork")<0,this.isOpenHarmony=t.includes("OpenHarmony"),this.isWeb=!this.isIos&&!this.isAndroid&&!this.isOpenHarmony&&!/(WebOS|BlackBerry)/.test(t),Object.entries(r).forEach(([n,s])=>{this[n]=s})}}const In="magic:common:events:",ni="magic:common:actions:",ct={SHOW:"show",HIDE:"hide",SCROLL_TO_VIEW:"scrollIntoView",SCROLL_TO_TOP:"scrollToTop"},pp=e=>e.startsWith(In)?e:"".concat(In).concat(e),gp=e=>e.startsWith(ni),si=(e,t)=>{var n;if(!e)return!1;if(!e.id)return si(e.parentElement,t);const r=(n=t.page)==null?void 0:n.getNode(e.id);return r||!1},Cn=(e,t,r)=>{const n=si(r.target,e);n&&e.emit(pp(t),n)},mp=e=>{e.jsEngine==="browser"&&(window.document.body.addEventListener("click",t=>{Cn(e,"click",t)}),window.document.body.addEventListener("click",t=>{Cn(e,"click:capture",t)},!0))},yp=(e,t)=>{var n;const{instance:r}=t;if(r)switch(e.replace(ni,"")){case ct.SHOW:r.show();break;case ct.HIDE:r.hide();break;case ct.SCROLL_TO_VIEW:(n=r.$el)==null||n.scrollIntoView({behavior:"smooth"});break;case ct.SCROLL_TO_TOP:window.scrollTo({top:0,behavior:"smooth"});break}};class bp{constructor(t){p(this,"designWidth",375);p(this,"tid");p(this,"resizeHandler",()=>{clearTimeout(this.tid),this.tid=setTimeout(()=>{this.refreshRem()},300)});p(this,"pageshowHandler",t=>{t.persisted&&this.resizeHandler()});globalThis.document.readyState==="complete"?this.setBodyFontSize():globalThis.document.addEventListener("DOMContentLoaded",this.setBodyFontSize,!1),globalThis.addEventListener("resize",this.resizeHandler,!1),globalThis.addEventListener("pageshow",this.pageshowHandler,!1),typeof(t==null?void 0:t.designWidth)<"u"&&this.setDesignWidth(t.designWidth)}destroy(){globalThis.document.removeEventListener("DOMContentLoaded",this.setBodyFontSize,!1),globalThis.removeEventListener("resize",this.resizeHandler,!1),globalThis.removeEventListener("pageshow",this.pageshowHandler,!1)}setDesignWidth(t){this.designWidth=t,this.refreshRem()}setBodyFontSize(){globalThis.document.body.style.fontSize=".12rem"}refreshRem(){const{width:t}=document.documentElement.getBoundingClientRect(),r=t/(this.designWidth/100);globalThis.document.documentElement.style.fontSize="".concat(r,"px"),globalThis.document.documentElement.style.fontSize="".concat(this.correctRem(r),"px")}correctRem(t){const{document:r}=globalThis,n=r.createElement("div");n.style.cssText="width:1rem;height:0;overflow:hidden;position:absolute;z-index:-1;visibility:hidden;",r.documentElement.appendChild(n);const s=n.offsetWidth;return r.documentElement.removeChild(n),Math.abs(s-t)>1?t**2/s:t}}class vp{constructor(){p(this,"data",{})}set(t,r){this.data[t]=r}get(t){return this.data[t]}}class Yt extends Tt.EventEmitter{constructor(r){super();p(this,"data");p(this,"style");p(this,"events",[]);p(this,"instance");p(this,"page");p(this,"parent");p(this,"app");p(this,"store",new vp);this.page=r.page,this.parent=r.parent,this.app=r.app,this.setData(r.config),this.listenLifeSafe()}setData(r){this.data=r;const{events:n,style:s}=r;this.events=n||[],this.style=s||{},this.emit("update-data")}destroy(){this.removeAllListeners()}listenLifeSafe(){this.once("created",async r=>{this.once("destroy",()=>{this.instance=null,typeof this.data.destroy=="function"&&this.data.destroy(this),this.listenLifeSafe()}),this.instance=r,await this.runHookCode("created")}),this.once("mounted",async r=>{this.instance=r;const n=this.app.eventQueueMap[r.config.id]||[];for(let s=n.shift();s;s=n.shift())this.app.compActionHandler(s.eventConfig,s.fromCpt,s.args);await this.runHookCode("mounted")})}async runHookCode(r){var s,o,i;if(typeof this.data[r]=="function"){await this.data[r](this);return}const n=this.data[r];if((n==null?void 0:n.hookType)===ls.CODE)for(const a of n.hookData){const{codeType:c=ht.CODE,codeId:u,params:f={}}=a;let l;const h={app:this.app,params:f};if(c===ht.CODE&&typeof u=="string"&&((s=this.app.codeDsl)!=null&&s[u]))l=this.app.codeDsl[u].content;else if(c===ht.DATA_SOURCE_METHOD&&Array.isArray(u)&&u.length>1){const d=(o=this.app.dataSourceManager)==null?void 0:o.get(u[0]);l=(i=d==null?void 0:d.methods.find(m=>m.name===u[1]))==null?void 0:i.content,h.dataSource=d}l&&typeof l=="function"&&await l(h)}}}class $p extends Yt{constructor(r){super(r);p(this,"nodes",new Map);this.setNode(r.config.id,this),r.config.items.forEach(n=>{this.initNode(n,this)})}initNode(r,n){var o,i,a;const s=new Yt({config:r,parent:n,page:this,app:this.app});if(this.setNode(r.id,s),r.type==="page-fragment-container"&&r.pageFragmentId){const c=(i=(o=this.app.dsl)==null?void 0:o.items)==null?void 0:i.find(u=>u.id===r.pageFragmentId);c&&(r.items=[c])}(a=r.items)==null||a.forEach(c=>{this.initNode(c,s)})}getNode(r){return this.nodes.get(r)}setNode(r,n){this.nodes.set(r,n)}deleteNode(r){this.nodes.delete(r)}destroy(){super.destroy(),this.nodes.clear()}}const _p=e=>{if(typeof e!="string")return e;const t={};return e.split(";").forEach(r=>{if(!r)return;const n=r.split(":");let s=n.shift(),o=n.join(":");s&&(s=s.replace(/^\s*/,"").replace(/\s*$/,""),o=o.replace(/^\s*/,"").replace(/\s*$/,""),s=s.split("-").map((i,a)=>a>0?"".concat(i[0].toUpperCase()).concat(i.substr(1)):i).join(""),t[s]=o)}),t},wp=e=>e&&!/^url/.test(e)&&!/^linear-gradient/.test(e)?"url(".concat(e,")"):e,Tp=e=>/^(-?\d+)(\.\d+)?$/.test(e),Op=(e,t)=>{if(!e)return[];const r=Object.entries(e).map(([s,o])=>o.trim()?(s==="rotate"&&Tp(o)&&(o="".concat(o,"deg")),t!=="hippy"?"".concat(s,"(").concat(o,")"):{[s]:o}):"");if(t==="hippy")return r;const n=r.join(" ");return n.trim()?n:"none"},Sp=(e,t)=>{if(!e)return{};let r={};const n={};typeof e=="string"?r=_p(e):r={...e};const s=t==="hippy",o=["zIndex","opacity","fontWeight"];return Object.entries(r).forEach(([i,a])=>{i==="scale"&&!n.transform&&s?n.transform=[{scale:a}]:i==="backgroundImage"&&!s?a&&(n[i]=wp(a)):i==="transform"&&typeof a!="string"?n[i]=Op(a,t):!o.includes(i)&&a&&/^[-]?[0-9]*[.]?[0-9]*$/.test(a)?n[i]=s?a:"".concat(a/100,"rem"):n[i]=a}),n};class jp extends Tt.EventEmitter{constructor(r){var n;super();p(this,"env",new An);p(this,"dsl");p(this,"codeDsl");p(this,"dataSourceManager");p(this,"page");p(this,"useMock",!1);p(this,"platform","mobile");p(this,"jsEngine","browser");p(this,"request");p(this,"components",new Map);p(this,"eventQueueMap",{});p(this,"transformStyle");p(this,"flexible");p(this,"eventList",new Map);p(this,"dataSourceEventList",new Map);this.setEnv(r.ua),this.codeDsl=(n=r.config)==null?void 0:n.codeBlocks,r.platform&&(this.platform=r.platform),r.jsEngine&&(this.jsEngine=r.jsEngine),typeof r.useMock=="boolean"&&(this.useMock=r.useMock),this.jsEngine==="browser"&&(this.flexible=new bp({designWidth:r.designWidth})),this.transformStyle=r.transformStyle||(s=>Sp(s,this.jsEngine)),r.request&&(this.request=r.request),r.config&&this.setConfig(r.config,r.curPage),mp(this)}setEnv(r){this.env=new An(r)}setDesignWidth(r){var n;(n=this.flexible)==null||n.setDesignWidth(r)}setConfig(r,n){var s,o;this.dsl=r,!n&&r.items.length&&(n=r.items[0].id),this.dataSourceManager&&this.dataSourceManager.destroy(),this.dataSourceManager=lp(this,this.useMock),this.codeDsl=r.codeBlocks,this.setPage(n||((o=(s=this.page)==null?void 0:s.data)==null?void 0:o.id))}addPage(){console.info("addPage 已经弃用")}setPage(r){var s,o;const n=(s=this.dsl)==null?void 0:s.items.find(i=>"".concat(i.id)==="".concat(r));if(!n){this.page&&(this.page.destroy(),this.page=void 0),super.emit("page-change");return}n!==((o=this.page)==null?void 0:o.data)&&(this.page&&this.page.destroy(),this.page=new $p({config:n,app:this}),super.emit("page-change",this.page),this.bindEvents())}deletePage(){this.page=void 0}getPage(r){if(!r)return this.page;if(this.page&&"".concat(this.page.data.id)==="".concat(r))return this.page}registerComponent(r,n){this.components.set(r,n)}unregisterComponent(r){this.components.delete(r)}resolveComponent(r){return this.components.get(r)}bindEvents(){var r;if(Array.from(this.eventList.keys()).forEach(n=>{const s=this.eventList.get(n);s&&this.off(s,n)}),this.eventList.clear(),!!this.page){for(const[,n]of this.page.nodes)(r=n.events)==null||r.forEach((s,o)=>{let i="".concat(s.name,"_").concat(n.data.id),a=(u,...f)=>{this.eventHandler(o,u,f)};const c=s.name.split(".");c.length>1&&(i="".concat(c[1],"_").concat(c[0]),a=(u,...f)=>{this.eventHandler(o,n,f)}),this.eventList.set(a,i),this.on(i,a)});this.bindDataSourceEvents()}}emit(r,...n){var i;const[s,...o]=n;return s instanceof Yt&&((i=s==null?void 0:s.data)!=null&&i.id)?super.emit("".concat(String(r),"_").concat(s.data.id),s,...o):super.emit(r,...n)}async codeActionHandler(r,n){var a,c;const{codeId:s="",params:o={}}=r;if(!s||hu(this.codeDsl))return;const i=(c=(a=this.codeDsl)==null?void 0:a[s])==null?void 0:c.content;typeof i=="function"&&await i({app:this,params:o,eventParams:n})}async compActionHandler(r,n,s){if(!this.page)throw new Error("当前没有页面");let{method:o,to:i}=r;te(o)&&([i,o]=o);const a=this.page.getNode(i);if(!a)throw"ID为".concat(i,"的组件不存在");if(gp(o))return yp(o,a);a.instance?typeof a.instance[o]=="function"&&await a.instance[o](n,...s):this.addEventToMap({eventConfig:r,fromCpt:n,args:s})}async dataSourceActionHandler(r,n){var l;const{dataSourceMethod:s=[],params:o={}}=r,[i,a]=s;if(!i||!a)return;const c=(l=this.dataSourceManager)==null?void 0:l.get(i);if(!c)return;const f=(c.methods||[]).find(h=>h.name===a);f&&typeof f.content=="function"&&await f.content({app:this,params:o,dataSource:c,eventParams:n})}destroy(){var r;this.removeAllListeners(),this.page=void 0,(r=this.flexible)==null||r.destroy(),this.flexible=void 0}bindDataSourceEvents(){var r;this.platform!=="editor"&&(Array.from(this.dataSourceEventList.keys()).forEach(n=>{const s=this.dataSourceEventList.get(n);Array.from(s.keys()).forEach(o=>{var c,u,f;const[i,...a]=o.split(".");i===Gr?(c=this.dataSourceManager)==null||c.offDataChange(n,a.join("."),s.get(o)):(f=(u=this.dataSourceManager)==null?void 0:u.get(n))==null||f.off(i,s.get(o))})}),(((r=this.dsl)==null?void 0:r.dataSources)||[]).forEach(n=>{var o;const s=(o=this.dataSourceEventList.get(n.id))!=null?o:new Map;(n.events||[]).forEach(i=>{var f,l,h,d;const[a,...c]=((f=i.name)==null?void 0:f.split("."))||[];if(!a)return;const u=(...m)=>{var y;this.eventHandler(i,(y=this.dataSourceManager)==null?void 0:y.get(n.id),m)};s.set(i.name,u),a===Gr?(l=this.dataSourceManager)==null||l.onDataChange(n.id,c.join("."),u):(d=(h=this.dataSourceManager)==null?void 0:h.get(n.id))==null||d.on(a,u)}),this.dataSourceEventList.set(n.id,s)}))}async actionHandler(r,n,s){r.actionType===lt.COMP?await this.compActionHandler(r,n,s):r.actionType===lt.CODE?await this.codeActionHandler(r,s):r.actionType===lt.DATA_SOURCE&&await this.dataSourceActionHandler(r,s)}async eventHandler(r,n,s){const o=typeof r=="number"?n.events[r]:r;if(au(o,"actions")){const{actions:i}=o;for(let a=0;a<i.length;a++)if(typeof r=="number"){const c=n.events[r].actions[a];this.actionHandler(c,n,s)}else this.actionHandler(i[a],n,s)}else await this.compActionHandler(o,n,s)}addEventToMap(r){this.eventQueueMap[r.eventConfig.to]?this.eventQueueMap[r.eventConfig.to].push(r):this.eventQueueMap[r.eventConfig.to]=[r]}}const Ep=(e,t=window)=>{var i;const r=VueDemi.ref(),n=VueDemi.ref(),s=VueDemi.ref(),o=VueDemi.computed(()=>{var a,c,u,f;return((c=(a=r.value)==null?void 0:a.items)==null?void 0:c.find(l=>l.id===n.value))||((f=(u=r.value)==null?void 0:u.items)==null?void 0:f[0])});return VueDemi.watch(o,async()=>{var c;await VueDemi.nextTick();const a=document.querySelector(".magic-ui-page");a&&((c=t.magic)==null||c.onPageElUpdate(a))}),(i=t.magic)==null||i.onRuntimeReady({getApp(){return e},updateRootConfig(a){r.value=a,e==null||e.setConfig(a,n.value)},updatePageId(a){n.value=a,e==null||e.setPage(a)},select(a){var u;s.value=a,e!=null&&e.getPage(a)&&((u=this.updatePageId)==null||u.call(this,a));const c=document.getElementById("".concat(a));return c||VueDemi.nextTick().then(()=>document.getElementById("".concat(a)))},add({config:a,parentId:c}){var f,l,h,d,m;if(!r.value)throw new Error("error");if(!s.value)throw new Error("error");if(!c)throw new Error("error");const u=Ge(c,[r.value]).pop();if(!u)throw new Error("未找到父节点");if(a.type!=="page"){const y=(f=e==null?void 0:e.page)==null?void 0:f.getNode(u.id);y&&((l=e==null?void 0:e.page)==null||l.initNode(a,y))}if(u.id!==s.value){const y=(h=u.items)==null?void 0:h.findIndex(_=>_.id===s.value);(d=u.items)==null||d.splice(y+1,0,a)}else(m=u.items)==null||m.push(a)},update({config:a,parentId:c}){var l,h,d;if(!r.value||!e)throw new Error("error");const u=((l=e.dataSourceManager)==null?void 0:l.compiledNode(a,void 0,!0))||a;ds(VueDemi.reactive(u),[r.value],c);const f=(h=e.page)==null?void 0:h.getNode(a.id);f&&f.setData(u),((d=e.page)==null?void 0:d.data.id)===a.id&&e.page.setData(u)},remove({id:a,parentId:c}){var h,d;if(!r.value)throw new Error("error");const u=Ge(a,[r.value]).pop();if(!u)throw new Error("未找到目标元素");const f=Ge(c,[r.value]).pop();if(!f)throw new Error("未找到父元素");u.type==="page"?e==null||e.deletePage():(h=e==null?void 0:e.page)==null||h.deleteNode(u.id);const l=(d=f.items)==null?void 0:d.findIndex(m=>m.id===u.id);f.items.splice(l,1)}}),{pageConfig:o}},Ap=Vue.defineComponent({__name:"App",setup(e){const t=Vue.inject("app"),{pageConfig:r}=Ep(t);return(n,s)=>{const o=Vue.resolveComponent("magic-ui-page");return Vue.unref(r)?(Vue.openBlock(),Vue.createBlock(o,{key:Vue.unref(r).id,config:Vue.unref(r)},null,8,["config"])):Vue.createCommentVNode("",!0)}}});xe.registerObservedData(dp);Promise.all([Mt(()=>import("./comp-entry-tKk-gY7j.js"),__vite__mapDeps([0,1])),Mt(()=>import("./plugin-entry-B1O5LaIO.js"),[]),Mt(()=>import("./datasource-entry-yoD6TSFD.js"),[])]).then(([e,t,r])=>{const n=Vue.createApp(Ap),s=new jp({ua:window.navigator.userAgent,platform:"editor"});s.env.isWeb&&s.setDesignWidth(window.document.documentElement.getBoundingClientRect().width),Object.entries(e.default).forEach(([o,i])=>{n.component("magic-ui-".concat(o),i)}),Object.entries(r.default).forEach(([o,i])=>{xe.register(o,i)}),Object.values(t.default).forEach(o=>{n.use(o,{app:s})}),window.appInstance=s,n.config.globalProperties.app=s,n.provide("app",s),n.mount("#app")});export{Cp as __vite_legacy_guard};
//# sourceMappingURL=index-CM7pgAdr.js.map
