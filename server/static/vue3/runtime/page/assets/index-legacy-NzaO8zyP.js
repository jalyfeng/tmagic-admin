(function(){System.register([],(function(exports,module){"use strict";return{execute:function(){var __vite_style__=document.createElement("style");__vite_style__.textContent='html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}:focus{outline:0}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:"";content:none}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration,input[type=search]::-webkit-search-results-button,input[type=search]::-webkit-search-results-decoration{-webkit-appearance:none;-moz-appearance:none}input[type=search]{-webkit-appearance:none;-moz-appearance:none;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box}textarea{overflow:auto;vertical-align:top;resize:vertical}audio,canvas,video{display:inline-block;*display: inline;*zoom: 1;max-width:100%}audio:not([controls]){display:none;height:0}[hidden]{display:none}html{font-size:100%;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}a:focus{outline:thin dotted}a:active,a:hover{outline:0}img{border:0;-ms-interpolation-mode:bicubic}figure{margin:0}form{margin:0}fieldset{border:1px solid #c0c0c0;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0;white-space:normal;*margin-left: -7px}button,input,select,textarea{font-size:100%;margin:0;vertical-align:baseline;*vertical-align: middle}button,input{line-height:normal}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer;*overflow: visible}button[disabled],html input[disabled]{cursor:default}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0;*height: 13px;*width: 13px}input[type=search]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}textarea{overflow:auto;vertical-align:top}table{border-collapse:collapse;border-spacing:0}html,button,input,select,textarea{color:#222}::-moz-selection{background:#b3d4fc;text-shadow:none}::selection{background:#b3d4fc;text-shadow:none}img{vertical-align:middle}fieldset{border:0;margin:0;padding:0}textarea{resize:vertical}.chromeframe{margin:.2em 0;background:#ccc;color:#000;padding:.2em 0}\n',document.head.appendChild(__vite_style__);var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var events={exports:{}},R="object"==typeof Reflect?Reflect:null,ReflectApply=R&&"function"==typeof R.apply?R.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},ReflectOwnKeys;function ProcessEmitWarning(e){console&&console.warn&&console.warn(e)}ReflectOwnKeys=R&&"function"==typeof R.ownKeys?R.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var NumberIsNaN=Number.isNaN||function(e){return e!=e};function EventEmitter(){EventEmitter.init.call(this)}events.exports=EventEmitter,events.exports.once=once,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function _getMaxListeners(e){return void 0===e._maxListeners?EventEmitter.defaultMaxListeners:e._maxListeners}function _addListener(e,t,r,n){var a,s,i;if(checkListener(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),i=s[t]),void 0===i)i=s[t]=r,++e._eventsCount;else if("function"==typeof i?i=s[t]=n?[r,i]:[i,r]:n?i.unshift(r):i.push(r),(a=_getMaxListeners(e))>0&&i.length>a&&!i.warned){i.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=i.length,ProcessEmitWarning(o)}return e}function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},a=onceWrapper.bind(n);return a.listener=r,n.wrapFn=a,a}function _listeners(e,t,r){var n=e._events;if(void 0===n)return[];var a=n[t];return void 0===a?[]:"function"==typeof a?r?[a.listener||a]:[a]:r?unwrapListeners(a):arrayClone(a,a.length)}function listenerCount(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function arrayClone(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function spliceOne(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function unwrapListeners(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function once(e,t){return new Promise((function(r,n){function a(r){e.removeListener(t,s),n(r)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",a),r([].slice.call(arguments))}eventTargetAgnosticAddListener(e,t,s,{once:!0}),"error"!==t&&addErrorHandlerIfEventEmitter(e,a,{once:!0})}))}function addErrorHandlerIfEventEmitter(e,t,r){"function"==typeof e.on&&eventTargetAgnosticAddListener(e,"error",t,r)}function eventTargetAgnosticAddListener(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function a(s){n.once&&e.removeEventListener(t,a),r(s)}))}}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(e){if("number"!=typeof e||e<0||NumberIsNaN(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");defaultMaxListeners=e}}),EventEmitter.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||NumberIsNaN(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},EventEmitter.prototype.getMaxListeners=function(){return _getMaxListeners(this)},EventEmitter.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,a=this._events;if(void 0!==a)n=n&&void 0===a.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var i=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw i.context=s,i}var o=a[e];if(void 0===o)return!1;if("function"==typeof o)ReflectApply(o,this,t);else{var c=o.length,u=arrayClone(o,c);for(r=0;r<c;++r)ReflectApply(u[r],this,t)}return!0},EventEmitter.prototype.addListener=function(e,t){return _addListener(this,e,t,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function(e,t){return _addListener(this,e,t,!0)},EventEmitter.prototype.once=function(e,t){return checkListener(t),this.on(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.prependOnceListener=function(e,t){return checkListener(t),this.prependListener(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.removeListener=function(e,t){var r,n,a,s,i;if(checkListener(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(a=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){i=r[s].listener,a=s;break}if(a<0)return this;0===a?r.shift():spliceOne(r,a),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,i||t)}return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var a,s=Object.keys(r);for(n=0;n<s.length;++n)"removeListener"!==(a=s[n])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},EventEmitter.prototype.listeners=function(e){return _listeners(this,e,!0)},EventEmitter.prototype.rawListeners=function(e){return _listeners(this,e,!1)},EventEmitter.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount.call(e,t)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};var eventsExports=events.exports;const EventEmitter$1=getDefaultExportFromCjs(eventsExports);var freeGlobal$1="object"==typeof global&&global&&global.Object===Object&&global,freeSelf$1="object"==typeof self&&self&&self.Object===Object&&self,root$1=freeGlobal$1||freeSelf$1||Function("return this")(),Symbol$2=root$1.Symbol,objectProto$u=Object.prototype,hasOwnProperty$o=objectProto$u.hasOwnProperty,nativeObjectToString$3=objectProto$u.toString,symToStringTag$3=Symbol$2?Symbol$2.toStringTag:void 0;function getRawTag$1(e){var t=hasOwnProperty$o.call(e,symToStringTag$3),r=e[symToStringTag$3];try{e[symToStringTag$3]=void 0;var n=!0}catch(s){}var a=nativeObjectToString$3.call(e);return n&&(t?e[symToStringTag$3]=r:delete e[symToStringTag$3]),a}var objectProto$t=Object.prototype,nativeObjectToString$2=objectProto$t.toString;function objectToString$1(e){return nativeObjectToString$2.call(e)}var nullTag$1="[object Null]",undefinedTag$1="[object Undefined]",symToStringTag$2=Symbol$2?Symbol$2.toStringTag:void 0;function baseGetTag$1(e){return null==e?void 0===e?undefinedTag$1:nullTag$1:symToStringTag$2&&symToStringTag$2 in Object(e)?getRawTag$1(e):objectToString$1(e)}function isObjectLike$1(e){return null!=e&&"object"==typeof e}var symbolTag$5="[object Symbol]";function isSymbol$1(e){return"symbol"==typeof e||isObjectLike$1(e)&&baseGetTag$1(e)==symbolTag$5}function arrayMap$1(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var isArray$2=Array.isArray,INFINITY$3=1/0,symbolProto$3=Symbol$2?Symbol$2.prototype:void 0,symbolToString$1=symbolProto$3?symbolProto$3.toString:void 0;function baseToString$1(e){if("string"==typeof e)return e;if(isArray$2(e))return arrayMap$1(e,baseToString$1)+"";if(isSymbol$1(e))return symbolToString$1?symbolToString$1.call(e):"";var t=e+"";return"0"==t&&1/e==-INFINITY$3?"-0":t}function isObject$4(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var asyncTag$1="[object AsyncFunction]",funcTag$5="[object Function]",genTag$3="[object GeneratorFunction]",proxyTag$1="[object Proxy]";function isFunction$2(e){if(!isObject$4(e))return!1;var t=baseGetTag$1(e);return t==funcTag$5||t==genTag$3||t==asyncTag$1||t==proxyTag$1}var coreJsData$1=root$1["__core-js_shared__"],maskSrcKey$1=(uid=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||""),uid?"Symbol(src)_1."+uid:""),uid;function isMasked$1(e){return!!maskSrcKey$1&&maskSrcKey$1 in e}var funcProto$4=Function.prototype,funcToString$4=funcProto$4.toString;function toSource$1(e){if(null!=e){try{return funcToString$4.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var reRegExpChar$1=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor$1=/^\[object .+?Constructor\]$/,funcProto$3=Function.prototype,objectProto$s=Object.prototype,funcToString$3=funcProto$3.toString,hasOwnProperty$n=objectProto$s.hasOwnProperty,reIsNative$1=RegExp("^"+funcToString$3.call(hasOwnProperty$n).replace(reRegExpChar$1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative$1(e){return!(!isObject$4(e)||isMasked$1(e))&&(isFunction$2(e)?reIsNative$1:reIsHostCtor$1).test(toSource$1(e))}function getValue$1(e,t){return null==e?void 0:e[t]}function getNative$1(e,t){var r=getValue$1(e,t);return baseIsNative$1(r)?r:void 0}var WeakMap$2=getNative$1(root$1,"WeakMap"),objectCreate$1=Object.create,baseCreate$1=function(){function e(){}return function(t){if(!isObject$4(t))return{};if(objectCreate$1)return objectCreate$1(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function copyArray(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var defineProperty$1=function(){try{var e=getNative$1(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();function arrayEach$1(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}var MAX_SAFE_INTEGER$3=9007199254740991,reIsUint$1=/^(?:0|[1-9]\d*)$/;function isIndex$1(e,t){var r=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER$3:t)&&("number"==r||"symbol"!=r&&reIsUint$1.test(e))&&e>-1&&e%1==0&&e<t}function baseAssignValue$1(e,t,r){"__proto__"==t&&defineProperty$1?defineProperty$1(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function eq$1(e,t){return e===t||e!=e&&t!=t}var objectProto$r=Object.prototype,hasOwnProperty$m=objectProto$r.hasOwnProperty;function assignValue$1(e,t,r){var n=e[t];hasOwnProperty$m.call(e,t)&&eq$1(n,r)&&(void 0!==r||t in e)||baseAssignValue$1(e,t,r)}function copyObject$1(e,t,r,n){var a=!r;r||(r={});for(var s=-1,i=t.length;++s<i;){var o=t[s],c=void 0;void 0===c&&(c=e[o]),a?baseAssignValue$1(r,o,c):assignValue$1(r,o,c)}return r}var MAX_SAFE_INTEGER$2=9007199254740991;function isLength$1(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER$2}function isArrayLike$1(e){return null!=e&&isLength$1(e.length)&&!isFunction$2(e)}var objectProto$q=Object.prototype;function isPrototype$1(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$q)}function baseTimes$1(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var argsTag$5="[object Arguments]";function baseIsArguments$1(e){return isObjectLike$1(e)&&baseGetTag$1(e)==argsTag$5}var objectProto$p=Object.prototype,hasOwnProperty$l=objectProto$p.hasOwnProperty,propertyIsEnumerable$3=objectProto$p.propertyIsEnumerable,isArguments$1=baseIsArguments$1(function(){return arguments}())?baseIsArguments$1:function(e){return isObjectLike$1(e)&&hasOwnProperty$l.call(e,"callee")&&!propertyIsEnumerable$3.call(e,"callee")};function stubFalse$1(){return!1}var freeExports$5="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$5=freeExports$5&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$5=freeModule$5&&freeModule$5.exports===freeExports$5,Buffer$3=moduleExports$5?root$1.Buffer:void 0,nativeIsBuffer$1=Buffer$3?Buffer$3.isBuffer:void 0,isBuffer$2=nativeIsBuffer$1||stubFalse$1,argsTag$4="[object Arguments]",arrayTag$3="[object Array]",boolTag$5="[object Boolean]",dateTag$5="[object Date]",errorTag$4="[object Error]",funcTag$4="[object Function]",mapTag$a="[object Map]",numberTag$5="[object Number]",objectTag$6="[object Object]",regexpTag$5="[object RegExp]",setTag$a="[object Set]",stringTag$5="[object String]",weakMapTag$5="[object WeakMap]",arrayBufferTag$5="[object ArrayBuffer]",dataViewTag$7="[object DataView]",float32Tag$5="[object Float32Array]",float64Tag$5="[object Float64Array]",int8Tag$5="[object Int8Array]",int16Tag$5="[object Int16Array]",int32Tag$5="[object Int32Array]",uint8Tag$5="[object Uint8Array]",uint8ClampedTag$5="[object Uint8ClampedArray]",uint16Tag$5="[object Uint16Array]",uint32Tag$5="[object Uint32Array]",typedArrayTags$1={};function baseIsTypedArray$1(e){return isObjectLike$1(e)&&isLength$1(e.length)&&!!typedArrayTags$1[baseGetTag$1(e)]}function baseUnary$1(e){return function(t){return e(t)}}typedArrayTags$1[float32Tag$5]=typedArrayTags$1[float64Tag$5]=typedArrayTags$1[int8Tag$5]=typedArrayTags$1[int16Tag$5]=typedArrayTags$1[int32Tag$5]=typedArrayTags$1[uint8Tag$5]=typedArrayTags$1[uint8ClampedTag$5]=typedArrayTags$1[uint16Tag$5]=typedArrayTags$1[uint32Tag$5]=!0,typedArrayTags$1[argsTag$4]=typedArrayTags$1[arrayTag$3]=typedArrayTags$1[arrayBufferTag$5]=typedArrayTags$1[boolTag$5]=typedArrayTags$1[dataViewTag$7]=typedArrayTags$1[dateTag$5]=typedArrayTags$1[errorTag$4]=typedArrayTags$1[funcTag$4]=typedArrayTags$1[mapTag$a]=typedArrayTags$1[numberTag$5]=typedArrayTags$1[objectTag$6]=typedArrayTags$1[regexpTag$5]=typedArrayTags$1[setTag$a]=typedArrayTags$1[stringTag$5]=typedArrayTags$1[weakMapTag$5]=!1;var freeExports$4="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$4=freeExports$4&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$4=freeModule$4&&freeModule$4.exports===freeExports$4,freeProcess$1=moduleExports$4&&freeGlobal$1.process,nodeUtil$1=function(){try{var e=freeModule$4&&freeModule$4.require&&freeModule$4.require("util").types;return e||freeProcess$1&&freeProcess$1.binding&&freeProcess$1.binding("util")}catch(t){}}(),nodeIsTypedArray$1=nodeUtil$1&&nodeUtil$1.isTypedArray,isTypedArray$1=nodeIsTypedArray$1?baseUnary$1(nodeIsTypedArray$1):baseIsTypedArray$1,objectProto$o=Object.prototype,hasOwnProperty$k=objectProto$o.hasOwnProperty;function arrayLikeKeys$1(e,t){var r=isArray$2(e),n=!r&&isArguments$1(e),a=!r&&!n&&isBuffer$2(e),s=!r&&!n&&!a&&isTypedArray$1(e),i=r||n||a||s,o=i?baseTimes$1(e.length,String):[],c=o.length;for(var u in e)!t&&!hasOwnProperty$k.call(e,u)||i&&("length"==u||a&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||isIndex$1(u,c))||o.push(u);return o}function overArg$1(e,t){return function(r){return e(t(r))}}var nativeKeys$1=overArg$1(Object.keys,Object),objectProto$n=Object.prototype,hasOwnProperty$j=objectProto$n.hasOwnProperty;function baseKeys$1(e){if(!isPrototype$1(e))return nativeKeys$1(e);var t=[];for(var r in Object(e))hasOwnProperty$j.call(e,r)&&"constructor"!=r&&t.push(r);return t}function keys$1(e){return isArrayLike$1(e)?arrayLikeKeys$1(e):baseKeys$1(e)}function nativeKeysIn$1(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}var objectProto$m=Object.prototype,hasOwnProperty$i=objectProto$m.hasOwnProperty;function baseKeysIn$1(e){if(!isObject$4(e))return nativeKeysIn$1(e);var t=isPrototype$1(e),r=[];for(var n in e)("constructor"!=n||!t&&hasOwnProperty$i.call(e,n))&&r.push(n);return r}function keysIn$1(e){return isArrayLike$1(e)?arrayLikeKeys$1(e,!0):baseKeysIn$1(e)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,t){if(isArray$2(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!isSymbol$1(e))||(reIsPlainProp.test(e)||!reIsDeepProp.test(e)||null!=t&&e in Object(t))}var nativeCreate$1=getNative$1(Object,"create");function hashClear$1(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete$1(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var HASH_UNDEFINED$4="__lodash_hash_undefined__",objectProto$l=Object.prototype,hasOwnProperty$h=objectProto$l.hasOwnProperty;function hashGet$1(e){var t=this.__data__;if(nativeCreate$1){var r=t[e];return r===HASH_UNDEFINED$4?void 0:r}return hasOwnProperty$h.call(t,e)?t[e]:void 0}var objectProto$k=Object.prototype,hasOwnProperty$g=objectProto$k.hasOwnProperty;function hashHas$1(e){var t=this.__data__;return nativeCreate$1?void 0!==t[e]:hasOwnProperty$g.call(t,e)}var HASH_UNDEFINED$3="__lodash_hash_undefined__";function hashSet$1(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=nativeCreate$1&&void 0===t?HASH_UNDEFINED$3:t,this}function Hash$1(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function listCacheClear$1(){this.__data__=[],this.size=0}function assocIndexOf$1(e,t){for(var r=e.length;r--;)if(eq$1(e[r][0],t))return r;return-1}Hash$1.prototype.clear=hashClear$1,Hash$1.prototype.delete=hashDelete$1,Hash$1.prototype.get=hashGet$1,Hash$1.prototype.has=hashHas$1,Hash$1.prototype.set=hashSet$1;var arrayProto$1=Array.prototype,splice$1=arrayProto$1.splice;function listCacheDelete$1(e){var t=this.__data__,r=assocIndexOf$1(t,e);return!(r<0)&&(r==t.length-1?t.pop():splice$1.call(t,r,1),--this.size,!0)}function listCacheGet$1(e){var t=this.__data__,r=assocIndexOf$1(t,e);return r<0?void 0:t[r][1]}function listCacheHas$1(e){return assocIndexOf$1(this.__data__,e)>-1}function listCacheSet$1(e,t){var r=this.__data__,n=assocIndexOf$1(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function ListCache$1(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ListCache$1.prototype.clear=listCacheClear$1,ListCache$1.prototype.delete=listCacheDelete$1,ListCache$1.prototype.get=listCacheGet$1,ListCache$1.prototype.has=listCacheHas$1,ListCache$1.prototype.set=listCacheSet$1;var Map$2=getNative$1(root$1,"Map");function mapCacheClear$1(){this.size=0,this.__data__={hash:new Hash$1,map:new(Map$2||ListCache$1),string:new Hash$1}}function isKeyable$1(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function getMapData$1(e,t){var r=e.__data__;return isKeyable$1(t)?r["string"==typeof t?"string":"hash"]:r.map}function mapCacheDelete$1(e){var t=getMapData$1(this,e).delete(e);return this.size-=t?1:0,t}function mapCacheGet$1(e){return getMapData$1(this,e).get(e)}function mapCacheHas$1(e){return getMapData$1(this,e).has(e)}function mapCacheSet$1(e,t){var r=getMapData$1(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function MapCache$1(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}MapCache$1.prototype.clear=mapCacheClear$1,MapCache$1.prototype.delete=mapCacheDelete$1,MapCache$1.prototype.get=mapCacheGet$1,MapCache$1.prototype.has=mapCacheHas$1,MapCache$1.prototype.set=mapCacheSet$1;var FUNC_ERROR_TEXT="Expected a function";function memoize(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],s=r.cache;if(s.has(a))return s.get(a);var i=e.apply(this,n);return r.cache=s.set(a,i)||s,i};return r.cache=new(memoize.Cache||MapCache$1),r}memoize.Cache=MapCache$1;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var t=memoize(e,(function(e){return r.size===MAX_MEMOIZE_SIZE&&r.clear(),e})),r=t.cache;return t}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(rePropName,(function(e,r,n,a){t.push(n?a.replace(reEscapeChar,"$1"):r||e)})),t}));function toString$2(e){return null==e?"":baseToString$1(e)}function castPath(e,t){return isArray$2(e)?e:isKey(e,t)?[e]:stringToPath(toString$2(e))}var INFINITY$2=1/0;function toKey(e){if("string"==typeof e||isSymbol$1(e))return e;var t=e+"";return"0"==t&&1/e==-INFINITY$2?"-0":t}function arrayPush$1(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var getPrototype$1=overArg$1(Object.getPrototypeOf,Object);function stackClear$1(){this.__data__=new ListCache$1,this.size=0}function stackDelete$1(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function stackGet$1(e){return this.__data__.get(e)}function stackHas$1(e){return this.__data__.has(e)}var LARGE_ARRAY_SIZE$2=200;function stackSet$1(e,t){var r=this.__data__;if(r instanceof ListCache$1){var n=r.__data__;if(!Map$2||n.length<LARGE_ARRAY_SIZE$2-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new MapCache$1(n)}return r.set(e,t),this.size=r.size,this}function Stack$1(e){var t=this.__data__=new ListCache$1(e);this.size=t.size}function baseAssign(e,t){return e&&copyObject$1(t,keys$1(t),e)}function baseAssignIn(e,t){return e&&copyObject$1(t,keysIn$1(t),e)}Stack$1.prototype.clear=stackClear$1,Stack$1.prototype.delete=stackDelete$1,Stack$1.prototype.get=stackGet$1,Stack$1.prototype.has=stackHas$1,Stack$1.prototype.set=stackSet$1;var freeExports$3="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$3=freeExports$3&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$3=freeModule$3&&freeModule$3.exports===freeExports$3,Buffer$2=moduleExports$3?root$1.Buffer:void 0,allocUnsafe=Buffer$2?Buffer$2.allocUnsafe:void 0;function cloneBuffer$1(e,t){if(t)return e.slice();var r=e.length,n=allocUnsafe?allocUnsafe(r):new e.constructor(r);return e.copy(n),n}function arrayFilter$1(e,t){for(var r=-1,n=null==e?0:e.length,a=0,s=[];++r<n;){var i=e[r];t(i,r,e)&&(s[a++]=i)}return s}function stubArray$1(){return[]}var objectProto$j=Object.prototype,propertyIsEnumerable$2=objectProto$j.propertyIsEnumerable,nativeGetSymbols$2=Object.getOwnPropertySymbols,getSymbols$1=nativeGetSymbols$2?function(e){return null==e?[]:(e=Object(e),arrayFilter$1(nativeGetSymbols$2(e),(function(t){return propertyIsEnumerable$2.call(e,t)})))}:stubArray$1;function copySymbols(e,t){return copyObject$1(e,getSymbols$1(e),t)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(e){for(var t=[];e;)arrayPush$1(t,getSymbols$1(e)),e=getPrototype$1(e);return t}:stubArray$1;function copySymbolsIn(e,t){return copyObject$1(e,getSymbolsIn(e),t)}function baseGetAllKeys$1(e,t,r){var n=t(e);return isArray$2(e)?n:arrayPush$1(n,r(e))}function getAllKeys$1(e){return baseGetAllKeys$1(e,keys$1,getSymbols$1)}function getAllKeysIn(e){return baseGetAllKeys$1(e,keysIn$1,getSymbolsIn)}var DataView$1=getNative$1(root$1,"DataView"),Promise$2=getNative$1(root$1,"Promise"),Set$2=getNative$1(root$1,"Set"),mapTag$9="[object Map]",objectTag$5="[object Object]",promiseTag$1="[object Promise]",setTag$9="[object Set]",weakMapTag$4="[object WeakMap]",dataViewTag$6="[object DataView]",dataViewCtorString$1=toSource$1(DataView$1),mapCtorString$1=toSource$1(Map$2),promiseCtorString$1=toSource$1(Promise$2),setCtorString$1=toSource$1(Set$2),weakMapCtorString$1=toSource$1(WeakMap$2),getTag$1=baseGetTag$1;(DataView$1&&getTag$1(new DataView$1(new ArrayBuffer(1)))!=dataViewTag$6||Map$2&&getTag$1(new Map$2)!=mapTag$9||Promise$2&&getTag$1(Promise$2.resolve())!=promiseTag$1||Set$2&&getTag$1(new Set$2)!=setTag$9||WeakMap$2&&getTag$1(new WeakMap$2)!=weakMapTag$4)&&(getTag$1=function(e){var t=baseGetTag$1(e),r=t==objectTag$5?e.constructor:void 0,n=r?toSource$1(r):"";if(n)switch(n){case dataViewCtorString$1:return dataViewTag$6;case mapCtorString$1:return mapTag$9;case promiseCtorString$1:return promiseTag$1;case setCtorString$1:return setTag$9;case weakMapCtorString$1:return weakMapTag$4}return t});var objectProto$i=Object.prototype,hasOwnProperty$f=objectProto$i.hasOwnProperty;function initCloneArray$1(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&hasOwnProperty$f.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var Uint8Array$2=root$1.Uint8Array;function cloneArrayBuffer$1(e){var t=new e.constructor(e.byteLength);return new Uint8Array$2(t).set(new Uint8Array$2(e)),t}function cloneDataView$1(e,t){var r=t?cloneArrayBuffer$1(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var reFlags$1=/\w*$/;function cloneRegExp$1(e){var t=new e.constructor(e.source,reFlags$1.exec(e));return t.lastIndex=e.lastIndex,t}var symbolProto$2=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf$1=symbolProto$2?symbolProto$2.valueOf:void 0;function cloneSymbol$1(e){return symbolValueOf$1?Object(symbolValueOf$1.call(e)):{}}function cloneTypedArray$1(e,t){var r=t?cloneArrayBuffer$1(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var boolTag$4="[object Boolean]",dateTag$4="[object Date]",mapTag$8="[object Map]",numberTag$4="[object Number]",regexpTag$4="[object RegExp]",setTag$8="[object Set]",stringTag$4="[object String]",symbolTag$4="[object Symbol]",arrayBufferTag$4="[object ArrayBuffer]",dataViewTag$5="[object DataView]",float32Tag$4="[object Float32Array]",float64Tag$4="[object Float64Array]",int8Tag$4="[object Int8Array]",int16Tag$4="[object Int16Array]",int32Tag$4="[object Int32Array]",uint8Tag$4="[object Uint8Array]",uint8ClampedTag$4="[object Uint8ClampedArray]",uint16Tag$4="[object Uint16Array]",uint32Tag$4="[object Uint32Array]";function initCloneByTag$1(e,t,r){var n=e.constructor;switch(t){case arrayBufferTag$4:return cloneArrayBuffer$1(e);case boolTag$4:case dateTag$4:return new n(+e);case dataViewTag$5:return cloneDataView$1(e,r);case float32Tag$4:case float64Tag$4:case int8Tag$4:case int16Tag$4:case int32Tag$4:case uint8Tag$4:case uint8ClampedTag$4:case uint16Tag$4:case uint32Tag$4:return cloneTypedArray$1(e,r);case mapTag$8:return new n;case numberTag$4:case stringTag$4:return new n(e);case regexpTag$4:return cloneRegExp$1(e);case setTag$8:return new n;case symbolTag$4:return cloneSymbol$1(e)}}function initCloneObject$1(e){return"function"!=typeof e.constructor||isPrototype$1(e)?{}:baseCreate$1(getPrototype$1(e))}var mapTag$7="[object Map]";function baseIsMap$1(e){return isObjectLike$1(e)&&getTag$1(e)==mapTag$7}var nodeIsMap$1=nodeUtil$1&&nodeUtil$1.isMap,isMap$1=nodeIsMap$1?baseUnary$1(nodeIsMap$1):baseIsMap$1,setTag$7="[object Set]";function baseIsSet$1(e){return isObjectLike$1(e)&&getTag$1(e)==setTag$7}var nodeIsSet$1=nodeUtil$1&&nodeUtil$1.isSet,isSet$1=nodeIsSet$1?baseUnary$1(nodeIsSet$1):baseIsSet$1,CLONE_DEEP_FLAG$2=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$2=4,argsTag$3="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$3="[object Error]",funcTag$3="[object Function]",genTag$2="[object GeneratorFunction]",mapTag$6="[object Map]",numberTag$3="[object Number]",objectTag$4="[object Object]",regexpTag$3="[object RegExp]",setTag$6="[object Set]",stringTag$3="[object String]",symbolTag$3="[object Symbol]",weakMapTag$3="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$3="[object Float32Array]",float64Tag$3="[object Float64Array]",int8Tag$3="[object Int8Array]",int16Tag$3="[object Int16Array]",int32Tag$3="[object Int32Array]",uint8Tag$3="[object Uint8Array]",uint8ClampedTag$3="[object Uint8ClampedArray]",uint16Tag$3="[object Uint16Array]",uint32Tag$3="[object Uint32Array]",cloneableTags$1={};function baseClone$1(e,t,r,n,a,s){var i,o=t&CLONE_DEEP_FLAG$2,c=t&CLONE_FLAT_FLAG,u=t&CLONE_SYMBOLS_FLAG$2;if(void 0!==i)return i;if(!isObject$4(e))return e;var l=isArray$2(e);if(l){if(i=initCloneArray$1(e),!o)return copyArray(e,i)}else{var d=getTag$1(e),h=d==funcTag$3||d==genTag$2;if(isBuffer$2(e))return cloneBuffer$1(e,o);if(d==objectTag$4||d==argsTag$3||h&&!a){if(i=c||h?{}:initCloneObject$1(e),!o)return c?copySymbolsIn(e,baseAssignIn(i,e)):copySymbols(e,baseAssign(i,e))}else{if(!cloneableTags$1[d])return a?e:{};i=initCloneByTag$1(e,d,o)}}s||(s=new Stack$1);var p=s.get(e);if(p)return p;s.set(e,i),isSet$1(e)?e.forEach((function(n){i.add(baseClone$1(n,t,r,n,e,s))})):isMap$1(e)&&e.forEach((function(n,a){i.set(a,baseClone$1(n,t,r,a,e,s))}));var f=l?void 0:(u?c?getAllKeysIn:getAllKeys$1:c?keysIn$1:keys$1)(e);return arrayEach$1(f||e,(function(n,a){f&&(n=e[a=n]),assignValue$1(i,a,baseClone$1(n,t,r,a,e,s))})),i}cloneableTags$1[argsTag$3]=cloneableTags$1[arrayTag$2]=cloneableTags$1[arrayBufferTag$3]=cloneableTags$1[dataViewTag$4]=cloneableTags$1[boolTag$3]=cloneableTags$1[dateTag$3]=cloneableTags$1[float32Tag$3]=cloneableTags$1[float64Tag$3]=cloneableTags$1[int8Tag$3]=cloneableTags$1[int16Tag$3]=cloneableTags$1[int32Tag$3]=cloneableTags$1[mapTag$6]=cloneableTags$1[numberTag$3]=cloneableTags$1[objectTag$4]=cloneableTags$1[regexpTag$3]=cloneableTags$1[setTag$6]=cloneableTags$1[stringTag$3]=cloneableTags$1[symbolTag$3]=cloneableTags$1[uint8Tag$3]=cloneableTags$1[uint8ClampedTag$3]=cloneableTags$1[uint16Tag$3]=cloneableTags$1[uint32Tag$3]=!0,cloneableTags$1[errorTag$3]=cloneableTags$1[funcTag$3]=cloneableTags$1[weakMapTag$3]=!1;var CLONE_DEEP_FLAG$1=1,CLONE_SYMBOLS_FLAG$1=4;function cloneDeep$1(e){return baseClone$1(e,CLONE_DEEP_FLAG$1|CLONE_SYMBOLS_FLAG$1)}function hasPath(e,t,r){for(var n=-1,a=(t=castPath(t,e)).length,s=!1;++n<a;){var i=toKey(t[n]);if(!(s=null!=e&&r(e,i)))break;e=e[i]}return s||++n!=a?s:!!(a=null==e?0:e.length)&&isLength$1(a)&&isIndex$1(i,a)&&(isArray$2(e)||isArguments$1(e))}var objectProto$h=Object.prototype,hasOwnProperty$e=objectProto$h.hasOwnProperty;function baseHas(e,t){return null!=e&&hasOwnProperty$e.call(e,t)}function has(e,t){return null!=e&&hasPath(e,t,baseHas)}var mapTag$5="[object Map]",setTag$5="[object Set]",objectProto$g=Object.prototype,hasOwnProperty$d=objectProto$g.hasOwnProperty;function isEmpty(e){if(null==e)return!0;if(isArrayLike$1(e)&&(isArray$2(e)||"string"==typeof e||"function"==typeof e.splice||isBuffer$2(e)||isTypedArray$1(e)||isArguments$1(e)))return!e.length;var t=getTag$1(e);if(t==mapTag$5||t==setTag$5)return!e.size;if(isPrototype$1(e))return!baseKeys$1(e).length;for(var r in e)if(hasOwnProperty$d.call(e,r))return!1;return!0}function baseSet(e,t,r,n){if(!isObject$4(e))return e;for(var a=-1,s=(t=castPath(t,e)).length,i=s-1,o=e;null!=o&&++a<s;){var c=toKey(t[a]),u=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(a!=i){var l=o[c];void 0===(u=void 0)&&(u=isObject$4(l)?l:isIndex$1(t[a+1])?[]:{})}assignValue$1(o,c,u),o=o[c]}return e}function set(e,t,r){return null==e?e:baseSet(e,t,r)}var dayjs_min={exports:{}};!function(e,t){e.exports=function(){var e=1e3,t=6e4,r=36e5,n="millisecond",a="second",s="minute",i="hour",o="day",c="week",u="month",l="quarter",d="year",h="date",p="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}},b=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},m={s:b,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),a=r%60;return(t<=0?"+":"-")+b(n,2,"0")+":"+b(a,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),a=t.clone().add(n,u),s=r-a<0,i=t.clone().add(n+(s?-1:1),u);return+(-(n+(r-a)/(s?a-i:i-a))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:u,y:d,w:c,d:o,D:h,h:i,m:s,s:a,ms:n,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},$="en",v={};v[$]=y;var T="$isDayjsObject",S=function(e){return e instanceof O||!(!e||!e[T])},j=function e(t,r,n){var a;if(!t)return $;if("string"==typeof t){var s=t.toLowerCase();v[s]&&(a=s),r&&(v[s]=r,a=s);var i=t.split("-");if(!a&&i.length>1)return e(i[0])}else{var o=t.name;v[o]=t,a=o}return!n&&a&&($=a),a||!n&&$},E=function(e,t){if(S(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new O(r)},_=m;_.l=j,_.i=S,_.w=function(e,t){return E(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var O=function(){function y(e){this.$L=j(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[T]=!0}var b=y.prototype;return b.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(_.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(f);if(n){var a=n[2]-1||0,s=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],a,n[3]||1,n[4]||0,n[5]||0,n[6]||0,s)):new Date(n[1],a,n[3]||1,n[4]||0,n[5]||0,n[6]||0,s)}}return new Date(t)}(e),this.init()},b.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},b.$utils=function(){return _},b.isValid=function(){return!(this.$d.toString()===p)},b.isSame=function(e,t){var r=E(e);return this.startOf(t)<=r&&r<=this.endOf(t)},b.isAfter=function(e,t){return E(e)<this.startOf(t)},b.isBefore=function(e,t){return this.endOf(t)<E(e)},b.$g=function(e,t,r){return _.u(e)?this[t]:this.set(r,e)},b.unix=function(){return Math.floor(this.valueOf()/1e3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(e,t){var r=this,n=!!_.u(t)||t,l=_.p(e),p=function(e,t){var a=_.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return n?a:a.endOf(o)},f=function(e,t){return _.w(r.toDate()[e].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},g=this.$W,y=this.$M,b=this.$D,m="set"+(this.$u?"UTC":"");switch(l){case d:return n?p(1,0):p(31,11);case u:return n?p(1,y):p(0,y+1);case c:var $=this.$locale().weekStart||0,v=(g<$?g+7:g)-$;return p(n?b-v:b+(6-v),y);case o:case h:return f(m+"Hours",0);case i:return f(m+"Minutes",1);case s:return f(m+"Seconds",2);case a:return f(m+"Milliseconds",3);default:return this.clone()}},b.endOf=function(e){return this.startOf(e,!1)},b.$set=function(e,t){var r,c=_.p(e),l="set"+(this.$u?"UTC":""),p=(r={},r[o]=l+"Date",r[h]=l+"Date",r[u]=l+"Month",r[d]=l+"FullYear",r[i]=l+"Hours",r[s]=l+"Minutes",r[a]=l+"Seconds",r[n]=l+"Milliseconds",r)[c],f=c===o?this.$D+(t-this.$W):t;if(c===u||c===d){var g=this.clone().set(h,1);g.$d[p](f),g.init(),this.$d=g.set(h,Math.min(this.$D,g.daysInMonth())).$d}else p&&this.$d[p](f);return this.init(),this},b.set=function(e,t){return this.clone().$set(e,t)},b.get=function(e){return this[_.p(e)]()},b.add=function(n,l){var h,p=this;n=Number(n);var f=_.p(l),g=function(e){var t=E(p);return _.w(t.date(t.date()+Math.round(e*n)),p)};if(f===u)return this.set(u,this.$M+n);if(f===d)return this.set(d,this.$y+n);if(f===o)return g(1);if(f===c)return g(7);var y=(h={},h[s]=t,h[i]=r,h[a]=e,h)[f]||1,b=this.$d.getTime()+n*y;return _.w(b,this)},b.subtract=function(e,t){return this.add(-1*e,t)},b.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||p;var n=e||"YYYY-MM-DDTHH:mm:ssZ",a=_.z(this),s=this.$H,i=this.$m,o=this.$M,c=r.weekdays,u=r.months,l=r.meridiem,d=function(e,r,a,s){return e&&(e[r]||e(t,n))||a[r].slice(0,s)},h=function(e){return _.s(s%12||12,e,"0")},f=l||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(g,(function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return _.s(t.$y,4,"0");case"M":return o+1;case"MM":return _.s(o+1,2,"0");case"MMM":return d(r.monthsShort,o,u,3);case"MMMM":return d(u,o);case"D":return t.$D;case"DD":return _.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(r.weekdaysMin,t.$W,c,2);case"ddd":return d(r.weekdaysShort,t.$W,c,3);case"dddd":return c[t.$W];case"H":return String(s);case"HH":return _.s(s,2,"0");case"h":return h(1);case"hh":return h(2);case"a":return f(s,i,!0);case"A":return f(s,i,!1);case"m":return String(i);case"mm":return _.s(i,2,"0");case"s":return String(t.$s);case"ss":return _.s(t.$s,2,"0");case"SSS":return _.s(t.$ms,3,"0");case"Z":return a}return null}(e)||a.replace(":","")}))},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(n,h,p){var f,g=this,y=_.p(h),b=E(n),m=(b.utcOffset()-this.utcOffset())*t,$=this-b,v=function(){return _.m(g,b)};switch(y){case d:f=v()/12;break;case u:f=v();break;case l:f=v()/3;break;case c:f=($-m)/6048e5;break;case o:f=($-m)/864e5;break;case i:f=$/r;break;case s:f=$/t;break;case a:f=$/e;break;default:f=$}return p?f:_.a(f)},b.daysInMonth=function(){return this.endOf(u).$D},b.$locale=function(){return v[this.$L]},b.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=j(e,t,!0);return n&&(r.$L=n),r},b.clone=function(){return _.w(this.$d,this)},b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},y}(),w=O.prototype;return E.prototype=w,[["$ms",n],["$s",a],["$m",s],["$H",i],["$W",o],["$M",u],["$y",d],["$D",h]].forEach((function(e){w[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),E.extend=function(e,t){return e.$i||(e(t,O,E),e.$i=!0),E},E.locale=j,E.isDayjs=S,E.unix=function(e){return E(1e3*e)},E.en=v[$],E.Ls=v,E.p={},E}()}(dayjs_min);var utc={exports:{}};!function(e,t){e.exports=function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(n,a,s){var i=a.prototype;s.utc=function(e){return new a({date:e,utc:!0,args:arguments})},i.utc=function(t){var r=s(this.toDate(),{locale:this.$L,utc:!0});return t?r.add(this.utcOffset(),e):r},i.local=function(){return s(this.toDate(),{locale:this.$L,utc:!1})};var o=i.parse;i.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),o.call(this,e)};var c=i.init;i.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else c.call(this)};var u=i.utcOffset;i.utcOffset=function(n,a){var s=this.$utils().u;if(s(n))return this.$u?0:s(this.$offset)?u.call(this):this.$offset;if("string"==typeof n&&(n=function(e){void 0===e&&(e="");var n=e.match(t);if(!n)return null;var a=(""+n[0]).match(r)||["-",0,0],s=a[0],i=60*+a[1]+ +a[2];return 0===i?0:"+"===s?i:-i}(n),null===n))return this;var i=Math.abs(n)<=16?60*n:n,o=this;if(a)return o.$offset=i,o.$u=0===n,o;if(0!==n){var c=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(o=this.local().add(i+c,e)).$offset=i,o.$x.$localOffset=c}else o=this.utc();return o};var l=i.format;i.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,t)},i.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},i.isUTC=function(){return!!this.$u},i.toISOString=function(){return this.toDate().toISOString()},i.toString=function(){return this.toDate().toUTCString()};var d=i.toDate;i.toDate=function(e){return"s"===e&&this.$offset?s(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var h=i.diff;i.diff=function(e,t,r){if(e&&this.$u===e.$u)return h.call(this,e,t,r);var n=this.local(),a=s(e).local();return h.call(n,a,t,r)}}}()}(utc);var a=(e=>(e.CONTAINER="container",e.PAGE="page",e.ROOT="app",e.PAGE_FRAGMENT="page-fragment",e))(a||{}),E=(e=>(e.COMP="comp",e.CODE="code",e.DATA_SOURCE="data-source",e))(E||{}),O=(e=>(e.CODE="code",e))(O||{}),t=(e=>(e.CODE="code",e.DATA_SOURCE_METHOD="data-source-method",e))(t||{});const getNodePath=(e,t=[])=>{const r=[],n=function(e,t){if(!Array.isArray(t))return null;for(let a=0,s=t.length;a<s;a++){const s=t[a];if(r.push(s),`${s.id}`==`${e}`)return s;if(s.items){const t=n(e,s.items);if(t)return t}r.pop()}return null};return n(e,t),r},filterXSS=e=>e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),getUrlParam=(e,t)=>{const r=location.href,n=new RegExp(`[?&#]${e}=([^&#]+)`,"gi"),a=r.match(n);let s;return a&&a.length>0?(s=a[a.length-1].split("="),s&&s.length>1?filterXSS(s[1]):""):""},isObject$3=e=>"[object Object]"===Object.prototype.toString.call(e),isPage=e=>!!e&&Boolean(e.type?.toLowerCase()===a.PAGE),isPageFragment=e=>!!e&&Boolean(e.type?.toLowerCase()===a.PAGE_FRAGMENT),getValueByKeyPath=(e="",t={})=>(Array.isArray(e)?e:`${e}`.replaceAll(/\[(\d+)\]/g,".$1").split(".")).reduce(((e,t)=>{if(isObject$3(e)||Array.isArray(e))return e[t]}),t),setValueByKeyPath=(e,t,r={})=>set(r,e,t),getNodes=(e,t=[])=>{const r=[],n=function(e,t){if(Array.isArray(t))for(let a=0,s=t.length;a<s;a++){const s=t[a],i=e.findIndex((e=>`${e}`==`${s.id}`));i>-1&&(e.slice(i,1),r.push(s)),s.items&&n(e,s.items)}};return n(e,t),r},getDepKeys=(e={},t)=>Array.from(Object.values(e).reduce(((e,r)=>((r[t]?.keys||[]).forEach((t=>e.add(t))),e)),new Set)),getDepNodeIds=(e={})=>Array.from(Object.values(e).reduce(((e,t)=>(Object.keys(t).forEach((t=>{e.add(t)})),e)),new Set)),replaceChildNode=(e,t,r)=>{const n=getNodePath(e.id,t),a=n.pop();let s=n.pop();if(!a)throw new Error("未找到目标节点");if(!s)throw new Error("未找到父节点");const i=s.items?.findIndex((e=>e.id===a.id));s.items.splice(i,1,e)},DSL_NODE_KEY_COPY_PREFIX="__tmagic__",compiledNode=(e,t,r={},n)=>{let a=[];if(n){const e=r[n];a=e?.[t.id].keys||[]}else a=getDepKeys(r,t.id);return a.forEach((r=>{const n=`${r}`.replaceAll(/\[(\d+)\]/g,".$1").split("."),a=n.map(((e,t)=>t<n.length-1?e:`${DSL_NODE_KEY_COPY_PREFIX}${e}`)),s=getValueByKeyPath(r,t);let i,o=getValueByKeyPath(a,t);void 0===o&&(setValueByKeyPath(a.join("."),s,t),o=s);try{i=e(o)}catch(c){console.error(c),i=""}setValueByKeyPath(r,i,t)})),t},compiledCond=(e,t,r,n=[])=>{switch("string"==typeof t&&void 0===r&&(r=""),e){case"is":case"=":return t===r;case"not":case"!=":return t!==r;case">":return t>r;case">=":return t>=r;case"<":return t<r;case"<=":return t<=r;case"between":return n.length>1&&t>=n[0]&&t<=n[1];case"not_between":return n.length<2||t<n[0]||t>n[1];case"include":return t?.includes?.(r);case"not_include":return void 0===t||!t.includes?.(r)}return!1},getDefaultValueFromFields=e=>{const t={},r={string:void 0,object:{},array:[],boolean:void 0,number:void 0,null:null,any:void 0};return e.forEach((e=>{if(void 0===e.defaultValue)"object"!==e.type?e.type?t[e.name]=r[e.type]:t[e.name]=void 0:t[e.name]=e.fields?getDefaultValueFromFields(e.fields):r.object;else{if("array"===e.type&&!Array.isArray(e.defaultValue))return void(t[e.name]=r.array);if("object"===e.type&&!isObject$3(e.defaultValue)){if("string"==typeof e.defaultValue){try{t[e.name]=JSON.parse(e.defaultValue)}catch(n){t[e.name]=r.object}return}return void(t[e.name]=r.object)}t[e.name]=cloneDeep$1(e.defaultValue)}})),t},DATA_SOURCE_FIELDS_SELECT_VALUE_PREFIX="ds-field::",DATA_SOURCE_FIELDS_CHANGE_EVENT_PREFIX="ds-field-changed",addParamToUrl=(e,t=globalThis,r=!0)=>{const n=new URL(t.location.href),{searchParams:a}=n;for(const[i,o]of Object.entries(e))a.set(i,o);const s=n.toString();r?t.location.href=s:t.history.pushState({},"",n)};var DepTargetType=(e=>(e.DEFAULT="default",e.CODE_BLOCK="code-block",e.DATA_SOURCE="data-source",e.DATA_SOURCE_METHOD="data-source-method",e.DATA_SOURCE_COND="data-source-cond",e))(DepTargetType||{});class Target{isTarget;id;name;type=(()=>DepTargetType.DEFAULT)();deps={};isCollectByDefault;constructor(e){this.isTarget=e.isTarget,this.id=e.id,this.name=e.name,this.isCollectByDefault=e.isCollectByDefault??!0,e.type&&(this.type=e.type),e.initialDeps&&(this.deps=e.initialDeps)}updateDep({id:e,name:t,key:r,data:n}){const a=this.deps[e]||{name:t,keys:[]};a.name=t,a.data=n,this.deps[e]=a,-1===a.keys.indexOf(r)&&a.keys.push(r)}removeDep(e,t){if(void 0===e)return void Object.keys(this.deps).forEach((e=>{delete this.deps[e]}));const r=this.deps[e];if(r)if(t){const n=r.keys.indexOf(t);r.keys.splice(n,1),0===r.keys.length&&delete this.deps[e]}else delete this.deps[e]}hasDep(e,t){const r=this.deps[e];return Boolean(r?.keys.find((e=>e===t)))}destroy(){this.deps={}}}const isDataSourceTemplate=(e,t)=>"string"==typeof e&&e.includes(`${t}`)&&/\$\{([\s\S]+?)\}/.test(e),isUseDataSourceField=(e,t)=>{if(!Array.isArray(e)||"string"!=typeof e[0])return!1;const[r]=e,n=r.indexOf(DATA_SOURCE_FIELDS_SELECT_VALUE_PREFIX);if(-1===n)return!1;return r.substring(n+DATA_SOURCE_FIELDS_SELECT_VALUE_PREFIX.length)===t},traverseTarget=(e,t,r)=>{Object.values(e).forEach((e=>{Object.values(e).forEach((e=>{r&&e.type!==r||t(e)}))}))};class Watcher{targetsList={};childrenProp="items";idProp="id";nameProp="name";constructor(e){e?.initialTargets&&(this.targetsList=e.initialTargets),e?.childrenProp&&(this.childrenProp=e.childrenProp)}getTargetsList(){return this.targetsList}getTargets(e=DepTargetType.DEFAULT){return this.targetsList[e]||{}}addTarget(e){const t=this.getTargets(e.type)||{};this.targetsList[e.type]=t,t[e.id]=e}getTarget(e,t=DepTargetType.DEFAULT){return this.getTargets(t)[e]}hasTarget(e,t=DepTargetType.DEFAULT){return Boolean(this.getTarget(e,t))}hasSpecifiedTypeTarget(e=DepTargetType.DEFAULT){return Object.keys(this.getTargets(e)).length>0}removeTarget(e,t=DepTargetType.DEFAULT){const r=this.getTargets(t);r[e]&&(r[e].destroy(),delete r[e])}removeTargets(e=DepTargetType.DEFAULT){const t=this.targetsList[e];if(t){for(const e of Object.values(t))e.destroy();delete this.targetsList[e]}}clearTargets(){Object.keys(this.targetsList).forEach((e=>{delete this.targetsList[e]}))}collect(e,t={},r=!1,n){this.collectByCallback(e,n,(({node:e,target:n})=>{this.removeTargetDep(n,e),this.collectItem(e,n,t,r)}))}collectByCallback(e,t,r){traverseTarget(this.targetsList,(n=>{(t||n.isCollectByDefault)&&e.forEach((e=>{r({node:e,target:n})}))}),t)}clear(e,t){let{targetsList:r}=this;t&&(r={[t]:this.getTargets(t)});const n=[];traverseTarget(r,(t=>{e?e.forEach((e=>{t.removeDep(e[this.idProp]),Array.isArray(e[this.childrenProp])&&e[this.childrenProp].length&&!n.includes(e[this.idProp])&&(n.push(e[this.idProp]),this.clear(e[this.childrenProp]))})):t.removeDep()}))}clearByType(e,t){this.clear(t,e)}collectItem(e,t,r={},n=!1){const a=(s,i="")=>{const o=(s,o)=>{const c=s===this.childrenProp,u=i?`${i}.${s}`:s;t.isTarget(u,o)?t.updateDep({id:e[this.idProp],name:`${e[this.nameProp]||e[this.idProp]}`,data:r,key:u}):!c&&Array.isArray(o)?o.forEach(((e,t)=>{isObject$3(e)&&a(e,`${u}[${t}]`)})):isObject$3(o)&&a(o,u),c&&n&&Array.isArray(o)&&o.forEach((e=>{this.collectItem(e,t,r,n)}))};Object.entries(s).forEach((([e,t])=>{void 0!==t&&""!==t&&o(e,t)}))};a(e)}removeTargetDep(e,t,r){e.removeDep(t[this.idProp],r),void 0===r&&Array.isArray(t[this.childrenProp])&&t[this.childrenProp].length&&t[this.childrenProp].forEach((t=>{this.removeTargetDep(e,t,r)}))}}
/*! *****************************************************************************
      Copyright (c) Microsoft Corporation.

      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.

      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** */function __awaiter(e,t,r,n){return new(r||(r=Promise))((function(t,a){function s(e){try{o(n.next(e))}catch(t){a(t)}}function i(e){try{o(n.throw(e))}catch(t){a(t)}}function o(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,i)}o((n=n.apply(e,[])).next())}))}const segments=[];function Match(e,t,r="*"){if(e===r)return!0;segments.length=0;let n=0,a=0,s=0,i=0;for(let d=0,h=e.length;d<h;d+=1){const t=e[d];t===r&&(n+=1,d>i&&segments.push(e.substring(i,d)),segments.push(t),i=d+1)}if(i<e.length&&segments.push(e.substring(i)),n?(a=e.length-n,s=1/0):s=a=e.length,0===segments.length)return e===t;const o=t.length;if(o<a||o>s)return!1;let c=segments.length-1,u=t.length-1,l=!1;for(;;){const e=segments[c];if(c-=1,e===r)l=!0;else{const r=u+1-e.length,n=t.lastIndexOf(e,r);if(-1===n||n>r)return!1;if(l)u=n-1,l=!1;else{if(n!==r)return!1;u-=e.length}}if(0>c)break}return!0}class WildcardObject{constructor(e,t,r,n=void 0){this.obj=e,this.delimiter=t,this.wildcard=r,this.is_match=n}shortMatch(e,t){if(e===t)return!0;if(e===this.wildcard)return!0;if(this.is_match)return this.is_match(e,t);const r=e.indexOf(this.wildcard);if(r>-1){const n=e.substr(r+1);if(0===r||t.substring(0,r)===e.substring(0,r)){const e=n.length;return!(e>0)||t.substr(-e)===n}}return!1}match(e,t){return this.is_match?this.is_match(e,t):e===t||e===this.wildcard||t===this.wildcard||this.shortMatch(e,t)||Match(e,t,this.wildcard)}handleArray(e,t,r,n,a={}){let s=e.indexOf(this.delimiter,r),i=!1;-1===s&&(i=!0,s=e.length);const o=e.substring(r,s);let c=0;for(const u of t){const t=c.toString(),r=""===n?t:n+this.delimiter+c;(o===this.wildcard||o===t||this.shortMatch(o,t))&&(i?a[r]=u:this.goFurther(e,u,s+1,r,a)),c++}return a}handleObject(e,t,r,n,a={}){let s=e.indexOf(this.delimiter,r),i=!1;-1===s&&(i=!0,s=e.length);const o=e.substring(r,s);for(let c in t){c=c.toString();const r=""===n?c:n+this.delimiter+c;(o===this.wildcard||o===c||this.shortMatch(o,c))&&(i?a[r]=t[c]:this.goFurther(e,t[c],s+1,r,a))}return a}goFurther(e,t,r,n,a={}){return Array.isArray(t)?this.handleArray(e,t,r,n,a):this.handleObject(e,t,r,n,a)}get(e){return this.goFurther(e,this.obj,0,"")}}class ObjectPath{static get(e,t,r=!1){if(!t)return;let n=t;for(const a of e)if(a in n)n=n[a];else{if(!r)return;n[a]=Object.create({}),n=n[a]}return n}static set(e,t,r){if(!r)return;if(0===e.length){for(const e in r)delete r[e];for(const e in t)r[e]=t[e];return}const n=e.slice(),a=n.pop(),s=ObjectPath.get(n,r,!0);return"object"==typeof s&&(s[a]=t),t}}let wasm,WASM_VECTOR_LEN=0,cachegetUint8Memory0=null;function getUint8Memory0(){return null!==cachegetUint8Memory0&&cachegetUint8Memory0.buffer===wasm.memory.buffer||(cachegetUint8Memory0=new Uint8Array(wasm.memory.buffer)),cachegetUint8Memory0}let cachedTextEncoder=new TextEncoder("utf-8");const encodeString="function"==typeof cachedTextEncoder.encodeInto?function(e,t){return cachedTextEncoder.encodeInto(e,t)}:function(e,t){const r=cachedTextEncoder.encode(e);return t.set(r),{read:e.length,written:r.length}};function passStringToWasm0(e,t,r){if(void 0===r){const r=cachedTextEncoder.encode(e),n=t(r.length);return getUint8Memory0().subarray(n,n+r.length).set(r),WASM_VECTOR_LEN=r.length,n}let n=e.length,a=t(n);const s=getUint8Memory0();let i=0;for(;i<n;i++){const t=e.charCodeAt(i);if(t>127)break;s[a+i]=t}if(i!==n){0!==i&&(e=e.slice(i)),a=r(a,n,n=i+3*e.length);const t=getUint8Memory0().subarray(a+i,a+n);i+=encodeString(e,t).written}return WASM_VECTOR_LEN=i,a}function is_match(e,t){var r=passStringToWasm0(e,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),n=WASM_VECTOR_LEN,a=passStringToWasm0(t,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),s=WASM_VECTOR_LEN;return 0!==wasm.is_match(r,n,a,s)}async function load(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(r){if("application/wasm"==e.headers.get("Content-Type"))throw r;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}async function init(e){("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:t,module:r}=await load(await e,{});return wasm=t.exports,init.__wbindgen_wasm_module=r,wasm}const defaultUpdateOptions={only:[],source:"",debug:!1,data:void 0,queue:!1,force:!1};function log(e,t){console.debug(e,t)}function getDefaultOptions(){return{delimiter:".",debug:!1,extraDebug:!1,useMute:!0,notRecursive:";",param:":",wildcard:"*",experimentalMatch:!1,queue:!1,defaultBulkValue:!0,useCache:!1,useSplitCache:!1,useIndicesCache:!1,maxSimultaneousJobs:1e3,maxQueueRuns:1e3,log:log,Promise:Promise}}function isObject$2(e){return e&&e.constructor?"Object"===e.constructor.name:"object"==typeof e&&null!==e}class DeepState{constructor(e={},t={}){this.jobsRunning=0,this.updateQueue=[],this.subscribeQueue=[],this.listenersIgnoreCache=new WeakMap,this.is_match=null,this.destroyed=!1,this.queueRuns=0,this.groupId=0,this.namedGroups=[],this.numberGroups=[],this.traceId=0,this.traceMap=new Map,this.tracing=[],this.savedTrace=[],this.collection=null,this.collections=0,this.cache=new Map,this.splitCache=new Map,this.indices=new Map,this.indicesCount=new Map,this.lastExecs=new WeakMap,this.listeners=new Map,this.waitingListeners=new Map,this.options=Object.assign(Object.assign({},getDefaultOptions()),t),this.data=e,this.id=0,this.options.useCache?(this.pathGet=this.cacheGet,this.pathSet=this.cacheSet):(this.pathGet=ObjectPath.get,this.pathSet=ObjectPath.set),t.Promise?this.resolved=t.Promise.resolve():this.resolved=Promise.resolve(),this.muted=new Set,this.mutedListeners=new Set,this.scan=new WildcardObject(this.data,this.options.delimiter,this.options.wildcard),this.destroyed=!1}getDefaultListenerOptions(){return{bulk:!1,bulkValue:this.options.defaultBulkValue,debug:!1,source:"",data:void 0,queue:!1,group:!1}}cacheGet(e,t=this.data,r=!1){const n=e.join(this.options.delimiter),a=this.cache.get(n);if(a){const e=a.deref();if(e)return e}const s=ObjectPath.get(e,t,r);return(isObject$2(s)||Array.isArray(s))&&this.cache.set(n,new WeakRef(s)),s}cacheSet(e,t,r=this.data){const n=e.join(this.options.delimiter);return isObject$2(t)||Array.isArray(t)?this.cache.set(n,new WeakRef(t)):this.cache.delete(n),ObjectPath.set(e,t,r)}silentSet(e,t){return this.pathSet(this.split(e),t,this.data)}loadWasmMatcher(e){return __awaiter(this,void 0,void 0,(function*(){yield init(e),this.is_match=is_match,this.scan=new WildcardObject(this.data,this.options.delimiter,this.options.wildcard,this.is_match)}))}same(e,t){return(["number","string","undefined","boolean"].includes(typeof e)||null===e)&&t===e}getListeners(){return this.listeners}destroy(){this.destroyed=!0,this.data=void 0,this.listeners=new Map,this.waitingListeners=new Map,this.updateQueue=[],this.jobsRunning=0}match(e,t,r=!0){return this.is_match?this.is_match(e,t):e===t||(e===this.options.wildcard||t===this.options.wildcard||!(!r&&this.getIndicesCount(this.options.delimiter,e)<this.getIndicesCount(this.options.delimiter,t))&&this.scan.match(e,t))}getIndicesOf(e,t){if(this.options.useIndicesCache&&this.indices.has(t))return this.indices.get(t);const r=e.length;if(0==r)return[];let n,a=0,s=[];for(;(n=t.indexOf(e,a))>-1;)s.push(n),a=n+r;return this.options.useIndicesCache&&this.indices.set(t,s),s}getIndicesCount(e,t){if(this.options.useIndicesCache&&this.indicesCount.has(t))return this.indicesCount.get(t);const r=e.length;if(0==r)return 0;let n,a=0,s=0;for(;(n=t.indexOf(e,a))>-1;)s++,a=n+r;return this.options.useIndicesCache&&this.indicesCount.set(t,s),s}cutPath(e,t){if(""===t)return"";if((e=this.cleanNotRecursivePath(e))===(t=this.cleanNotRecursivePath(t)))return e;const r=this.getIndicesCount(this.options.delimiter,t),n=this.getIndicesOf(this.options.delimiter,e);return e.substring(0,n[r])}trimPath(e){return(e=this.cleanNotRecursivePath(e)).charAt(0)===this.options.delimiter?e.substr(1):e}split(e){if(""===e)return[];if(!this.options.useSplitCache)return e.split(this.options.delimiter);const t=this.splitCache.get(e);if(t)return t.slice();const r=e.split(this.options.delimiter);return this.splitCache.set(e,r.slice()),r}isWildcard(e){return e.includes(this.options.wildcard)||this.hasParams(e)}isNotRecursive(e){return e.endsWith(this.options.notRecursive)}cleanNotRecursivePath(e){return this.isNotRecursive(e)?e.substring(0,e.length-1):e}hasParams(e){return e.includes(this.options.param)}getParamsInfo(e){let t={replaced:"",original:e,params:{}},r=0,n=[];for(const a of this.split(e)){t.params[r]={original:a,replaced:"",name:""};const e=new RegExp(`\\${this.options.param}([^\\${this.options.delimiter}\\${this.options.param}]+)`,"g");let s=e.exec(a);s?(t.params[r].name=s[1],e.lastIndex=0,t.params[r].replaced=a.replace(e,this.options.wildcard),n.push(t.params[r].replaced),r++):(delete t.params[r],n.push(a),r++)}return t.replaced=n.join(this.options.delimiter),t}getParams(e,t){if(!e)return;const r=this.split(t),n={};for(const a in e.params){n[e.params[a].name]=r[a]}return n}waitForAll(e,t){const r={};for(let n of e)r[n]={dirty:!1},this.hasParams(n)&&(r[n].paramsInfo=this.getParamsInfo(n)),r[n].isWildcard=this.isWildcard(n),r[n].isRecursive=!this.isNotRecursive(n);return this.waitingListeners.set(e,{fn:t,paths:r}),t(r),function(){this.waitingListeners.delete(e)}}executeWaitingListeners(e){if(!this.destroyed)for(const t of this.waitingListeners.values()){const{fn:r,paths:n}=t;let a=0,s=0;for(let t in n){const r=n[t];let i=!1;r.isRecursive&&(e=this.cutPath(e,t)),r.isWildcard&&this.match(t,e)&&(i=!0),e===t&&(i=!0),i&&(r.dirty=!0),r.dirty&&a++,s++}a===s&&r(n)}}subscribeAll(e,t,r=this.getDefaultListenerOptions()){if(this.destroyed)return()=>{};let n=[],a=0,s=null;"boolean"==typeof r.group&&r.group?(this.groupId++,s=this.groupId,r.bulk=!0):"string"==typeof r.group&&(r.bulk=!0,s=r.group);for(const i of e)n.push(this.subscribe(i,t,r,{all:e,index:a,groupId:s})),a++;return function(){for(const e of n)e()}}getCleanListenersCollection(e={}){return Object.assign({listeners:new Map,isRecursive:!1,isWildcard:!1,hasParams:!1,match:void 0,paramsInfo:void 0,path:void 0,originalPath:void 0,count:0},e)}getCleanListener(e,t=this.getDefaultListenerOptions()){return{fn:e,options:Object.assign(Object.assign({},this.getDefaultListenerOptions()),t),groupId:null}}getListenerCollectionMatch(e,t,r){e=this.cleanNotRecursivePath(e);const n=this;return function(a,s=!1){let i=e;return t?a=n.cutPath(a,e):i=n.cutPath(n.cleanNotRecursivePath(e),a),s&&console.log("[getListenerCollectionMatch]",{listenerPath:e,scopedListenerPath:i,path:a,isRecursive:t,isWildcard:r}),!(!r||!n.match(i,a,t))||i===a}}getListenersCollection(e,t){if(this.listeners.has(e)){let r=this.listeners.get(e);return r.listeners.set(++this.id,t),t.id=this.id,r}const r=this.hasParams(e);let n;r&&(n=this.getParamsInfo(e));let a={isRecursive:!this.isNotRecursive(e),isWildcard:this.isWildcard(e),hasParams:r,paramsInfo:n,originalPath:e,path:r?n.replaced:e};a.isRecursive||(a.path=this.cleanNotRecursivePath(a.path));let s=this.getCleanListenersCollection(Object.assign(Object.assign({},a),{match:this.getListenerCollectionMatch(a.path,a.isRecursive,a.isWildcard)}));return this.id++,s.listeners.set(this.id,t),t.id=this.id,this.listeners.set(a.originalPath,s),s}subscribe(e,t,r=this.getDefaultListenerOptions(),n={all:[e],index:0,groupId:null}){if(this.destroyed)return()=>{};this.jobsRunning++;const a="subscribe";let s=this.getCleanListener(t,r);r.group&&(r.bulk=!0,"string"==typeof r.group?s.groupId=r.group:n.groupId&&(s.groupId=n.groupId)),this.listenersIgnoreCache.set(s,{truthy:[],falsy:[]});const i=this.getListenersCollection(e,s);r.debug&&console.log("[subscribe]",{listenerPath:e,options:r}),i.count++;let o=!0;if(s.groupId&&("string"==typeof s.groupId?this.namedGroups.includes(s.groupId)?o=!1:this.namedGroups.push(s.groupId):"number"==typeof s.groupId&&(this.numberGroups.includes(s.groupId)?o=!1:this.numberGroups.push(s.groupId))),o){const n=this.cleanNotRecursivePath(i.path),o=this.split(n);if(i.isWildcard){const o=this.scan.get(n);if(r.bulk){const n=[];for(const e in o)this.isMuted(e)||n.push({path:e,params:this.getParams(i.paramsInfo,e),value:o[e]});this.isMuted(t)||t(n,{type:a,listener:s,listenersCollection:i,path:{listener:e,update:void 0,resolved:void 0},options:r,params:void 0})}else for(const n in o)this.isMuted(n)||this.isMuted(t)||t(o[n],{type:a,listener:s,listenersCollection:i,path:{listener:e,update:void 0,resolved:this.cleanNotRecursivePath(n)},params:this.getParams(i.paramsInfo,n),options:r})}else this.isMuted(n)||this.isMuted(t)||t(this.pathGet(o,this.data),{type:a,listener:s,listenersCollection:i,path:{listener:e,update:void 0,resolved:this.cleanNotRecursivePath(e)},params:this.getParams(i.paramsInfo,n),options:r})}return this.debugSubscribe(s,i,e),this.jobsRunning--,this.unsubscribe(e,this.id)}unsubscribe(e,t){const r=this.listeners,n=r.get(e);return function(){n.listeners.delete(t),n.count--,0===n.count&&r.delete(e)}}runQueuedListeners(){if(!this.destroyed&&0!==this.subscribeQueue.length)if(0===this.jobsRunning){this.queueRuns=0;const e=[...this.subscribeQueue];for(let t=0,r=e.length;t<r;t++)e[t]();this.subscribeQueue.length=0}else{if(this.queueRuns++,this.queueRuns>=this.options.maxQueueRuns)throw this.queueRuns=0,new Error("Maximal number of queue runs exhausted.");Promise.resolve().then((()=>this.runQueuedListeners())).catch((e=>{throw e}))}}getQueueNotifyListeners(e,t=[]){for(const r in e){if(this.isMuted(r))continue;let{single:n,bulk:a}=e[r];for(const e of n){let r=!1,n=e.listener.id+":"+e.eventInfo.path.resolved;e.eventInfo.path.resolved||(n=e.listener.id+":"+e.eventInfo.path.listener);for(const e of t)if(n===e.resolvedIdPath){r=!0;break}if(r)continue;const a=this.debugTime(e);if(!this.isMuted(e.listener.fn))if(e.listener.options.queue&&this.jobsRunning)this.subscribeQueue.push((()=>{e.listener.fn(e.value?e.value():void 0,e.eventInfo)}));else{let r=e.listener.id+":"+e.eventInfo.path.resolved;e.eventInfo.path.resolved||(r=e.listener.id+":"+e.eventInfo.path.listener),t.push({id:e.listener.id,resolvedPath:e.eventInfo.path.resolved,resolvedIdPath:r,originalFn:e.listener.fn,fn:()=>{e.listener.fn(e.value?e.value():void 0,e.eventInfo)},options:e.listener.options,groupId:e.listener.groupId})}this.debugListener(a,e)}for(const e of a){let r=!1;for(const s of t)if(s.id===e.listener.id){r=!0;break}if(r)continue;const n=this.debugTime(e),a=[];for(const t of e.value)a.push(Object.assign(Object.assign({},t),{value:t.value?t.value():void 0}));if(!this.isMuted(e.listener.fn))if(e.listener.options.queue&&this.jobsRunning)this.subscribeQueue.push((()=>!this.jobsRunning&&(e.listener.fn(a,e.eventInfo),!0)));else{let r=e.listener.id+":"+e.eventInfo.path.resolved;e.eventInfo.path.resolved||(r=e.listener.id+":"+e.eventInfo.path.listener),t.push({id:e.listener.id,resolvedPath:e.eventInfo.path.resolved,resolvedIdPath:r,originalFn:e.listener.fn,fn:()=>{e.listener.fn(a,e.eventInfo)},options:e.listener.options,groupId:e.listener.groupId})}this.debugListener(n,e)}}return Promise.resolve().then((()=>this.runQueuedListeners())),t}shouldIgnore(e,t){if(!e.options.ignore)return!1;for(const r of e.options.ignore){if(t.startsWith(r))return!0;if(this.is_match&&this.is_match(r,t))return!0;{const e=this.cutPath(t,r);if(this.match(r,e))return!0}}return!1}getSubscribedListeners(e,t,r,n="update",a=null){r=Object.assign(Object.assign({},defaultUpdateOptions),r);const s={};for(let[i,o]of this.listeners)if(o.match(e)){s[i]={single:[],bulk:[],bulkData:[]};const c=o.paramsInfo?this.getParams(o.paramsInfo,e):void 0,u=this.cutPath(e,i),l=o.isRecursive||o.isWildcard?()=>this.get(u):()=>t,d=[{value:l,path:e,params:c}];for(const t of o.listeners.values())this.shouldIgnore(t,e)?t.options.debug&&console.log("[getSubscribedListeners] Listener was not fired because it was ignored.",{listener:t,listenersCollection:o}):t.options.bulk?s[i].bulk.push({listener:t,listenersCollection:o,eventInfo:{type:n,listener:t,path:{listener:i,update:a||e,resolved:void 0},params:c,options:r},value:d}):s[i].single.push({listener:t,listenersCollection:o,eventInfo:{type:n,listener:t,path:{listener:i,update:a||e,resolved:this.cleanNotRecursivePath(e)},params:c,options:r},value:l})}else if(this.options.extraDebug){let t=!1;for(const r of o.listeners.values())r.options.debug&&(t=!0,console.log("[getSubscribedListeners] Listener was not fired because there was no match.",{listener:r,listenersCollection:o,updatePath:e}));t&&o.match(e,!0)}return s}notifySubscribedListeners(e,t,r,n="update",a=null){return this.getQueueNotifyListeners(this.getSubscribedListeners(e,t,r,n,a))}useBulkValue(e){for(const[t,r]of e.listeners){if(r.options.bulk&&r.options.bulkValue)return!0;if(!r.options.bulk)return!0}return!1}getNestedListeners(e,t,r,n="update",a=null){const s={},i={};for(let[o,c]of this.listeners){if(!c.isRecursive)continue;const u=this.cutPath(o,e);if(this.match(u,e)){s[o]={single:[],bulk:[]};const l=this.trimPath(o.substr(u.length)),d=this.useBulkValue(c);let h;d&&(h=i[l]?i[l]:new WildcardObject(t,this.options.delimiter,this.options.wildcard).get(l),i[l]=h);const p=c.paramsInfo?this.getParams(c.paramsInfo,e):void 0,f=[],g={};for(const[t,i]of c.listeners)if(d)for(const u in h){const l=()=>h[u],d=[e,u].join(this.options.delimiter),y={type:n,listener:i,listenersCollection:c,path:{listener:o,update:a||e,resolved:this.cleanNotRecursivePath(d)},params:p,options:r};this.shouldIgnore(i,e)||(i.options.bulk?(f.push({value:l,path:d,params:p}),g[t]=i):s[o].single.push({listener:i,listenersCollection:c,eventInfo:y,value:l}))}else{const u={type:n,listener:i,listenersCollection:c,path:{listener:o,update:a||e,resolved:void 0},params:p,options:r};if(this.shouldIgnore(i,e))continue;i.options.bulk?(f.push({value:void 0,path:void 0,params:p}),g[t]=i):s[o].single.push({listener:i,listenersCollection:c,eventInfo:u,value:void 0})}for(const t in g){const a=g[t],i={type:n,listener:a,listenersCollection:c,path:{listener:o,update:e,resolved:void 0},options:r,params:p};s[o].bulk.push({listener:a,listenersCollection:c,eventInfo:i,value:f})}}else if(this.options.extraDebug)for(const t of c.listeners.values())t.options.debug&&console.log("[getNestedListeners] Listener was not fired because there was no match.",{listener:t,listenersCollection:c,currentCutPath:u,updatePath:e})}return s}notifyNestedListeners(e,t,r,n="update",a,s=null){return this.getQueueNotifyListeners(this.getNestedListeners(e,t,r,n,s),a)}getNotifyOnlyListeners(e,t,r,n="update",a=null){const s={};if("object"!=typeof r.only||!Array.isArray(r.only)||void 0===r.only[0]||!this.canBeNested(t))return s;for(const i of r.only){const o=new WildcardObject(t,this.options.delimiter,this.options.wildcard).get(i);s[i]={bulk:[],single:[]};for(const t in o){const c=e+this.options.delimiter+t;for(const[u,l]of this.listeners){const d=l.paramsInfo?this.getParams(l.paramsInfo,c):void 0;if(this.match(u,c)){const h=()=>o[t],p=[{value:h,path:c,params:d}];for(const t of l.listeners.values()){const o={type:n,listener:t,listenersCollection:l,path:{listener:u,update:a||e,resolved:this.cleanNotRecursivePath(c)},params:d,options:r};this.shouldIgnore(t,e)||(t.options.bulk?s[i].bulk.some((e=>e.listener===t))||s[i].bulk.push({listener:t,listenersCollection:l,eventInfo:o,value:p}):s[i].single.push({listener:t,listenersCollection:l,eventInfo:o,value:h}))}}}}}return s}runQueue(e){const t=[];for(const r of e)r.options.group?t.includes(r.groupId)||(r.fn(),t.push(r.groupId)):r.fn()}sortAndRunQueue(e,t){e.sort((function(e,t){return e.id-t.id})),this.options.debug&&console.log(`[deep-state-observer] queue for ${t}`,e),this.runQueue(e)}notifyOnly(e,t,r,n="update",a=""){const s=this.getQueueNotifyListeners(this.getNotifyOnlyListeners(e,t,r,n,a));this.sortAndRunQueue(s,e)}canBeNested(e){return"object"==typeof e&&null!==e}getUpdateValues(e,t){let r=t;return"function"==typeof t&&(r=t(e)),{newValue:r,oldValue:e}}wildcardNotify(e,t){let r=[];for(const n of e)this.getQueueNotifyListeners(n,r);for(const n of t)this.executeWaitingListeners(n);return this.jobsRunning--,r}wildcardUpdate(e,t,r=defaultUpdateOptions,n=!1){++this.jobsRunning,r=Object.assign(Object.assign({},defaultUpdateOptions),r);const a=this.scan.get(e),s={};for(const u in a){const e=this.split(u),{oldValue:n,newValue:i}=this.getUpdateValues(a[u],t);this.same(i,n)&&!r.force||(this.pathSet(e,i,this.data),s[u]=i)}const i=[],o=[];for(const u in s){const t=s[u];r.only.length?i.push(this.getNotifyOnlyListeners(u,t,r,"update",e)):(i.push(this.getSubscribedListeners(u,t,r,"update",e)),this.canBeNested(t)&&i.push(this.getNestedListeners(u,t,r,"update",e))),r.debug&&this.options.log("Wildcard update",{path:u,newValue:t}),o.push(u)}if(n){const t=this;return function(){const r=t.wildcardNotify(i,o);t.sortAndRunQueue(r,e)}}const c=this.wildcardNotify(i,o);this.sortAndRunQueue(c,e)}runUpdateQueue(){if(!this.destroyed)for(;this.updateQueue.length&&this.updateQueue.length<this.options.maxSimultaneousJobs;){const e=this.updateQueue.shift();e.options.queue=!1,this.update(e.updatePath,e.fnOrValue,e.options,e.multi)}}updateNotify(e,t,r){const n=this.notifySubscribedListeners(e,t,r);this.canBeNested(t)&&this.notifyNestedListeners(e,t,r,"update",n),this.sortAndRunQueue(n,e),this.executeWaitingListeners(e)}updateNotifyAll(e){let t=[];for(const r of e){const e=r.newValue;if(this.tracing.length){const t=this.tracing[this.tracing.length-1],n=this.traceMap.get(t);n.changed.push({traceId:t,updatePath:r.updatePath,fnOrValue:e,options:r.options}),this.traceMap.set(t,n)}t=t.concat(this.notifySubscribedListeners(r.updatePath,e,r.options)),this.canBeNested(r.newValue)&&this.notifyNestedListeners(r.updatePath,e,r.options,"update",t)}this.runQueue(t)}updateNotifyOnly(e,t,r){this.notifyOnly(e,t,r),this.executeWaitingListeners(e)}update(e,t,r=Object.assign({},defaultUpdateOptions),n=!1){if(this.destroyed)return;if(this.collection)return this.collection.update(e,t,r);if(this.tracing.length){const n=this.tracing[this.tracing.length-1],a=this.traceMap.get(n);a.changed.push({traceId:n,updatePath:e,fnOrValue:t,options:r}),this.traceMap.set(n,a)}const a=this.jobsRunning;if((this.options.queue||r.queue)&&a){if(a>this.options.maxSimultaneousJobs)throw new Error("Maximal simultaneous jobs limit reached.");this.updateQueue.push({updatePath:e,fnOrValue:t,options:r,multi:n});const s=Promise.resolve().then((()=>{this.runUpdateQueue()}));return n?function(){return s}:s}if(this.isWildcard(e))return this.wildcardUpdate(e,t,r,n);++this.jobsRunning;const s=this.split(e),i=this.pathGet(s,this.data);let{oldValue:o,newValue:c}=this.getUpdateValues(i,t);if(r.debug&&this.options.log(`Updating ${e} ${r.source?`from ${r.source}`:""}`,{oldValue:o,newValue:c}),this.same(c,o)&&!r.force)return--this.jobsRunning,n?function(){return c}:c;if(this.pathSet(s,c,this.data),null===(r=Object.assign(Object.assign({},defaultUpdateOptions),r)).only)return--this.jobsRunning,n?function(){}:c;if(r.only.length){if(--this.jobsRunning,n){const t=this;return function(){return t.updateNotifyOnly(e,c,r)}}return this.updateNotifyOnly(e,c,r),c}if(n){--this.jobsRunning;const t=this;return function(){return t.updateNotify(e,c,r)}}return this.updateNotify(e,c,r),--this.jobsRunning,c}multi(e=!1){if(this.destroyed)return{update(){return this},done(){},getStack:()=>[]};if(this.collection)return this.collection;const t=this,r=[],n=[];return{update(a,s,i=defaultUpdateOptions){if(e){const e=t.split(a);let n=s;const o=t.pathGet(e,t.data);"function"==typeof n&&(n=n(o)),t.pathSet(e,n,t.data),r.push({updatePath:a,newValue:n,options:i})}else n.push(t.update(a,s,i,!0));return this},done(){if(0===t.collections){if(e)t.updateNotifyAll(r);else for(const e of n)e();r.length=0}},getStack:()=>r}}collect(){return this.collections++,this.collection||(this.collection=this.multi(!0)),this.collection}executeCollected(){if(this.collections--,0===this.collections&&this.collection){const e=this.collection;this.collection=null,e.done()}}getCollectedCount(){return this.collections}getCollectedStack(){return this.collection?this.collection.getStack():[]}get(e=void 0){if(!this.destroyed)return void 0===e||""===e?this.data:this.isWildcard(e)?this.scan.get(e):this.pathGet(this.split(e),this.data)}last(e){let t=this.lastExecs.get(e);t||(t={calls:0},this.lastExecs.set(e,t));const r=++t.calls;this.resolved.then((()=>{r===t.calls&&(this.lastExecs.set(e,{calls:0}),e())}))}isMuted(e){if(!this.options.useMute)return!1;if("function"==typeof e)return this.isMutedListener(e);for(const t of this.muted){const r=!this.isNotRecursive(t),n=this.trimPath(t);if(this.match(e,n))return!0;if(this.match(n,e))return!0;if(r){const r=this.cutPath(n,e);if(this.match(r,t))return!0;if(this.match(t,r))return!0}}return!1}isMutedListener(e){return this.mutedListeners.has(e)}mute(e){if("function"==typeof e)return this.mutedListeners.add(e);this.muted.add(e)}unmute(e){if("function"==typeof e)return this.mutedListeners.delete(e);this.muted.delete(e)}debugSubscribe(e,t,r){e.options.debug&&this.options.log("listener subscribed",{listenerPath:r,listener:e,listenersCollection:t})}debugListener(e,t){(t.eventInfo.options.debug||t.listener.options.debug)&&this.options.log("Listener fired",{time:Date.now()-e,info:t})}debugTime(e){return e.listener.options.debug||e.eventInfo.options.debug?Date.now():0}startTrace(e,t=null){this.traceId++;const r=this.traceId+":"+e;return this.traceMap.set(r,{id:r,sort:this.traceId,stack:this.tracing.map((e=>e)),additionalData:t,changed:[]}),this.tracing.push(r),r}stopTrace(e){const t=this.traceMap.get(e);return this.tracing.pop(),this.traceMap.delete(e),t}saveTrace(e){const t=this.traceMap.get(e);return this.tracing.pop(),this.traceMap.delete(e),this.savedTrace.push(t),t}getSavedTraces(){const e=this.savedTrace.map((e=>e));return e.sort(((e,t)=>e.sort-t.sort)),this.savedTrace=[],e}}var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),Symbol$1=root.Symbol,objectProto$f=Object.prototype,hasOwnProperty$c=objectProto$f.hasOwnProperty,nativeObjectToString$1=objectProto$f.toString,symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty$c.call(e,symToStringTag$1),r=e[symToStringTag$1];try{e[symToStringTag$1]=void 0;var n=!0}catch(s){}var a=nativeObjectToString$1.call(e);return n&&(t?e[symToStringTag$1]=r:delete e[symToStringTag$1]),a}var objectProto$e=Object.prototype,nativeObjectToString=objectProto$e.toString;function objectToString(e){return nativeObjectToString.call(e)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(e)?getRawTag(e):objectToString(e)}function isObjectLike(e){return null!=e&&"object"==typeof e}var symbolTag$2="[object Symbol]";function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&baseGetTag(e)==symbolTag$2}function arrayMap(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var isArray$1=Array.isArray,INFINITY$1=1/0,symbolProto$1=Symbol$1?Symbol$1.prototype:void 0,symbolToString=symbolProto$1?symbolProto$1.toString:void 0;function baseToString(e){if("string"==typeof e)return e;if(isArray$1(e))return arrayMap(e,baseToString)+"";if(isSymbol(e))return symbolToString?symbolToString.call(e):"";var t=e+"";return"0"==t&&1/e==-INFINITY$1?"-0":t}function isObject$1(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function identity(e){return e}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$1(e){if(!isObject$1(e))return!1;var t=baseGetTag(e);return t==funcTag$2||t==genTag$1||t==asyncTag||t==proxyTag}var coreJsData=root["__core-js_shared__"],maskSrcKey=function(){var e=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(e){if(null!=e){try{return funcToString$2.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$d=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$b=objectProto$d.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$b).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!isObject$1(e)||isMasked(e))&&(isFunction$1(e)?reIsNative:reIsHostCtor).test(toSource(e))}function getValue(e,t){return null==e?void 0:e[t]}function getNative(e,t){var r=getValue(e,t);return baseIsNative(r)?r:void 0}var WeakMap$1=getNative(root,"WeakMap"),objectCreate=Object.create,baseCreate=function(){function e(){}return function(t){if(!isObject$1(t))return{};if(objectCreate)return objectCreate(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function apply(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function noop(){}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(e){var t=0,r=0;return function(){var n=nativeNow(),a=HOT_SPAN-(n-r);if(r=n,a>0){if(++t>=HOT_COUNT)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function constant(e){return function(){return e}}var defineProperty=function(){try{var e=getNative(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),baseSetToString=defineProperty?function(e,t){return defineProperty(e,"toString",{configurable:!0,enumerable:!1,value:constant(t),writable:!0})}:identity,setToString=shortOut(baseSetToString);function arrayEach(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}function baseFindIndex(e,t,r,n){for(var a=e.length,s=r+-1;++s<a;)if(t(e[s],s,e))return s;return-1}function baseIsNaN(e){return e!=e}function strictIndexOf(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}function baseIndexOf(e,t,r){return t==t?strictIndexOf(e,t,r):baseFindIndex(e,baseIsNaN,r)}function arrayIncludes(e,t){return!!(null==e?0:e.length)&&baseIndexOf(e,t,0)>-1}var MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var r=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER$1:t)&&("number"==r||"symbol"!=r&&reIsUint.test(e))&&e>-1&&e%1==0&&e<t}function baseAssignValue(e,t,r){"__proto__"==t&&defineProperty?defineProperty(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function eq(e,t){return e===t||e!=e&&t!=t}var objectProto$c=Object.prototype,hasOwnProperty$a=objectProto$c.hasOwnProperty;function assignValue(e,t,r){var n=e[t];hasOwnProperty$a.call(e,t)&&eq(n,r)&&(void 0!==r||t in e)||baseAssignValue(e,t,r)}function copyObject(e,t,r,n){var a=!r;r||(r={});for(var s=-1,i=t.length;++s<i;){var o=t[s],c=n?n(r[o],e[o],o,r,e):void 0;void 0===c&&(c=e[o]),a?baseAssignValue(r,o,c):assignValue(r,o,c)}return r}var nativeMax=Math.max;function overRest(e,t,r){return t=nativeMax(void 0===t?e.length-1:t,0),function(){for(var n=arguments,a=-1,s=nativeMax(n.length-t,0),i=Array(s);++a<s;)i[a]=n[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=n[a];return o[t]=r(i),apply(e,this,o)}}function baseRest(e,t){return setToString(overRest(e,t,identity),e+"")}var MAX_SAFE_INTEGER=9007199254740991;function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER}function isArrayLike(e){return null!=e&&isLength(e.length)&&!isFunction$1(e)}function isIterateeCall(e,t,r){if(!isObject$1(r))return!1;var n=typeof t;return!!("number"==n?isArrayLike(r)&&isIndex(t,r.length):"string"==n&&t in r)&&eq(r[t],e)}function createAssigner(e){return baseRest((function(t,r){var n=-1,a=r.length,s=a>1?r[a-1]:void 0,i=a>2?r[2]:void 0;for(s=e.length>3&&"function"==typeof s?(a--,s):void 0,i&&isIterateeCall(r[0],r[1],i)&&(s=a<3?void 0:s,a=1),t=Object(t);++n<a;){var o=r[n];o&&e(t,o,n,s)}return t}))}var objectProto$b=Object.prototype;function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$b)}function baseTimes(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var argsTag$2="[object Arguments]";function baseIsArguments(e){return isObjectLike(e)&&baseGetTag(e)==argsTag$2}var objectProto$a=Object.prototype,hasOwnProperty$9=objectProto$a.hasOwnProperty,propertyIsEnumerable$1=objectProto$a.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike(e)&&hasOwnProperty$9.call(e,"callee")&&!propertyIsEnumerable$1.call(e,"callee")};function stubFalse(){return!1}var freeExports$2="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root.Buffer:void 0,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0,isBuffer$1=nativeIsBuffer||stubFalse,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$2="[object Boolean]",dateTag$2="[object Date]",errorTag$2="[object Error]",funcTag$1="[object Function]",mapTag$4="[object Map]",numberTag$2="[object Number]",objectTag$3="[object Object]",regexpTag$2="[object RegExp]",setTag$4="[object Set]",stringTag$2="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$3="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!typedArrayTags[baseGetTag(e)]}function baseUnary(e){return function(t){return e(t)}}typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0,typedArrayTags[argsTag$1]=typedArrayTags[arrayTag$1]=typedArrayTags[arrayBufferTag$2]=typedArrayTags[boolTag$2]=typedArrayTags[dataViewTag$3]=typedArrayTags[dateTag$2]=typedArrayTags[errorTag$2]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$4]=typedArrayTags[numberTag$2]=typedArrayTags[objectTag$3]=typedArrayTags[regexpTag$2]=typedArrayTags[setTag$4]=typedArrayTags[stringTag$2]=typedArrayTags[weakMapTag$2]=!1;var freeExports$1="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal.process,nodeUtil=function(){try{var e=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return e||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(t){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,objectProto$9=Object.prototype,hasOwnProperty$8=objectProto$9.hasOwnProperty;function arrayLikeKeys(e,t){var r=isArray$1(e),n=!r&&isArguments(e),a=!r&&!n&&isBuffer$1(e),s=!r&&!n&&!a&&isTypedArray(e),i=r||n||a||s,o=i?baseTimes(e.length,String):[],c=o.length;for(var u in e)!t&&!hasOwnProperty$8.call(e,u)||i&&("length"==u||a&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||isIndex(u,c))||o.push(u);return o}function overArg(e,t){return function(r){return e(t(r))}}var nativeKeys=overArg(Object.keys,Object),objectProto$8=Object.prototype,hasOwnProperty$7=objectProto$8.hasOwnProperty;function baseKeys(e){if(!isPrototype(e))return nativeKeys(e);var t=[];for(var r in Object(e))hasOwnProperty$7.call(e,r)&&"constructor"!=r&&t.push(r);return t}function keys(e){return isArrayLike(e)?arrayLikeKeys(e):baseKeys(e)}function nativeKeysIn(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}var objectProto$7=Object.prototype,hasOwnProperty$6=objectProto$7.hasOwnProperty;function baseKeysIn(e){if(!isObject$1(e))return nativeKeysIn(e);var t=isPrototype(e),r=[];for(var n in e)("constructor"!=n||!t&&hasOwnProperty$6.call(e,n))&&r.push(n);return r}function keysIn(e){return isArrayLike(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}var assignInWith=createAssigner((function(e,t,r,n){copyObject(t,keysIn(t),e,n)})),nativeCreate=getNative(Object,"create");function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$6=Object.prototype,hasOwnProperty$5=objectProto$6.hasOwnProperty;function hashGet(e){var t=this.__data__;if(nativeCreate){var r=t[e];return r===HASH_UNDEFINED$2?void 0:r}return hasOwnProperty$5.call(t,e)?t[e]:void 0}var objectProto$5=Object.prototype,hasOwnProperty$4=objectProto$5.hasOwnProperty;function hashHas(e){var t=this.__data__;return nativeCreate?void 0!==t[e]:hasOwnProperty$4.call(t,e)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=nativeCreate&&void 0===t?HASH_UNDEFINED$1:t,this}function Hash(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(e,t){for(var r=e.length;r--;)if(eq(e[r][0],t))return r;return-1}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet;var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,r=assocIndexOf(t,e);return!(r<0)&&(r==t.length-1?t.pop():splice.call(t,r,1),--this.size,!0)}function listCacheGet(e){var t=this.__data__,r=assocIndexOf(t,e);return r<0?void 0:t[r][1]}function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1}function listCacheSet(e,t){var r=this.__data__,n=assocIndexOf(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function ListCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet;var Map$1=getNative(root,"Map");function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$1||ListCache),string:new Hash}}function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function getMapData(e,t){var r=e.__data__;return isKeyable(t)?r["string"==typeof t?"string":"hash"]:r.map}function mapCacheDelete(e){var t=getMapData(this,e).delete(e);return this.size-=t?1:0,t}function mapCacheGet(e){return getMapData(this,e).get(e)}function mapCacheHas(e){return getMapData(this,e).has(e)}function mapCacheSet(e,t){var r=getMapData(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function MapCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function toString$1(e){return null==e?"":baseToString(e)}function arrayPush(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet;var spreadableSymbol=Symbol$1?Symbol$1.isConcatSpreadable:void 0;function isFlattenable(e){return isArray$1(e)||isArguments(e)||!!(spreadableSymbol&&e&&e[spreadableSymbol])}function baseFlatten(e,t,r,n,a){var s=-1,i=e.length;for(r||(r=isFlattenable),a||(a=[]);++s<i;){var o=e[s];r(o)&&arrayPush(a,o)}return a}var getPrototype=overArg(Object.getPrototypeOf,Object),objectTag$2="[object Object]",funcProto=Function.prototype,objectProto$4=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$3=objectProto$4.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject$1(e){if(!isObjectLike(e)||baseGetTag(e)!=objectTag$2)return!1;var t=getPrototype(e);if(null===t)return!0;var r=hasOwnProperty$3.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&funcToString.call(r)==objectCtorString}var domExcTag="[object DOMException]",errorTag$1="[object Error]";function isError(e){if(!isObjectLike(e))return!1;var t=baseGetTag(e);return t==errorTag$1||t==domExcTag||"string"==typeof e.message&&"string"==typeof e.name&&!isPlainObject$1(e)}var attempt=baseRest((function(e,t){try{return apply(e,void 0,t)}catch(r){return isError(r)?r:new Error(r)}}));function basePropertyOf(e){return function(t){return null==e?void 0:e[t]}}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function stackGet(e){return this.__data__.get(e)}function stackHas(e){return this.__data__.has(e)}var LARGE_ARRAY_SIZE$1=200;function stackSet(e,t){var r=this.__data__;if(r instanceof ListCache){var n=r.__data__;if(!Map$1||n.length<LARGE_ARRAY_SIZE$1-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new MapCache(n)}return r.set(e,t),this.size=r.size,this}function Stack(e){var t=this.__data__=new ListCache(e);this.size=t.size}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root.Buffer:void 0;function cloneBuffer(e,t){return e.slice()}function arrayFilter(e,t){for(var r=-1,n=null==e?0:e.length,a=0,s=[];++r<n;){var i=e[r];t(i,r,e)&&(s[a++]=i)}return s}function stubArray(){return[]}Buffer&&Buffer.allocUnsafe;var objectProto$3=Object.prototype,propertyIsEnumerable=objectProto$3.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(e){return null==e?[]:(e=Object(e),arrayFilter(nativeGetSymbols$1(e),(function(t){return propertyIsEnumerable.call(e,t)})))}:stubArray;function baseGetAllKeys(e,t,r){var n=t(e);return isArray$1(e)?n:arrayPush(n,r(e))}function getAllKeys(e){return baseGetAllKeys(e,keys,getSymbols)}var DataView=getNative(root,"DataView"),Promise$1=getNative(root,"Promise"),Set$1=getNative(root,"Set"),mapTag$3="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$3="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$2="[object DataView]",dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set$1),weakMapCtorString=toSource(WeakMap$1),getTag=baseGetTag;(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag$2||Map$1&&getTag(new Map$1)!=mapTag$3||Promise$1&&getTag(Promise$1.resolve())!=promiseTag||Set$1&&getTag(new Set$1)!=setTag$3||WeakMap$1&&getTag(new WeakMap$1)!=weakMapTag$1)&&(getTag=function(e){var t=baseGetTag(e),r=t==objectTag$1?e.constructor:void 0,n=r?toSource(r):"";if(n)switch(n){case dataViewCtorString:return dataViewTag$2;case mapCtorString:return mapTag$3;case promiseCtorString:return promiseTag;case setCtorString:return setTag$3;case weakMapCtorString:return weakMapTag$1}return t});var objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty;function initCloneArray(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&hasOwnProperty$2.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var Uint8Array$1=root.Uint8Array;function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new Uint8Array$1(t).set(new Uint8Array$1(e)),t}function cloneDataView(e,t){var r=cloneArrayBuffer(e.buffer);return new e.constructor(r,e.byteOffset,e.byteLength)}var reFlags=/\w*$/;function cloneRegExp(e){var t=new e.constructor(e.source,reFlags.exec(e));return t.lastIndex=e.lastIndex,t}var symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function cloneSymbol(e){return symbolValueOf?Object(symbolValueOf.call(e)):{}}function cloneTypedArray(e,t){var r=cloneArrayBuffer(e.buffer);return new e.constructor(r,e.byteOffset,e.length)}var boolTag$1="[object Boolean]",dateTag$1="[object Date]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(e,t,r){var n=e.constructor;switch(t){case arrayBufferTag$1:return cloneArrayBuffer(e);case boolTag$1:case dateTag$1:return new n(+e);case dataViewTag$1:return cloneDataView(e);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(e);case mapTag$2:return new n;case numberTag$1:case stringTag$1:return new n(e);case regexpTag$1:return cloneRegExp(e);case setTag$2:return new n;case symbolTag$1:return cloneSymbol(e)}}function initCloneObject(e){return"function"!=typeof e.constructor||isPrototype(e)?{}:baseCreate(getPrototype(e))}var mapTag$1="[object Map]";function baseIsMap(e){return isObjectLike(e)&&getTag(e)==mapTag$1}var nodeIsMap=nodeUtil&&nodeUtil.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap,setTag$1="[object Set]";function baseIsSet(e){return isObjectLike(e)&&getTag(e)==setTag$1}var nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};function baseClone(e,t,r,n,a,s){var i;if(void 0!==i)return i;if(!isObject$1(e))return e;var o=isArray$1(e);if(o)i=initCloneArray(e);else{var c=getTag(e),u=c==funcTag||c==genTag;if(isBuffer$1(e))return cloneBuffer(e);if(c==objectTag||c==argsTag||u&&!a)i=u?{}:initCloneObject(e);else{if(!cloneableTags[c])return a?e:{};i=initCloneByTag(e,c)}}s||(s=new Stack);var l=s.get(e);if(l)return l;s.set(e,i),isSet(e)?e.forEach((function(n){i.add(baseClone(n,t,r,n,e,s))})):isMap(e)&&e.forEach((function(n,a){i.set(a,baseClone(n,t,r,a,e,s))}));var d=o?void 0:getAllKeys(e);return arrayEach(d||e,(function(n,a){d&&(n=e[a=n]),assignValue(i,a,baseClone(n,t,r,a,e,s))})),i}cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[dataViewTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[setTag]=cloneableTags[stringTag]=cloneableTags[symbolTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;var CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeep(e){return baseClone(e,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG)}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED),this}function setCacheHas(e){return this.__data__.has(e)}function SetCache(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new MapCache;++t<r;)this.add(e[t])}function cacheHas(e,t){return e.has(t)}function setToArray(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}function isArrayLikeObject(e){return isObjectLike(e)&&isArrayLike(e)}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas;var htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},escapeHtmlChar=basePropertyOf(htmlEscapes),reUnescapedHtml=/[&<>"']/g,reHasUnescapedHtml=RegExp(reUnescapedHtml.source);function escape(e){return(e=toString$1(e))&&reHasUnescapedHtml.test(e)?e.replace(reUnescapedHtml,escapeHtmlChar):e}function baseValues(e,t){return arrayMap(t,(function(t){return e[t]}))}var objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty;function customDefaultsAssignIn(e,t,r,n){return void 0===e||eq(e,objectProto$1[r])&&!hasOwnProperty$1.call(n,r)?t:e}var stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function escapeStringChar(e){return"\\"+stringEscapes[e]}var reInterpolate=/<%=([\s\S]+?)%>/g,reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,templateSettings={escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:{escape:escape}}},INVALID_TEMPL_VAR_ERROR_TEXT="Invalid `variable` option passed into `_.template`",reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reForbiddenIdentifierChars=/[()=,{}\[\]\/\s]/,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reNoMatch=/($^)/,reUnescapedString=/['\n\r\u2028\u2029\\]/g,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;function template(e,t,r){var n=templateSettings.imports._.templateSettings||templateSettings;e=toString$1(e),t=assignInWith({},t,n,customDefaultsAssignIn);var a,s,i=assignInWith({},t.imports,n.imports,customDefaultsAssignIn),o=keys(i),c=baseValues(i,o),u=0,l=t.interpolate||reNoMatch,d="__p += '",h=RegExp((t.escape||reNoMatch).source+"|"+l.source+"|"+(l===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(t.evaluate||reNoMatch).source+"|$","g"),p=hasOwnProperty.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(h,(function(t,r,n,i,o,c){return n||(n=i),d+=e.slice(u,c).replace(reUnescapedString,escapeStringChar),r&&(a=!0,d+="' +\n__e("+r+") +\n'"),o&&(s=!0,d+="';\n"+o+";\n__p += '"),n&&(d+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),d+="';\n";var f=hasOwnProperty.call(t,"variable")&&t.variable;if(f){if(reForbiddenIdentifierChars.test(f))throw new Error(INVALID_TEMPL_VAR_ERROR_TEXT)}else d="with (obj) {\n"+d+"\n}\n";d=(s?d.replace(reEmptyStringLeading,""):d).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),d="function("+(f||"obj")+") {\n"+(f?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=attempt((function(){return Function(o,p+"return "+d).apply(void 0,c)}));if(g.source=d,isError(g))throw g;return g}var INFINITY=1/0,createSet=Set$1&&1/setToArray(new Set$1([,-0]))[1]==INFINITY?function(e){return new Set$1(e)}:noop,LARGE_ARRAY_SIZE=200;function baseUniq(e,t,r){var n=-1,a=arrayIncludes,s=e.length,i=!0,o=[],c=o;if(s>=LARGE_ARRAY_SIZE){var u=createSet(e);if(u)return setToArray(u);i=!1,a=cacheHas,c=new SetCache}else c=o;e:for(;++n<s;){var l=e[n],d=l;if(l=0!==l?l:0,i&&d==d){for(var h=c.length;h--;)if(c[h]===d)continue e;o.push(l)}else a(c,d,r)||(c!==o&&c.push(d),o.push(l))}return o}var union=baseRest((function(e){return baseUniq(baseFlatten(e,1,isArrayLikeObject))}));class ObservedData{}class SimpleObservedData extends ObservedData{data={};event=(()=>new eventsExports.EventEmitter)();constructor(e){super(),this.data=e}update(e,t){t?setValueByKeyPath(t,e,this.data):this.data=e;const r={updateData:e,path:t??""};t&&this.event.emit(t,r),this.event.emit("",r)}on(e,t){this.event.on(e,t)}off(e,t){this.event.off(e,t)}getData(e){return e?getValueByKeyPath(e,this.data):this.data}destroy(){}}class DataSource extends EventEmitter$1{isInit=!1;app;mockData;#e="base";#t;#r;#n;#a=[];#s=[];constructor(e){super(),this.#t=e.schema.id,this.#r=e.schema,this.app=e.app,this.setFields(e.schema.fields),this.setMethods(e.schema.methods||[]);let t=e.initialData;const r=e.ObservedDataClass||SimpleObservedData;if("editor"===this.app.platform)this.mockData=e.schema.mocks?.find((e=>e.useInEditor))?.data||this.getDefaultData(),t=this.mockData;else if("boolean"==typeof e.useMock&&e.useMock)this.mockData=e.schema.mocks?.find((e=>e.enable))?.data||this.getDefaultData(),t=this.mockData;else{if(e.initialData)return this.#n=new r(e.initialData??{}),void(this.isInit=!0);t=this.getDefaultData()}this.#n=new r(t??{})}get id(){return this.#t}get type(){return this.#e}get schema(){return this.#r}get fields(){return this.#a}get methods(){return this.#s}setFields(e){this.#a=e}setMethods(e){this.#s=e}get data(){return this.#n.getData("")}setData(e,t){this.#n.update(e,t);const r={updateData:e,path:t};this.emit("change",r)}setValue(e,t){return this.setData(t,e)}onDataChange(e,t){this.#n.on(e,t)}offDataChange(e,t){this.#n.off(e,t)}getDefaultData(){return getDefaultValueFromFields(this.#a)}async init(){this.isInit=!0}destroy(){this.#a=[],this.removeAllListeners(),this.#n.destroy()}}const urlencoded=e=>Object.entries(e).reduce(((e,[t,r])=>{let n=r;return"object"==typeof r&&(n=JSON.stringify(r)),void 0!==r?`${e}${e?"&":""}${globalThis.encodeURIComponent(t)}=${globalThis.encodeURIComponent(`${n}`)}`:e}),""),webRequest=async e=>{const{url:t,method:r="GET",headers:n={},params:a={},data:s={},...i}=e,o=urlencoded(a);let c=JSON.stringify(s);n["Content-Type"]?.includes("application/x-www-form-urlencoded")&&(c=urlencoded(s));return(await globalThis.fetch(o?`${t}?${o}`:t,{method:r,headers:n,body:"GET"===r?void 0:c,...i})).json()};class HttpDataSource extends DataSource{isLoading=!1;error;httpOptions;#i;#o=[];#c=[];#e="http";constructor(e){const{options:t}=e.schema;super(e),this.httpOptions=t,"function"==typeof e.request?this.#i=e.request:"function"==typeof globalThis.fetch&&(this.#i=webRequest),this.methods.forEach((e=>{"function"==typeof e.content&&("beforeRequest"===e.timing&&this.#o.push(e.content),"afterRequest"===e.timing&&this.#c.push(e.content))}))}get type(){return this.#e}async init(){this.schema.autoFetch&&await this.request(this.httpOptions),super.init()}async request(e={}){this.isLoading=!0;let t={...this.httpOptions,...e};try{for(const r of this.#o)await r({options:t,params:{},dataSource:this,app:this.app});"function"==typeof this.schema.beforeRequest&&(t=this.schema.beforeRequest(t,{app:this.app,dataSource:this}));let e=this.mockData?this.mockData:await(this.#i?.(t));for(const r of this.#c)await r({res:e,options:t,params:{},dataSource:this,app:this.app});if("function"==typeof this.schema.afterResponse&&(e=this.schema.afterResponse(e,{app:this.app,dataSource:this,options:t})),this.schema.responseOptions?.dataPath){const t=getValueByKeyPath(this.schema.responseOptions.dataPath,e);this.setData(t)}else this.setData(e);this.error=void 0}catch(r){this.error={msg:r.message},this.emit("error",r)}this.isLoading=!1}get(e){return this.request({...e,method:"GET"})}post(e){return this.request({...e,method:"POST"})}}const compiledCondition=(e,t)=>{let r=!0;for(const{op:n,value:a,range:s,field:i}of e){const[e,...o]=i,c=t[e];if(!c||!o.length)break;const u=getValueByKeyPath(o.join("."),c);if(!compiledCond(n,u,a,s)){r=!1;break}}return r},compliedConditions=(e,t)=>{if(!e.displayConds||!Array.isArray(e.displayConds)||!e.displayConds.length)return!0;for(const{cond:r}of e.displayConds)if(r&&compiledCondition(r,t))return!0;return!1},compliedIteratorItemConditions=(e=[],t)=>{if(!e||!Array.isArray(e)||!e.length)return!0;for(const{cond:r}of e){if(!r)continue;let e=!0;for(const{op:n,value:a,range:s,field:i}of r){const r=getValueByKeyPath(i.join("."),t);if(!compiledCond(n,r,a,s)){e=!1;break}}if(e)return e}return!1},updateNode=(e,t)=>{if(isPage(e)||isPageFragment(e)){const r=t.items?.findIndex((t=>t.id===e.id));t.items.splice(r,1,e)}else replaceChildNode(e,t.items)},createIteratorContentData=(e,t,r=[],n={})=>{const a={...n,[t]:{}};return r.reduce(((t,n,a)=>(t[n]=a===r.length-1?e:{},t[n])),a[t]),a},compliedDataSourceField=(e,t)=>{const[r,...n]=e,a=r.indexOf(DATA_SOURCE_FIELDS_SELECT_VALUE_PREFIX);if(a>-1){const s=t[r.substring(a+DATA_SOURCE_FIELDS_SELECT_VALUE_PREFIX.length)];return s?getValueByKeyPath(n.join("."),s):e}return e},compiledNodeField=(e,t)=>"string"==typeof e?template(e)(t):e?.isBindDataSource&&e.dataSourceId?t[e.dataSourceId]:e?.isBindDataSourceField&&e.dataSourceId&&"string"==typeof e.template?template(e.template)(t[e.dataSourceId]):Array.isArray(e)&&"string"==typeof e[0]?compliedDataSourceField(e,t):e,compliedIteratorItems=(e,t,r,n=[],a,s=!1)=>{const i=new Watcher;i.addTarget(new Target({id:r,type:"data-source",isTarget:(e,t)=>!`${e}`.startsWith(DSL_NODE_KEY_COPY_PREFIX)&&(isDataSourceTemplate(t,r)||isUseDataSourceField(t,r))})),i.addTarget(new Target({id:r,type:"cond",isTarget:(e,t)=>!(!Array.isArray(t)||t[0]!==r||!`${e}`.startsWith("displayConds"))})),i.collect(t,{},!0);const{deps:o}=i.getTarget(r,"data-source"),{deps:c}=i.getTarget(r,"cond");return Object.keys(o).length||Object.keys(c).length?t.map((t=>compliedIteratorItem({itemData:e,data:a,dsId:r,keys:n,inEditor:s,condDeps:c,item:t,deps:o}))):t},compliedIteratorItem=({itemData:e,data:t,dsId:r,keys:n,inEditor:a,condDeps:s,item:i,deps:o})=>{const{items:c,...u}=i,l=cloneDeep(u);c&&!i.iteratorData&&(l.items=Array.isArray(c)?c.map((i=>compliedIteratorItem({itemData:e,data:t,dsId:r,keys:n,inEditor:a,condDeps:s,item:i,deps:o}))):c),Array.isArray(c)&&c.length?i.iteratorData?l.items=c:l.items=c.map((i=>compliedIteratorItem({itemData:e,data:t,dsId:r,keys:n,inEditor:a,condDeps:s,item:i,deps:o}))):l.items=c;const d=createIteratorContentData(e,r,n,t);return s[l.id]?.keys.length&&!a&&(l.condResult=compliedConditions(l,d)),o[l.id]?.keys.length?compiledNode((e=>compiledNodeField(e,d)),l,{[r]:o},r):l},registerDataSourceOnDemand=async(e,t)=>{const{dataSourceMethodsDeps:r={},dataSourceCondDeps:n={},dataSourceDeps:a={},dataSources:s=[]}=e,i={};s.forEach((e=>{let s=n[e.id]||{};Object.keys(s).length||(s=a[e.id]||{}),Object.keys(s).length||(s=r[e.id]||{}),Object.keys(s).length&&t[e.type]&&(i[e.type]=t[e.type])}));const o=await Promise.all(Object.values(i).map((e=>e()))),c={};return o.forEach(((e,t)=>{const r=Object.keys(i)[t];c[r]=e.default})),c};class DataSourceManager extends EventEmitter$1{static dataSourceClassMap=(()=>new Map)();static ObservedDataClass=(()=>SimpleObservedData)();static register(e,t){DataSourceManager.dataSourceClassMap.set(e,t)}static registe(e,t){DataSourceManager.register(e,t)}static getDataSourceClass(e){return DataSourceManager.dataSourceClassMap.get(e)}static registerObservedData(e){DataSourceManager.ObservedDataClass=e}app;dataSourceMap=(()=>new Map)();data={};useMock=!1;constructor({app:e,useMock:t,initialData:r}){super(),this.app=e,this.useMock=t,r&&(this.data=r),e.dsl?.dataSources?.forEach((e=>{this.addDataSource(e)}));const n=Array.from(this.dataSourceMap);"function"==typeof Promise.allSettled?Promise.allSettled(n.map((([,e])=>this.init(e)))).then((e=>{const t={},r={};e.forEach(((e,a)=>{const s=n[a][0];"fulfilled"===e.status?t[s]=this.data[s]:"rejected"===e.status&&(r[s]=e.reason)})),this.emit("init",t,r)})):Promise.all(n.map((([,e])=>this.init(e)))).then((()=>{this.emit("init",this.data)})).catch((()=>{this.emit("init",this.data)}))}async init(e){if(e.isInit)return;if(this.app.jsEngine&&e.schema.disabledInitInJsEngine?.includes(this.app.jsEngine))return;const t=[],r=[];e.methods.forEach((e=>{"function"==typeof e.content&&("beforeInit"===e.timing&&t.push(e.content),"afterInit"===e.timing&&r.push(e.content))}));for(const n of t)await n({params:{},dataSource:e,app:this.app});await e.init();for(const n of r)await n({params:{},dataSource:e,app:this.app})}get(e){return this.dataSourceMap.get(e)}async addDataSource(e){if(!e)return;const t=new(DataSourceManager.dataSourceClassMap.get(e.type)||DataSource)({app:this.app,schema:e,request:this.app.request,useMock:this.useMock,initialData:this.data[e.id],ObservedDataClass:DataSourceManager.ObservedDataClass});this.dataSourceMap.set(e.id,t),this.data[t.id]=t.data,t.on("change",(e=>{this.setData(t,e)}))}setData(e,t){this.data[e.id]=e.data,this.emit("change",e.id,t)}removeDataSource(e){this.get(e)?.destroy(),delete this.data[e],this.dataSourceMap.delete(e)}updateSchema(e){e.forEach((e=>{if(!this.get(e.id))return;this.removeDataSource(e.id),this.addDataSource(e);const t=this.get(e.id);t&&this.init(t)}))}compiledNode({items:e,...t},r,n=!1){const a=cloneDeep(t);return e&&(a.items=Array.isArray(e)&&n?e.map((e=>this.compiledNode(e,r,n))):e),!1===t.condResult||!1===t.visible?a:compiledNode((e=>compiledNodeField(e,this.data)),a,this.app.dsl?.dataSourceDeps||{},r)}compliedConds(e){return compliedConditions(e,this.data)}compliedIteratorItemConds(e,t=[]){return compliedIteratorItemConditions(t,e)}compliedIteratorItems(e,t,r=[]){const[n,...a]=r;return this.get(n)?compliedIteratorItems(e,t,n,a,this.data,"editor"===this.app.platform):t}destroy(){this.removeAllListeners(),this.data={},this.dataSourceMap.forEach((e=>{e.destroy()})),this.dataSourceMap.clear()}onDataChange(e,t,r){return this.get(e)?.onDataChange(t,r)}offDataChange(e,t,r){return this.get(e)?.offDataChange(t,r)}}DataSourceManager.register("http",HttpDataSource);const createDataSourceManager=(e,t,r)=>{const{dsl:n,platform:a}=e;if(!n?.dataSources)return;const s=new DataSourceManager({app:e,useMock:t,initialData:r});return n.dataSources&&n.dataSourceCondDeps&&"editor"!==a&&getNodes(getDepNodeIds(n.dataSourceCondDeps),n.items).forEach((e=>{e.condResult=s.compliedConds(e),updateNode(e,n)})),n.dataSources&&n.dataSourceDeps&&getNodes(getDepNodeIds(n.dataSourceDeps),n.items).forEach((e=>{updateNode(s.compiledNode(e),n)})),"nodejs"!==e.jsEngine&&s.on("change",((t,r)=>{const a=n.dataSourceDeps?.[t]||{},i=n.dataSourceCondDeps?.[t]||{},o=union([...Object.keys(i),...Object.keys(a)]),c=e.page?.data&&"editor"!==e.platform?[e.page.data]:n.items;s.emit("update-data",getNodes(o,c).map((t=>{"editor"!==e.platform&&(t.condResult=s.compliedConds(t));const r=s.compiledNode(t);if("function"==typeof e.page?.setData)if(isPage(r))e.page.setData(r);else{const n=e.page.getNode(t.id);n?.setData(r)}return r})),t,r)})),s},ignoreFirstCall=e=>{let t=0;return(...r)=>{if(0!==t)return e(...r);t+=1}};class DeepObservedData extends ObservedData{state;subscribers=(()=>new Map)();constructor(e){super(),this.state=new DeepState(e)}update=(e,t)=>{this.state?.update(t??"",e)};on=(e,t)=>{const r=this.state.subscribe(e,ignoreFirstCall(t)),n=this.subscribers.get(e)??new Map;n.set(t,r),this.subscribers.set(e,n)};off=(e,t)=>{const r=this.subscribers.get(e);r&&(r.get(t)?.(),r.delete(t))};getData=e=>this.state?this.state?.get(e):{};destroy=()=>{this.subscribers.forEach((e=>{e.forEach((e=>e()))}))}}class Env{isIos=!1;isIphone=!1;isIpad=!1;isAndroid=!1;isAndroidPad=!1;isMac=!1;isWin=!1;isMqq=!1;isWechat=!1;isWeb=!1;isOpenHarmony=!1;constructor(e=globalThis.navigator.userAgent,t={}){this.isIphone=e.indexOf("iPhone")>=0,this.isIpad=/(iPad).*OS\s([\d_]+)/.test(e),this.isIos=this.isIphone||this.isIpad,this.isAndroid=e.indexOf("Android")>=0,this.isAndroidPad=this.isAndroid&&e.indexOf("Mobile")<0,this.isMac=e.indexOf("Macintosh")>=0,this.isWin=e.indexOf("Windows")>=0,this.isMqq=/QQ\/([\d.]+)/.test(e),this.isWechat=e.indexOf("MicroMessenger")>=0&&e.indexOf("wxwork")<0,this.isOpenHarmony=e.includes("OpenHarmony"),this.isWeb=!(this.isIos||this.isAndroid||this.isOpenHarmony||/(WebOS|BlackBerry)/.test(e)),Object.entries(t).forEach((([e,t])=>{this[e]=t}))}}const COMMON_EVENT_PREFIX="magic:common:events:",COMMON_METHOD_PREFIX="magic:common:actions:",CommonMethod={SHOW:"show",HIDE:"hide",SCROLL_TO_VIEW:"scrollIntoView",SCROLL_TO_TOP:"scrollToTop"},getCommonEventName=e=>e.startsWith(COMMON_EVENT_PREFIX)?e:`${COMMON_EVENT_PREFIX}${e}`,isCommonMethod=e=>e.startsWith(COMMON_METHOD_PREFIX),getDirectComponent=(e,t)=>{if(!e)return!1;if(!e.id)return getDirectComponent(e.parentElement,t);const r=t.page?.getNode(e.id);return r||!1},commonClickEventHandler=(e,t,r)=>{const n=getDirectComponent(r.target,e);n&&e.emit(getCommonEventName(t),n)},bindCommonEventListener=e=>{"browser"===e.jsEngine&&(window.document.body.addEventListener("click",(t=>{commonClickEventHandler(e,"click",t)})),window.document.body.addEventListener("click",(t=>{commonClickEventHandler(e,"click:capture",t)}),!0))},triggerCommonMethod=(e,t)=>{const{instance:r}=t;if(r)switch(e.replace(COMMON_METHOD_PREFIX,"")){case CommonMethod.SHOW:r.show();break;case CommonMethod.HIDE:r.hide();break;case CommonMethod.SCROLL_TO_VIEW:r.$el?.scrollIntoView({behavior:"smooth"});break;case CommonMethod.SCROLL_TO_TOP:window.scrollTo({top:0,behavior:"smooth"})}};class Flexible{designWidth=375;tid;constructor(e){"complete"===globalThis.document.readyState?this.setBodyFontSize():globalThis.document.addEventListener("DOMContentLoaded",this.setBodyFontSize,!1),globalThis.addEventListener("resize",this.resizeHandler,!1),globalThis.addEventListener("pageshow",this.pageshowHandler,!1),void 0!==e?.designWidth&&this.setDesignWidth(e.designWidth)}destroy(){globalThis.document.removeEventListener("DOMContentLoaded",this.setBodyFontSize,!1),globalThis.removeEventListener("resize",this.resizeHandler,!1),globalThis.removeEventListener("pageshow",this.pageshowHandler,!1)}setDesignWidth(e){this.designWidth=e,this.refreshRem()}setBodyFontSize(){globalThis.document.body.style.fontSize=".12rem"}refreshRem(){const{width:e}=document.documentElement.getBoundingClientRect(),t=e/(this.designWidth/100);globalThis.document.documentElement.style.fontSize=`${t}px`,globalThis.document.documentElement.style.fontSize=`${this.correctRem(t)}px`}correctRem(e){const{document:t}=globalThis,r=t.createElement("div");r.style.cssText="width:1rem;height:0;overflow:hidden;position:absolute;z-index:-1;visibility:hidden;",t.documentElement.appendChild(r);const n=r.offsetWidth;return t.documentElement.removeChild(r),Math.abs(n-e)>1?e**2/n:e}resizeHandler=()=>{clearTimeout(this.tid),this.tid=setTimeout((()=>{this.refreshRem()}),300)};pageshowHandler=e=>{e.persisted&&this.resizeHandler()}}class Store{data={};set(e,t){this.data[e]=t}get(e){return this.data[e]}}class Node extends eventsExports.EventEmitter{data;style;events=[];instance;page;parent;app;store=(()=>new Store)();constructor(e){super(),this.page=e.page,this.parent=e.parent,this.app=e.app,this.setData(e.config),this.listenLifeSafe()}setData(e){this.data=e;const{events:t,style:r}=e;this.events=t||[],this.style=r||{},this.emit("update-data")}destroy(){this.removeAllListeners()}listenLifeSafe(){this.once("created",(async e=>{this.once("destroy",(()=>{this.instance=null,"function"==typeof this.data.destroy&&this.data.destroy(this),this.listenLifeSafe()})),this.instance=e,await this.runHookCode("created")})),this.once("mounted",(async e=>{this.instance=e;const t=this.app.eventQueueMap[e.config.id]||[];for(let r=t.shift();r;r=t.shift())this.app.compActionHandler(r.eventConfig,r.fromCpt,r.args);await this.runHookCode("mounted")}))}async runHookCode(e){if("function"==typeof this.data[e])return void(await this.data[e](this));const r=this.data[e];if(r?.hookType===O.CODE)for(const n of r.hookData){const{codeType:e=t.CODE,codeId:r,params:a={}}=n;let s;const i={app:this.app,params:a};if(e===t.CODE&&"string"==typeof r&&this.app.codeDsl?.[r])s=this.app.codeDsl[r].content;else if(e===t.DATA_SOURCE_METHOD&&Array.isArray(r)&&r.length>1){const e=this.app.dataSourceManager?.get(r[0]);s=e?.methods.find((e=>e.name===r[1]))?.content,i.dataSource=e}s&&"function"==typeof s&&await s(i)}}}class Page extends Node{nodes=(()=>new Map)();constructor(e){super(e),this.setNode(e.config.id,this),e.config.items.forEach((e=>{this.initNode(e,this)}))}initNode(e,t){const r=new Node({config:e,parent:t,page:this,app:this.app});if(this.setNode(e.id,r),"page-fragment-container"===e.type&&e.pageFragmentId){const t=this.app.dsl?.items?.find((t=>t.id===e.pageFragmentId));t&&(e.items=[t])}e.items?.forEach((e=>{this.initNode(e,r)}))}getNode(e){return this.nodes.get(e)}setNode(e,t){this.nodes.set(e,t)}deleteNode(e){this.nodes.delete(e)}destroy(){super.destroy(),this.nodes.clear()}}const style2Obj=e=>{if("string"!=typeof e)return e;const t={};return e.split(";").forEach((e=>{if(!e)return;const r=e.split(":");let n=r.shift(),a=r.join(":");n&&(n=n.replace(/^\s*/,"").replace(/\s*$/,""),a=a.replace(/^\s*/,"").replace(/\s*$/,""),n=n.split("-").map(((e,t)=>t>0?`${e[0].toUpperCase()}${e.substr(1)}`:e)).join(""),t[n]=a)})),t},fillBackgroundImage=e=>!e||/^url/.test(e)||/^linear-gradient/.test(e)?e:`url(${e})`,isNumber$1=e=>/^(-?\d+)(\.\d+)?$/.test(e),getTransform=(e,t)=>{if(!e)return[];const r=Object.entries(e).map((([e,r])=>r.trim()?("rotate"===e&&isNumber$1(r)&&(r=`${r}deg`),"hippy"!==t?`${e}(${r})`:{[e]:r}):""));if("hippy"===t)return r;const n=r.join(" ");return n.trim()?n:"none"},transformStyle=(e,t)=>{if(!e)return{};let r={};const n={};r="string"==typeof e?style2Obj(e):{...e};const a="hippy"===t,s=["zIndex","opacity","fontWeight"];return Object.entries(r).forEach((([e,r])=>{"scale"===e&&!n.transform&&a?n.transform=[{scale:r}]:"backgroundImage"!==e||a?"transform"===e&&"string"!=typeof r?n[e]=getTransform(r,t):!s.includes(e)&&r&&/^[-]?[0-9]*[.]?[0-9]*$/.test(r)?n[e]=a?r:r/100+"rem":n[e]=r:r&&(n[e]=fillBackgroundImage(r))})),n};class App extends eventsExports.EventEmitter{env=(()=>new Env)();dsl;codeDsl;dataSourceManager;page;useMock=!1;platform="mobile";jsEngine="browser";request;components=(()=>new Map)();eventQueueMap={};transformStyle;flexible;eventList=(()=>new Map)();dataSourceEventList=(()=>new Map)();constructor(e){super(),this.setEnv(e.ua),this.codeDsl=e.config?.codeBlocks,e.platform&&(this.platform=e.platform),e.jsEngine&&(this.jsEngine=e.jsEngine),"boolean"==typeof e.useMock&&(this.useMock=e.useMock),"browser"===this.jsEngine&&(this.flexible=new Flexible({designWidth:e.designWidth})),this.transformStyle=e.transformStyle||(e=>transformStyle(e,this.jsEngine)),e.request&&(this.request=e.request),e.config&&this.setConfig(e.config,e.curPage),bindCommonEventListener(this)}setEnv(e){this.env=new Env(e)}setDesignWidth(e){this.flexible?.setDesignWidth(e)}setConfig(e,t){this.dsl=e,!t&&e.items.length&&(t=e.items[0].id),this.dataSourceManager&&this.dataSourceManager.destroy(),this.dataSourceManager=createDataSourceManager(this,this.useMock),this.codeDsl=e.codeBlocks,this.setPage(t||this.page?.data?.id)}addPage(){console.info("addPage 已经弃用")}setPage(e){const t=this.dsl?.items.find((t=>`${t.id}`==`${e}`));if(!t)return this.page&&(this.page.destroy(),this.page=void 0),void super.emit("page-change");t!==this.page?.data&&(this.page&&this.page.destroy(),this.page=new Page({config:t,app:this}),super.emit("page-change",this.page),this.bindEvents())}deletePage(){this.page=void 0}getPage(e){return e?this.page&&`${this.page.data.id}`==`${e}`?this.page:void 0:this.page}registerComponent(e,t){this.components.set(e,t)}unregisterComponent(e){this.components.delete(e)}resolveComponent(e){return this.components.get(e)}bindEvents(){if(Array.from(this.eventList.keys()).forEach((e=>{const t=this.eventList.get(e);t&&this.off(t,e)})),this.eventList.clear(),this.page){for(const[,e]of this.page.nodes)e.events?.forEach(((t,r)=>{let n=`${t.name}_${e.data.id}`,a=(e,...t)=>{this.eventHandler(r,e,t)};const s=t.name.split(".");s.length>1&&(n=`${s[1]}_${s[0]}`,a=(t,...n)=>{this.eventHandler(r,e,n)}),this.eventList.set(a,n),this.on(n,a)}));this.bindDataSourceEvents()}}emit(e,...t){const[r,...n]=t;return r instanceof Node&&r?.data?.id?super.emit(`${String(e)}_${r.data.id}`,r,...n):super.emit(e,...t)}async codeActionHandler(e,t){const{codeId:r="",params:n={}}=e;if(!r||isEmpty(this.codeDsl))return;const a=this.codeDsl?.[r]?.content;"function"==typeof a&&await a({app:this,params:n,eventParams:t})}async compActionHandler(e,t,r){if(!this.page)throw new Error("当前没有页面");let{method:n,to:a}=e;isArray$2(n)&&([a,n]=n);const s=this.page.getNode(a);if(!s)throw`ID为${a}的组件不存在`;if(isCommonMethod(n))return triggerCommonMethod(n,s);s.instance?"function"==typeof s.instance[n]&&await s.instance[n](t,...r):this.addEventToMap({eventConfig:e,fromCpt:t,args:r})}async dataSourceActionHandler(e,t){const{dataSourceMethod:r=[],params:n={}}=e,[a,s]=r;if(!a||!s)return;const i=this.dataSourceManager?.get(a);if(!i)return;const o=(i.methods||[]).find((e=>e.name===s));o&&"function"==typeof o.content&&await o.content({app:this,params:n,dataSource:i,eventParams:t})}destroy(){this.removeAllListeners(),this.page=void 0,this.flexible?.destroy(),this.flexible=void 0}bindDataSourceEvents(){"editor"!==this.platform&&(Array.from(this.dataSourceEventList.keys()).forEach((e=>{const t=this.dataSourceEventList.get(e);Array.from(t.keys()).forEach((r=>{const[n,...a]=r.split(".");n===DATA_SOURCE_FIELDS_CHANGE_EVENT_PREFIX?this.dataSourceManager?.offDataChange(e,a.join("."),t.get(r)):this.dataSourceManager?.get(e)?.off(n,t.get(r))}))})),(this.dsl?.dataSources||[]).forEach((e=>{const t=this.dataSourceEventList.get(e.id)??new Map;(e.events||[]).forEach((r=>{const[n,...a]=r.name?.split(".")||[];if(!n)return;const s=(...t)=>{this.eventHandler(r,this.dataSourceManager?.get(e.id),t)};t.set(r.name,s),n===DATA_SOURCE_FIELDS_CHANGE_EVENT_PREFIX?this.dataSourceManager?.onDataChange(e.id,a.join("."),s):this.dataSourceManager?.get(e.id)?.on(n,s)})),this.dataSourceEventList.set(e.id,t)})))}async actionHandler(e,t,r){e.actionType===E.COMP?await this.compActionHandler(e,t,r):e.actionType===E.CODE?await this.codeActionHandler(e,r):e.actionType===E.DATA_SOURCE&&await this.dataSourceActionHandler(e,r)}async eventHandler(e,t,r){const n="number"==typeof e?t.events[e]:e;if(has(n,"actions")){const{actions:a}=n;for(let n=0;n<a.length;n++)if("number"==typeof e){const a=t.events[e].actions[n];this.actionHandler(a,t,r)}else this.actionHandler(a[n],t,r)}else await this.compActionHandler(n,t,r)}addEventToMap(e){this.eventQueueMap[e.eventConfig.to]?this.eventQueueMap[e.eventConfig.to].push(e):this.eventQueueMap[e.eventConfig.to]=[e]}}const scriptRel="modulepreload",assetsURL=function(e){return"/static/vue3/runtime/page/"+e},seen={},__vitePreload=function(e,t,r){let n=Promise.resolve();return n.then((()=>e())).catch((e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}))},components={page:()=>__vitePreload((()=>module.import("./index-legacy-DXa1fNpF.js")),void 0),container:()=>__vitePreload((()=>module.import("./Container-legacy-5iUj_UPn.js")),void 0),button:()=>__vitePreload((()=>module.import("./index-legacy-zesVL7OQ.js")),void 0),text:()=>__vitePreload((()=>module.import("./index-legacy-GUxCaPrR.js")),void 0),img:()=>__vitePreload((()=>module.import("./index-legacy-NQxyBf3k.js")),void 0),qrcode:()=>__vitePreload((()=>module.import("./index-legacy-Bp1rTr8z.js")),void 0),overlay:()=>__vitePreload((()=>module.import("./index-legacy-dUNVSfUc.js")),void 0),"page-fragment-container":()=>__vitePreload((()=>module.import("./PageFragmentContainer-legacy-BrD9tJA9.js")),void 0),"page-fragment":()=>__vitePreload((()=>module.import("./PageFragment-legacy-D7xZHdU3.js")),void 0),"iterator-container":()=>__vitePreload((()=>module.import("./IteratorContainer-legacy-Dkok3ezX.js")),void 0)},datasources={},plugins={};var axios$3={exports:{}},bind$2=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}},bind$1=bind$2,toString=Object.prototype.toString;function isArray(e){return Array.isArray(e)}function isUndefined(e){return void 0===e}function isBuffer(e){return null!==e&&!isUndefined(e)&&null!==e.constructor&&!isUndefined(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function isArrayBuffer(e){return"[object ArrayBuffer]"===toString.call(e)}function isFormData(e){return"[object FormData]"===toString.call(e)}function isArrayBufferView(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&isArrayBuffer(e.buffer)}function isString(e){return"string"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return null!==e&&"object"==typeof e}function isPlainObject(e){if("[object Object]"!==toString.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function isDate(e){return"[object Date]"===toString.call(e)}function isFile(e){return"[object File]"===toString.call(e)}function isBlob(e){return"[object Blob]"===toString.call(e)}function isFunction(e){return"[object Function]"===toString.call(e)}function isStream(e){return isObject(e)&&isFunction(e.pipe)}function isURLSearchParams(e){return"[object URLSearchParams]"===toString.call(e)}function trim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function isStandardBrowserEnv(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function forEach(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),isArray(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.call(null,e[a],a,e)}function merge(){var e={};function t(t,r){isPlainObject(e[r])&&isPlainObject(t)?e[r]=merge(e[r],t):isPlainObject(t)?e[r]=merge({},t):isArray(t)?e[r]=t.slice():e[r]=t}for(var r=0,n=arguments.length;r<n;r++)forEach(arguments[r],t);return e}function extend(e,t,r){return forEach(t,(function(t,n){e[n]=r&&"function"==typeof t?bind$1(t,r):t})),e}function stripBOM(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}var utils$8={isArray:isArray,isArrayBuffer:isArrayBuffer,isBuffer:isBuffer,isFormData:isFormData,isArrayBufferView:isArrayBufferView,isString:isString,isNumber:isNumber,isObject:isObject,isPlainObject:isPlainObject,isUndefined:isUndefined,isDate:isDate,isFile:isFile,isBlob:isBlob,isFunction:isFunction,isStream:isStream,isURLSearchParams:isURLSearchParams,isStandardBrowserEnv:isStandardBrowserEnv,forEach:forEach,merge:merge,extend:extend,trim:trim,stripBOM:stripBOM},utils$7=utils$8;function encode(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var buildURL$1=function(e,t,r){if(!t)return e;var n;if(r)n=r(t);else if(utils$7.isURLSearchParams(t))n=t.toString();else{var a=[];utils$7.forEach(t,(function(e,t){null!=e&&(utils$7.isArray(e)?t+="[]":e=[e],utils$7.forEach(e,(function(e){utils$7.isDate(e)?e=e.toISOString():utils$7.isObject(e)&&(e=JSON.stringify(e)),a.push(encode(t)+"="+encode(e))})))})),n=a.join("&")}if(n){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e},utils$6=utils$8;function InterceptorManager$1(){this.handlers=[]}InterceptorManager$1.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},InterceptorManager$1.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},InterceptorManager$1.prototype.forEach=function(e){utils$6.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var InterceptorManager_1=InterceptorManager$1,utils$5=utils$8,normalizeHeaderName=function(e,t){utils$5.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))},enhanceError=function(e,t,r,n,a){return e.config=t,r&&(e.code=r),e.request=n,e.response=a,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e},createError,hasRequiredCreateError,settle,hasRequiredSettle,cookies,hasRequiredCookies,isAbsoluteURL,hasRequiredIsAbsoluteURL,combineURLs,hasRequiredCombineURLs,buildFullPath,hasRequiredBuildFullPath,parseHeaders,hasRequiredParseHeaders,isURLSameOrigin,hasRequiredIsURLSameOrigin,Cancel_1,hasRequiredCancel,xhr,hasRequiredXhr,defaults_1,hasRequiredDefaults;function requireCreateError(){if(hasRequiredCreateError)return createError;hasRequiredCreateError=1;var e=enhanceError;return createError=function(t,r,n,a,s){var i=new Error(t);return e(i,r,n,a,s)},createError}function requireSettle(){if(hasRequiredSettle)return settle;hasRequiredSettle=1;var e=requireCreateError();return settle=function(t,r,n){var a=n.config.validateStatus;n.status&&a&&!a(n.status)?r(e("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}}function requireCookies(){if(hasRequiredCookies)return cookies;hasRequiredCookies=1;var e=utils$8;return cookies=e.isStandardBrowserEnv()?{write:function(t,r,n,a,s,i){var o=[];o.push(t+"="+encodeURIComponent(r)),e.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),e.isString(a)&&o.push("path="+a),e.isString(s)&&o.push("domain="+s),!0===i&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}}function requireIsAbsoluteURL(){return hasRequiredIsAbsoluteURL?isAbsoluteURL:(hasRequiredIsAbsoluteURL=1,isAbsoluteURL=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)})}function requireCombineURLs(){return hasRequiredCombineURLs?combineURLs:(hasRequiredCombineURLs=1,combineURLs=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e})}function requireBuildFullPath(){if(hasRequiredBuildFullPath)return buildFullPath;hasRequiredBuildFullPath=1;var e=requireIsAbsoluteURL(),t=requireCombineURLs();return buildFullPath=function(r,n){return r&&!e(n)?t(r,n):n}}function requireParseHeaders(){if(hasRequiredParseHeaders)return parseHeaders;hasRequiredParseHeaders=1;var e=utils$8,t=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return parseHeaders=function(r){var n,a,s,i={};return r?(e.forEach(r.split("\n"),(function(r){if(s=r.indexOf(":"),n=e.trim(r.substr(0,s)).toLowerCase(),a=e.trim(r.substr(s+1)),n){if(i[n]&&t.indexOf(n)>=0)return;i[n]="set-cookie"===n?(i[n]?i[n]:[]).concat([a]):i[n]?i[n]+", "+a:a}})),i):i}}function requireIsURLSameOrigin(){if(hasRequiredIsURLSameOrigin)return isURLSameOrigin;hasRequiredIsURLSameOrigin=1;var e=utils$8;return isURLSameOrigin=e.isStandardBrowserEnv()?function(){var t,r=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function a(e){var t=e;return r&&(n.setAttribute("href",t),t=n.href),n.setAttribute("href",t),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=a(window.location.href),function(r){var n=e.isString(r)?a(r):r;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}}function requireCancel(){if(hasRequiredCancel)return Cancel_1;function e(e){this.message=e}return hasRequiredCancel=1,e.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},e.prototype.__CANCEL__=!0,Cancel_1=e}function requireXhr(){if(hasRequiredXhr)return xhr;hasRequiredXhr=1;var e=utils$8,t=requireSettle(),r=requireCookies(),n=buildURL$1,a=requireBuildFullPath(),s=requireParseHeaders(),i=requireIsURLSameOrigin(),o=requireCreateError(),c=requireDefaults(),u=requireCancel();return xhr=function(l){return new Promise((function(d,h){var p,f=l.data,g=l.headers,y=l.responseType;function b(){l.cancelToken&&l.cancelToken.unsubscribe(p),l.signal&&l.signal.removeEventListener("abort",p)}e.isFormData(f)&&delete g["Content-Type"];var m=new XMLHttpRequest;if(l.auth){var $=l.auth.username||"",v=l.auth.password?unescape(encodeURIComponent(l.auth.password)):"";g.Authorization="Basic "+btoa($+":"+v)}var T=a(l.baseURL,l.url);function S(){if(m){var e="getAllResponseHeaders"in m?s(m.getAllResponseHeaders()):null,r={data:y&&"text"!==y&&"json"!==y?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:e,config:l,request:m};t((function(e){d(e),b()}),(function(e){h(e),b()}),r),m=null}}if(m.open(l.method.toUpperCase(),n(T,l.params,l.paramsSerializer),!0),m.timeout=l.timeout,"onloadend"in m?m.onloadend=S:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(S)},m.onabort=function(){m&&(h(o("Request aborted",l,"ECONNABORTED",m)),m=null)},m.onerror=function(){h(o("Network Error",l,null,m)),m=null},m.ontimeout=function(){var e=l.timeout?"timeout of "+l.timeout+"ms exceeded":"timeout exceeded",t=l.transitional||c.transitional;l.timeoutErrorMessage&&(e=l.timeoutErrorMessage),h(o(e,l,t.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",m)),m=null},e.isStandardBrowserEnv()){var j=(l.withCredentials||i(T))&&l.xsrfCookieName?r.read(l.xsrfCookieName):void 0;j&&(g[l.xsrfHeaderName]=j)}"setRequestHeader"in m&&e.forEach(g,(function(e,t){void 0===f&&"content-type"===t.toLowerCase()?delete g[t]:m.setRequestHeader(t,e)})),e.isUndefined(l.withCredentials)||(m.withCredentials=!!l.withCredentials),y&&"json"!==y&&(m.responseType=l.responseType),"function"==typeof l.onDownloadProgress&&m.addEventListener("progress",l.onDownloadProgress),"function"==typeof l.onUploadProgress&&m.upload&&m.upload.addEventListener("progress",l.onUploadProgress),(l.cancelToken||l.signal)&&(p=function(e){m&&(h(!e||e&&e.type?new u("canceled"):e),m.abort(),m=null)},l.cancelToken&&l.cancelToken.subscribe(p),l.signal&&(l.signal.aborted?p():l.signal.addEventListener("abort",p))),f||(f=null),m.send(f)}))},xhr}function requireDefaults(){if(hasRequiredDefaults)return defaults_1;hasRequiredDefaults=1;var e=utils$8,t=normalizeHeaderName,r=enhanceError,n={"Content-Type":"application/x-www-form-urlencoded"};function a(t,r){!e.isUndefined(t)&&e.isUndefined(t["Content-Type"])&&(t["Content-Type"]=r)}var s,i={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(s=requireXhr()),s),transformRequest:[function(r,n){return t(n,"Accept"),t(n,"Content-Type"),e.isFormData(r)||e.isArrayBuffer(r)||e.isBuffer(r)||e.isStream(r)||e.isFile(r)||e.isBlob(r)?r:e.isArrayBufferView(r)?r.buffer:e.isURLSearchParams(r)?(a(n,"application/x-www-form-urlencoded;charset=utf-8"),r.toString()):e.isObject(r)||n&&"application/json"===n["Content-Type"]?(a(n,"application/json"),function(t,r){if(e.isString(t))try{return(r||JSON.parse)(t),e.trim(t)}catch(n){if("SyntaxError"!==n.name)throw n}return(0,JSON.stringify)(t)}(r)):r}],transformResponse:[function(t){var n=this.transitional||i.transitional,a=n&&n.silentJSONParsing,s=n&&n.forcedJSONParsing,o=!a&&"json"===this.responseType;if(o||s&&e.isString(t)&&t.length)try{return JSON.parse(t)}catch(c){if(o){if("SyntaxError"===c.name)throw r(c,this,"E_JSON_PARSE");throw c}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};return e.forEach(["delete","get","head"],(function(e){i.headers[e]={}})),e.forEach(["post","put","patch"],(function(t){i.headers[t]=e.merge(n)})),defaults_1=i}var utils$4=utils$8,defaults$2=requireDefaults(),transformData$1=function(e,t,r){var n=this||defaults$2;return utils$4.forEach(r,(function(r){e=r.call(n,e,t)})),e},isCancel$1,hasRequiredIsCancel;function requireIsCancel(){return hasRequiredIsCancel?isCancel$1:(hasRequiredIsCancel=1,isCancel$1=function(e){return!(!e||!e.__CANCEL__)})}var utils$3=utils$8,transformData=transformData$1,isCancel=requireIsCancel(),defaults$1=requireDefaults(),Cancel=requireCancel();function throwIfCancellationRequested(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Cancel("canceled")}var dispatchRequest$1=function(e){return throwIfCancellationRequested(e),e.headers=e.headers||{},e.data=transformData.call(e,e.data,e.headers,e.transformRequest),e.headers=utils$3.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),utils$3.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||defaults$1.adapter)(e).then((function(t){return throwIfCancellationRequested(e),t.data=transformData.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return isCancel(t)||(throwIfCancellationRequested(e),t&&t.response&&(t.response.data=transformData.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},utils$2=utils$8,mergeConfig$2=function(e,t){t=t||{};var r={};function n(e,t){return utils$2.isPlainObject(e)&&utils$2.isPlainObject(t)?utils$2.merge(e,t):utils$2.isPlainObject(t)?utils$2.merge({},t):utils$2.isArray(t)?t.slice():t}function a(r){return utils$2.isUndefined(t[r])?utils$2.isUndefined(e[r])?void 0:n(void 0,e[r]):n(e[r],t[r])}function s(e){if(!utils$2.isUndefined(t[e]))return n(void 0,t[e])}function i(r){return utils$2.isUndefined(t[r])?utils$2.isUndefined(e[r])?void 0:n(void 0,e[r]):n(void 0,t[r])}function o(r){return r in t?n(e[r],t[r]):r in e?n(void 0,e[r]):void 0}var c={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o};return utils$2.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=c[e]||a,n=t(e);utils$2.isUndefined(n)&&t!==o||(r[e]=n)})),r},data,hasRequiredData;function requireData(){return hasRequiredData?data:(hasRequiredData=1,data={version:"0.25.0"})}var VERSION=requireData().version,validators$1={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){validators$1[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var deprecatedWarnings={};function assertOptions(e,t,r){if("object"!=typeof e)throw new TypeError("options must be an object");for(var n=Object.keys(e),a=n.length;a-- >0;){var s=n[a],i=t[s];if(i){var o=e[s],c=void 0===o||i(o,s,e);if(!0!==c)throw new TypeError("option "+s+" must be "+c)}else if(!0!==r)throw Error("Unknown option "+s)}}validators$1.transitional=function(e,t,r){function n(e,t){return"[Axios v"+VERSION+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,a,s){if(!1===e)throw new Error(n(a," has been removed"+(t?" in "+t:"")));return t&&!deprecatedWarnings[a]&&(deprecatedWarnings[a]=!0,console.warn(n(a," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,a,s)}};var validator$1={assertOptions:assertOptions,validators:validators$1},utils$1=utils$8,buildURL=buildURL$1,InterceptorManager=InterceptorManager_1,dispatchRequest=dispatchRequest$1,mergeConfig$1=mergeConfig$2,validator=validator$1,validators=validator.validators;function Axios$1(e){this.defaults=e,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}Axios$1.prototype.request=function(e,t){if("string"==typeof e?(t=t||{}).url=e:t=e||{},!t.url)throw new Error("Provided config url is not valid");(t=mergeConfig$1(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var r=t.transitional;void 0!==r&&validator.assertOptions(r,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1);var n=[],a=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,n.unshift(e.fulfilled,e.rejected))}));var s,i=[];if(this.interceptors.response.forEach((function(e){i.push(e.fulfilled,e.rejected)})),!a){var o=[dispatchRequest,void 0];for(Array.prototype.unshift.apply(o,n),o=o.concat(i),s=Promise.resolve(t);o.length;)s=s.then(o.shift(),o.shift());return s}for(var c=t;n.length;){var u=n.shift(),l=n.shift();try{c=u(c)}catch(d){l(d);break}}try{s=dispatchRequest(c)}catch(d){return Promise.reject(d)}for(;i.length;)s=s.then(i.shift(),i.shift());return s},Axios$1.prototype.getUri=function(e){if(!e.url)throw new Error("Provided config url is not valid");return e=mergeConfig$1(this.defaults,e),buildURL(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},utils$1.forEach(["delete","get","head","options"],(function(e){Axios$1.prototype[e]=function(t,r){return this.request(mergeConfig$1(r||{},{method:e,url:t,data:(r||{}).data}))}})),utils$1.forEach(["post","put","patch"],(function(e){Axios$1.prototype[e]=function(t,r,n){return this.request(mergeConfig$1(n||{},{method:e,url:t,data:r}))}}));var Axios_1=Axios$1,CancelToken_1,hasRequiredCancelToken,spread,hasRequiredSpread,isAxiosError,hasRequiredIsAxiosError;function requireCancelToken(){if(hasRequiredCancelToken)return CancelToken_1;hasRequiredCancelToken=1;var e=requireCancel();function t(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var r;this.promise=new Promise((function(e){r=e}));var n=this;this.promise.then((function(e){if(n._listeners){var t,r=n._listeners.length;for(t=0;t<r;t++)n._listeners[t](e);n._listeners=null}})),this.promise.then=function(e){var t,r=new Promise((function(e){n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},t((function(t){n.reason||(n.reason=new e(t),r(n.reason))}))}return t.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},t.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},t.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},t.source=function(){var e;return{token:new t((function(t){e=t})),cancel:e}},CancelToken_1=t}function requireSpread(){return hasRequiredSpread?spread:(hasRequiredSpread=1,spread=function(e){return function(t){return e.apply(null,t)}})}function requireIsAxiosError(){if(hasRequiredIsAxiosError)return isAxiosError;hasRequiredIsAxiosError=1;var e=utils$8;return isAxiosError=function(t){return e.isObject(t)&&!0===t.isAxiosError}}var utils=utils$8,bind=bind$2,Axios=Axios_1,mergeConfig=mergeConfig$2,defaults=requireDefaults();function createInstance(e){var t=new Axios(e),r=bind(Axios.prototype.request,t);return utils.extend(r,Axios.prototype,t),utils.extend(r,t),r.create=function(t){return createInstance(mergeConfig(e,t))},r}var axios$2=createInstance(defaults);axios$2.Axios=Axios,axios$2.Cancel=requireCancel(),axios$2.CancelToken=requireCancelToken(),axios$2.isCancel=requireIsCancel(),axios$2.VERSION=requireData().version,axios$2.all=function(e){return Promise.all(e)},axios$2.spread=requireSpread(),axios$2.isAxiosError=requireIsAxiosError(),axios$3.exports=axios$2,axios$3.exports.default=axios$2;var axiosExports=axios$3.exports,axios=axiosExports;const axios$1=getDefaultExportFromCjs(axios),requestHandler=function(e){return e},responseHandler=function(e){return e},service=axios$1.create({withCredentials:!0,timeout:7e3});service.interceptors.request.use(requestHandler),service.interceptors.response.use(responseHandler);const request={install(e){e.provide("request",service)}},useDsl=e=>{const t=VueDemi.ref(e?.page?.data||{});return e?.dataSourceManager?.on("update-data",((r,n,a)=>{r.forEach((e=>{isPage(e)?t.value=e:replaceChildNode(VueDemi.reactive(e),[t.value])})),e&&VueDemi.nextTick((()=>{e.emit("replaced-node",{nodes:r,sourceId:n,...a})}))})),{pageConfig:t}},_sfc_main=Vue.defineComponent({__name:"App",setup(e){const t=Vue.inject("app"),{pageConfig:r}=useDsl(t);return t?.on("page-change",(e=>{if(!e)throw new Error("页面不存在");addParamToUrl({page:e.data.id},window)})),(e,t)=>{const n=Vue.resolveComponent("magic-ui-page");return Vue.openBlock(),Vue.createBlock(n,{config:Vue.unref(r)},null,8,["config"])}}}),getLocalConfig=()=>{const configStr=localStorage.getItem("magicDSL");if(!configStr)return[];try{return[eval(`(${configStr})`)]}catch(err){return[]}};DataSourceManager.registerObservedData(DeepObservedData);const vueApp=Vue.createApp(_sfc_main);vueApp.use(request);const dsl=((getUrlParam("localPreview")?getLocalConfig():window.magicDSL)||[])[0]||{},app=new App({ua:window.navigator.userAgent,config:dsl,request:service,curPage:getUrlParam("page"),useMock:Boolean(getUrlParam("useMock"))});app.setDesignWidth(app.env.isWeb?window.document.documentElement.getBoundingClientRect().width:375),Object.entries(components).forEach((([e,t])=>{vueApp.component(`magic-ui-${e}`,Vue.defineAsyncComponent(t))})),Object.values(plugins).forEach((e=>{vueApp.use(e,{app:app})})),registerDataSourceOnDemand(dsl,datasources).then((e=>{Object.entries(e).forEach((([e,t])=>{DataSourceManager.register(e,t)})),vueApp.config.globalProperties.app=app,vueApp.provide("app",app),vueApp.mount("#app")}))}}}))})();
//# sourceMappingURL=index-legacy-NzaO8zyP.js.map
